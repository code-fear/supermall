{"ast":null,"code":"import _typeof from \"E:/VSCode/project/Vue/supermall01/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.regexp.constructor.js\";\nimport \"core-js/modules/es.regexp.dot-all.js\";\nimport \"core-js/modules/es.regexp.sticky.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\n\n/*!\n * better-scroll / better-scroll\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nfunction __generator(thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n}\n\nvar propertiesConfig$7 = [{\n  sourceKey: 'scroller.scrollBehaviorX.currentPos',\n  key: 'x'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.currentPos',\n  key: 'y'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.hasScroll',\n  key: 'hasHorizontalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.hasScroll',\n  key: 'hasVerticalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.contentSize',\n  key: 'scrollerWidth'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.contentSize',\n  key: 'scrollerHeight'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\n  key: 'maxScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\n  key: 'maxScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\n  key: 'minScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\n  key: 'minScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.movingDirection',\n  key: 'movingDirectionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.movingDirection',\n  key: 'movingDirectionY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.direction',\n  key: 'directionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.direction',\n  key: 'directionY'\n}, {\n  sourceKey: 'scroller.actions.enabled',\n  key: 'enabled'\n}, {\n  sourceKey: 'scroller.animater.pending',\n  key: 'pending'\n}, {\n  sourceKey: 'scroller.animater.stop',\n  key: 'stop'\n}, {\n  sourceKey: 'scroller.scrollTo',\n  key: 'scrollTo'\n}, {\n  sourceKey: 'scroller.scrollBy',\n  key: 'scrollBy'\n}, {\n  sourceKey: 'scroller.scrollToElement',\n  key: 'scrollToElement'\n}, {\n  sourceKey: 'scroller.resetPosition',\n  key: 'resetPosition'\n}];\n\nfunction warn(msg) {\n  console.error(\"[BScroll warn]: \" + msg);\n}\n\nfunction assert(condition, msg) {\n  if (!condition) {\n    throw new Error('[BScroll] ' + msg);\n  }\n} // ssr support\n\n\nvar inBrowser = typeof window !== 'undefined';\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\nvar isAndroid = ua && ua.indexOf('android') > 0;\n/* istanbul ignore next */\n\nvar isIOSBadVersion = function () {\n  if (typeof ua === 'string') {\n    var regex = /os (\\d\\d?_\\d(_\\d)?)/;\n    var matches = regex.exec(ua);\n    if (!matches) return false;\n    var parts = matches[1].split('_').map(function (item) {\n      return parseInt(item, 10);\n    }); // ios version >= 13.4 issue 982\n\n    return !!(parts[0] === 13 && parts[1] >= 4);\n  }\n\n  return false;\n}();\n/* istanbul ignore next */\n\n\nvar supportsPassive = false;\n/* istanbul ignore next */\n\nif (inBrowser) {\n  var EventName = 'test-passive';\n\n  try {\n    var opts = {};\n    Object.defineProperty(opts, 'passive', {\n      get: function get() {\n        supportsPassive = true;\n      }\n    }); // https://github.com/facebook/flow/issues/285\n\n    window.addEventListener(EventName, function () {}, opts);\n  } catch (e) {}\n}\n\nfunction getNow() {\n  return window.performance && window.performance.now && window.performance.timing ? window.performance.now() + window.performance.timing.navigationStart : +new Date();\n}\n\nvar extend = function extend(target, source) {\n  for (var key in source) {\n    target[key] = source[key];\n  }\n\n  return target;\n};\n\nfunction isUndef(v) {\n  return v === undefined || v === null;\n}\n\nfunction getDistance(x, y) {\n  return Math.sqrt(x * x + y * y);\n}\n\nfunction between(x, min, max) {\n  if (x < min) {\n    return min;\n  }\n\n  if (x > max) {\n    return max;\n  }\n\n  return x;\n}\n\nfunction findIndex(ary, fn) {\n  if (ary.findIndex) {\n    return ary.findIndex(fn);\n  }\n\n  var index = -1;\n  ary.some(function (item, i, ary) {\n    var ret = fn(item, i, ary);\n\n    if (ret) {\n      index = i;\n      return ret;\n    }\n  });\n  return index;\n}\n\nvar elementStyle = inBrowser && document.createElement('div').style;\n\nvar vendor = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return false;\n  }\n\n  var transformNames = [{\n    key: 'standard',\n    value: 'transform'\n  }, {\n    key: 'webkit',\n    value: 'webkitTransform'\n  }, {\n    key: 'Moz',\n    value: 'MozTransform'\n  }, {\n    key: 'O',\n    value: 'OTransform'\n  }, {\n    key: 'ms',\n    value: 'msTransform'\n  }];\n\n  for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\n    var obj = transformNames_1[_i];\n\n    if (elementStyle[obj.value] !== undefined) {\n      return obj.key;\n    }\n  }\n  /* istanbul ignore next  */\n\n\n  return false;\n}();\n/* istanbul ignore next  */\n\n\nfunction prefixStyle(style) {\n  if (vendor === false) {\n    return style;\n  }\n\n  if (vendor === 'standard') {\n    if (style === 'transitionEnd') {\n      return 'transitionend';\n    }\n\n    return style;\n  }\n\n  return vendor + style.charAt(0).toUpperCase() + style.substr(1);\n}\n\nfunction getElement(el) {\n  return typeof el === 'string' ? document.querySelector(el) : el;\n}\n\nfunction addEvent(el, type, fn, capture) {\n  var useCapture = supportsPassive ? {\n    passive: false,\n    capture: !!capture\n  } : !!capture;\n  el.addEventListener(type, fn, useCapture);\n}\n\nfunction removeEvent(el, type, fn, capture) {\n  el.removeEventListener(type, fn, {\n    capture: !!capture\n  });\n}\n\nfunction offset(el) {\n  var left = 0;\n  var top = 0;\n\n  while (el) {\n    left -= el.offsetLeft;\n    top -= el.offsetTop;\n    el = el.offsetParent;\n  }\n\n  return {\n    left: left,\n    top: top\n  };\n}\n\nfunction offsetToBody(el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    left: -(rect.left + window.pageXOffset),\n    top: -(rect.top + window.pageYOffset)\n  };\n}\n\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\nvar transform = prefixStyle('transform');\nvar transition = prefixStyle('transition');\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle; // fix issue #361\n\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\nvar hasTransition = inBrowser && transition in elementStyle;\nvar style = {\n  transform: transform,\n  transition: transition,\n  transitionTimingFunction: prefixStyle('transitionTimingFunction'),\n  transitionDuration: prefixStyle('transitionDuration'),\n  transitionDelay: prefixStyle('transitionDelay'),\n  transformOrigin: prefixStyle('transformOrigin'),\n  transitionEnd: prefixStyle('transitionEnd'),\n  transitionProperty: prefixStyle('transitionProperty')\n};\nvar eventTypeMap = {\n  touchstart: 1,\n  touchmove: 1,\n  touchend: 1,\n  touchcancel: 1,\n  mousedown: 2,\n  mousemove: 2,\n  mouseup: 2\n};\n\nfunction getRect(el) {\n  /* istanbul ignore if  */\n  if (el instanceof window.SVGElement) {\n    var rect = el.getBoundingClientRect();\n    return {\n      top: rect.top,\n      left: rect.left,\n      width: rect.width,\n      height: rect.height\n    };\n  } else {\n    return {\n      top: el.offsetTop,\n      left: el.offsetLeft,\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    };\n  }\n}\n\nfunction preventDefaultExceptionFn(el, exceptions) {\n  for (var i in exceptions) {\n    if (exceptions[i].test(el[i])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar tagExceptionFn = preventDefaultExceptionFn;\n\nfunction tap(e, eventName) {\n  var ev = document.createEvent('Event');\n  ev.initEvent(eventName, true, true);\n  ev.pageX = e.pageX;\n  ev.pageY = e.pageY;\n  e.target.dispatchEvent(ev);\n}\n\nfunction click(e, event) {\n  if (event === void 0) {\n    event = 'click';\n  }\n\n  var eventSource;\n\n  if (e.type === 'mouseup') {\n    eventSource = e;\n  } else if (e.type === 'touchend' || e.type === 'touchcancel') {\n    eventSource = e.changedTouches[0];\n  }\n\n  var posSrc = {};\n\n  if (eventSource) {\n    posSrc.screenX = eventSource.screenX || 0;\n    posSrc.screenY = eventSource.screenY || 0;\n    posSrc.clientX = eventSource.clientX || 0;\n    posSrc.clientY = eventSource.clientY || 0;\n  }\n\n  var ev;\n  var bubbles = true;\n  var cancelable = true;\n  var ctrlKey = e.ctrlKey,\n      shiftKey = e.shiftKey,\n      altKey = e.altKey,\n      metaKey = e.metaKey;\n  var pressedKeysMap = {\n    ctrlKey: ctrlKey,\n    shiftKey: shiftKey,\n    altKey: altKey,\n    metaKey: metaKey\n  };\n\n  if (typeof MouseEvent !== 'undefined') {\n    try {\n      ev = new MouseEvent(event, extend(_assign({\n        bubbles: bubbles,\n        cancelable: cancelable\n      }, pressedKeysMap), posSrc));\n    } catch (e) {\n      /* istanbul ignore next */\n      createEvent();\n    }\n  } else {\n    createEvent();\n  }\n\n  function createEvent() {\n    ev = document.createEvent('Event');\n    ev.initEvent(event, bubbles, cancelable);\n    extend(ev, posSrc);\n  } // forwardedTouchEvent set to true in case of the conflict with fastclick\n\n\n  ev.forwardedTouchEvent = true;\n  ev._constructed = true;\n  e.target.dispatchEvent(ev);\n}\n\nfunction dblclick(e) {\n  click(e, 'dblclick');\n}\n\nfunction prepend(el, target) {\n  var firstChild = target.firstChild;\n\n  if (firstChild) {\n    before(el, firstChild);\n  } else {\n    target.appendChild(el);\n  }\n}\n\nfunction before(el, target) {\n  var parentNode = target.parentNode;\n  parentNode.insertBefore(el, target);\n}\n\nfunction removeChild(el, child) {\n  el.removeChild(child);\n}\n\nfunction hasClass(el, className) {\n  var reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)');\n  return reg.test(el.className);\n}\n\nfunction HTMLCollectionToArray(el) {\n  return Array.prototype.slice.call(el, 0);\n}\n\nfunction getClientSize(el) {\n  return {\n    width: el.clientWidth,\n    height: el.clientHeight\n  };\n}\n\nvar ease = {\n  // easeOutQuint\n  swipe: {\n    style: 'cubic-bezier(0.23, 1, 0.32, 1)',\n    fn: function fn(t) {\n      return 1 + --t * t * t * t * t;\n    }\n  },\n  // easeOutQuard\n  swipeBounce: {\n    style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n    fn: function fn(t) {\n      return t * (2 - t);\n    }\n  },\n  // easeOutQuart\n  bounce: {\n    style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\n    fn: function fn(t) {\n      return 1 - --t * t * t * t;\n    }\n  }\n};\nvar DEFAULT_INTERVAL = 1000 / 60;\nvar windowCompat = inBrowser && window;\n/* istanbul ignore next */\n\nfunction noop$1() {}\n\nvar requestAnimationFrame = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return noop$1;\n  }\n\n  return windowCompat.requestAnimationFrame || windowCompat.webkitRequestAnimationFrame || windowCompat.mozRequestAnimationFrame || windowCompat.oRequestAnimationFrame || // if all else fails, use setTimeout\n  function (callback) {\n    return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\n  };\n}();\n\nvar cancelAnimationFrame = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return noop$1;\n  }\n\n  return windowCompat.cancelAnimationFrame || windowCompat.webkitCancelAnimationFrame || windowCompat.mozCancelAnimationFrame || windowCompat.oCancelAnimationFrame || function (id) {\n    window.clearTimeout(id);\n  };\n}();\n/* istanbul ignore next */\n\n\nvar noop = function noop(val) {};\n\nvar sharedPropertyDefinition = {\n  enumerable: true,\n  configurable: true,\n  get: noop,\n  set: noop\n};\n\nvar getProperty = function getProperty(obj, key) {\n  var keys = key.split('.');\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    obj = obj[keys[i]];\n    if (_typeof(obj) !== 'object' || !obj) return;\n  }\n\n  var lastKey = keys.pop();\n\n  if (typeof obj[lastKey] === 'function') {\n    return function () {\n      return obj[lastKey].apply(obj, arguments);\n    };\n  } else {\n    return obj[lastKey];\n  }\n};\n\nvar setProperty = function setProperty(obj, key, value) {\n  var keys = key.split('.');\n  var temp;\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    temp = keys[i];\n    if (!obj[temp]) obj[temp] = {};\n    obj = obj[temp];\n  }\n\n  obj[keys.pop()] = value;\n};\n\nfunction propertiesProxy(target, sourceKey, key) {\n  sharedPropertyDefinition.get = function proxyGetter() {\n    return getProperty(this, sourceKey);\n  };\n\n  sharedPropertyDefinition.set = function proxySetter(val) {\n    setProperty(this, sourceKey, val);\n  };\n\n  Object.defineProperty(target, key, sharedPropertyDefinition);\n}\n\nvar EventEmitter =\n/** @class */\nfunction () {\n  function EventEmitter(names) {\n    this.events = {};\n    this.eventTypes = {};\n    this.registerType(names);\n  }\n\n  EventEmitter.prototype.on = function (type, fn, context) {\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    if (!this.events[type]) {\n      this.events[type] = [];\n    }\n\n    this.events[type].push([fn, context]);\n    return this;\n  };\n\n  EventEmitter.prototype.once = function (type, fn, context) {\n    var _this = this;\n\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    var magic = function magic() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      _this.off(type, magic);\n\n      var ret = fn.apply(context, args);\n\n      if (ret === true) {\n        return ret;\n      }\n    };\n\n    magic.fn = fn;\n    this.on(type, magic);\n    return this;\n  };\n\n  EventEmitter.prototype.off = function (type, fn) {\n    if (!type && !fn) {\n      this.events = {};\n      return this;\n    }\n\n    if (type) {\n      this.hasType(type);\n\n      if (!fn) {\n        this.events[type] = [];\n        return this;\n      }\n\n      var events = this.events[type];\n\n      if (!events) {\n        return this;\n      }\n\n      var count = events.length;\n\n      while (count--) {\n        if (events[count][0] === fn || events[count][0] && events[count][0].fn === fn) {\n          events.splice(count, 1);\n        }\n      }\n\n      return this;\n    }\n  };\n\n  EventEmitter.prototype.trigger = function (type) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    this.hasType(type);\n    var events = this.events[type];\n\n    if (!events) {\n      return;\n    }\n\n    var len = events.length;\n\n    var eventsCopy = __spreadArrays(events);\n\n    var ret;\n\n    for (var i = 0; i < len; i++) {\n      var event_1 = eventsCopy[i];\n      var fn = event_1[0],\n          context = event_1[1];\n\n      if (fn) {\n        ret = fn.apply(context, args);\n\n        if (ret === true) {\n          return ret;\n        }\n      }\n    }\n  };\n\n  EventEmitter.prototype.registerType = function (names) {\n    var _this = this;\n\n    names.forEach(function (type) {\n      _this.eventTypes[type] = type;\n    });\n  };\n\n  EventEmitter.prototype.destroy = function () {\n    this.events = {};\n    this.eventTypes = {};\n  };\n\n  EventEmitter.prototype.hasType = function (type) {\n    var types = this.eventTypes;\n    var isType = types[type] === type;\n\n    if (!isType) {\n      warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" + (\"\" + Object.keys(types).map(function (_) {\n        return JSON.stringify(_);\n      })) + \"]\");\n    }\n  };\n\n  return EventEmitter;\n}();\n\nvar EventRegister =\n/** @class */\nfunction () {\n  function EventRegister(wrapper, events) {\n    this.wrapper = wrapper;\n    this.events = events;\n    this.addDOMEvents();\n  }\n\n  EventRegister.prototype.destroy = function () {\n    this.removeDOMEvents();\n    this.events = [];\n  };\n\n  EventRegister.prototype.addDOMEvents = function () {\n    this.handleDOMEvents(addEvent);\n  };\n\n  EventRegister.prototype.removeDOMEvents = function () {\n    this.handleDOMEvents(removeEvent);\n  };\n\n  EventRegister.prototype.handleDOMEvents = function (eventOperation) {\n    var _this = this;\n\n    var wrapper = this.wrapper;\n    this.events.forEach(function (event) {\n      eventOperation(wrapper, event.name, _this, !!event.capture);\n    });\n  };\n\n  EventRegister.prototype.handleEvent = function (e) {\n    var eventType = e.type;\n    this.events.some(function (event) {\n      if (event.name === eventType) {\n        event.handler(e);\n        return true;\n      }\n\n      return false;\n    });\n  };\n\n  return EventRegister;\n}();\n\nvar CustomOptions =\n/** @class */\nfunction () {\n  function CustomOptions() {}\n\n  return CustomOptions;\n}();\n\nvar OptionsConstructor =\n/** @class */\nfunction (_super) {\n  __extends(OptionsConstructor, _super);\n\n  function OptionsConstructor() {\n    var _this = _super.call(this) || this;\n\n    _this.startX = 0;\n    _this.startY = 0;\n    _this.scrollX = false;\n    _this.scrollY = true;\n    _this.freeScroll = false;\n    _this.directionLockThreshold = 0;\n    _this.eventPassthrough = \"\"\n    /* None */\n    ;\n    _this.click = false;\n    _this.dblclick = false;\n    _this.tap = '';\n    _this.bounce = {\n      top: true,\n      bottom: true,\n      left: true,\n      right: true\n    };\n    _this.bounceTime = 800;\n    _this.momentum = true;\n    _this.momentumLimitTime = 300;\n    _this.momentumLimitDistance = 15;\n    _this.swipeTime = 2500;\n    _this.swipeBounceTime = 500;\n    _this.deceleration = 0.0015;\n    _this.flickLimitTime = 200;\n    _this.flickLimitDistance = 100;\n    _this.resizePolling = 60;\n    _this.probeType = 0\n    /* Default */\n    ;\n    _this.stopPropagation = false;\n    _this.preventDefault = true;\n    _this.preventDefaultException = {\n      tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/\n    };\n    _this.tagException = {\n      tagName: /^TEXTAREA$/\n    };\n    _this.HWCompositing = true;\n    _this.useTransition = true;\n    _this.bindToWrapper = false;\n    _this.bindToTarget = false;\n    _this.disableMouse = hasTouch;\n    _this.disableTouch = !hasTouch;\n    _this.autoBlur = true;\n    _this.autoEndDistance = 5;\n    _this.outOfBoundaryDampingFactor = 1 / 3;\n    _this.specifiedIndexAsContent = 0;\n    _this.quadrant = 1\n    /* First */\n    ;\n    return _this;\n  }\n\n  OptionsConstructor.prototype.merge = function (options) {\n    if (!options) return this;\n\n    for (var key in options) {\n      if (key === 'bounce') {\n        this.bounce = this.resolveBounce(options[key]);\n        continue;\n      }\n\n      this[key] = options[key];\n    }\n\n    return this;\n  };\n\n  OptionsConstructor.prototype.process = function () {\n    this.translateZ = this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\n    this.useTransition = this.useTransition && hasTransition;\n    this.preventDefault = !this.eventPassthrough && this.preventDefault; // If you want eventPassthrough I have to lock one of the axes\n\n    this.scrollX = this.eventPassthrough === \"horizontal\"\n    /* Horizontal */\n    ? false : this.scrollX;\n    this.scrollY = this.eventPassthrough === \"vertical\"\n    /* Vertical */\n    ? false : this.scrollY; // With eventPassthrough we also need lockDirection mechanism\n\n    this.freeScroll = this.freeScroll && !this.eventPassthrough; // force true when freeScroll is true\n\n    this.scrollX = this.freeScroll ? true : this.scrollX;\n    this.scrollY = this.freeScroll ? true : this.scrollY;\n    this.directionLockThreshold = this.eventPassthrough ? 0 : this.directionLockThreshold;\n    return this;\n  };\n\n  OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\n    var DEFAULT_BOUNCE = {\n      top: true,\n      right: true,\n      bottom: true,\n      left: true\n    };\n    var NEGATED_BOUNCE = {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false\n    };\n    var ret;\n\n    if (_typeof(bounceOptions) === 'object') {\n      ret = extend(DEFAULT_BOUNCE, bounceOptions);\n    } else {\n      ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\n    }\n\n    return ret;\n  };\n\n  return OptionsConstructor;\n}(CustomOptions);\n\nvar ActionsHandler =\n/** @class */\nfunction () {\n  function ActionsHandler(wrapper, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['beforeStart', 'start', 'move', 'end', 'click']);\n    this.handleDOMEvents();\n  }\n\n  ActionsHandler.prototype.handleDOMEvents = function () {\n    var _a = this.options,\n        bindToWrapper = _a.bindToWrapper,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch,\n        click = _a.click;\n    var wrapper = this.wrapper;\n    var target = bindToWrapper ? wrapper : window;\n    var wrapperEvents = [];\n    var targetEvents = [];\n    var shouldRegisterTouch = !disableTouch;\n    var shouldRegisterMouse = !disableMouse;\n\n    if (click) {\n      wrapperEvents.push({\n        name: 'click',\n        handler: this.click.bind(this),\n        capture: true\n      });\n    }\n\n    if (shouldRegisterTouch) {\n      wrapperEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (shouldRegisterMouse) {\n      wrapperEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\n    this.targetEventRegister = new EventRegister(target, targetEvents);\n  };\n\n  ActionsHandler.prototype.beforeHandler = function (e, type) {\n    var _a = this.options,\n        preventDefault = _a.preventDefault,\n        stopPropagation = _a.stopPropagation,\n        preventDefaultException = _a.preventDefaultException;\n    var preventDefaultConditions = {\n      start: function start() {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      end: function end() {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      move: function move() {\n        return preventDefault;\n      }\n    };\n\n    if (preventDefaultConditions[type]()) {\n      e.preventDefault();\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n    }\n  };\n\n  ActionsHandler.prototype.setInitiated = function (type) {\n    if (type === void 0) {\n      type = 0;\n    }\n\n    this.initiated = type;\n  };\n\n  ActionsHandler.prototype.start = function (e) {\n    var _eventType = eventTypeMap[e.type];\n\n    if (this.initiated && this.initiated !== _eventType) {\n      return;\n    }\n\n    this.setInitiated(_eventType); // if textarea or other html tags in options.tagException is manipulated\n    // do not make bs scroll\n\n    if (tagExceptionFn(e.target, this.options.tagException)) {\n      this.setInitiated();\n      return;\n    } // only allow mouse left button\n\n\n    if (_eventType === 2\n    /* Mouse */\n    && e.button !== 0\n    /* Left */\n    ) return;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\n      return;\n    }\n\n    this.beforeHandler(e, 'start');\n    var point = e.touches ? e.touches[0] : e;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ActionsHandler.prototype.move = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.beforeHandler(e, 'move');\n    var point = e.touches ? e.touches[0] : e;\n    var deltaX = point.pageX - this.pointX;\n    var deltaY = point.pageY - this.pointY;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.move, {\n      deltaX: deltaX,\n      deltaY: deltaY,\n      e: e\n    })) {\n      return;\n    } // auto end when out of viewport\n\n\n    var scrollLeft = document.documentElement.scrollLeft || window.pageXOffset || document.body.scrollLeft;\n    var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n    var pX = this.pointX - scrollLeft;\n    var pY = this.pointY - scrollTop;\n    var autoEndDistance = this.options.autoEndDistance;\n\n    if (pX > document.documentElement.clientWidth - autoEndDistance || pY > document.documentElement.clientHeight - autoEndDistance || pX < autoEndDistance || pY < autoEndDistance) {\n      this.end(e);\n    }\n  };\n\n  ActionsHandler.prototype.end = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.setInitiated();\n    this.beforeHandler(e, 'end');\n    this.hooks.trigger(this.hooks.eventTypes.end, e);\n  };\n\n  ActionsHandler.prototype.click = function (e) {\n    this.hooks.trigger(this.hooks.eventTypes.click, e);\n  };\n\n  ActionsHandler.prototype.setContent = function (content) {\n    if (content !== this.wrapper) {\n      this.wrapper = content;\n      this.rebindDOMEvents();\n    }\n  };\n\n  ActionsHandler.prototype.rebindDOMEvents = function () {\n    this.wrapperEventRegister.destroy();\n    this.targetEventRegister.destroy();\n    this.handleDOMEvents();\n  };\n\n  ActionsHandler.prototype.destroy = function () {\n    this.wrapperEventRegister.destroy();\n    this.targetEventRegister.destroy();\n    this.hooks.destroy();\n  };\n\n  return ActionsHandler;\n}();\n\nvar translaterMetaData = {\n  x: ['translateX', 'px'],\n  y: ['translateY', 'px']\n};\n\nvar Translater =\n/** @class */\nfunction () {\n  function Translater(content) {\n    this.setContent(content);\n    this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\n  }\n\n  Translater.prototype.getComputedPosition = function () {\n    var cssStyle = window.getComputedStyle(this.content, null);\n    var matrix = cssStyle[style.transform].split(')')[0].split(', ');\n    var x = +(matrix[12] || matrix[4]) || 0;\n    var y = +(matrix[13] || matrix[5]) || 0;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  Translater.prototype.translate = function (point) {\n    var transformStyle = [];\n    Object.keys(point).forEach(function (key) {\n      if (!translaterMetaData[key]) {\n        return;\n      }\n\n      var transformFnName = translaterMetaData[key][0];\n\n      if (transformFnName) {\n        var transformFnArgUnit = translaterMetaData[key][1];\n        var transformFnArg = point[key];\n        transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\n      }\n    });\n    this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\n    this.style[style.transform] = transformStyle.join(' ');\n    this.hooks.trigger(this.hooks.eventTypes.translate, point);\n  };\n\n  Translater.prototype.setContent = function (content) {\n    if (this.content !== content) {\n      this.content = content;\n      this.style = content.style;\n    }\n  };\n\n  Translater.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Translater;\n}();\n\nvar Base =\n/** @class */\nfunction () {\n  function Base(content, translater, options) {\n    this.translater = translater;\n    this.options = options;\n    this.timer = 0;\n    this.hooks = new EventEmitter(['move', 'end', 'beforeForceStop', 'forceStop', 'callStop', 'time', 'timeFunction']);\n    this.setContent(content);\n  }\n\n  Base.prototype.translate = function (endPoint) {\n    this.translater.translate(endPoint);\n  };\n\n  Base.prototype.setPending = function (pending) {\n    this.pending = pending;\n  };\n\n  Base.prototype.setForceStopped = function (forceStopped) {\n    this.forceStopped = forceStopped;\n  };\n\n  Base.prototype.setCallStop = function (called) {\n    this.callStopWhenPending = called;\n  };\n\n  Base.prototype.setContent = function (content) {\n    if (this.content !== content) {\n      this.content = content;\n      this.style = content.style;\n      this.stop();\n    }\n  };\n\n  Base.prototype.clearTimer = function () {\n    if (this.timer) {\n      cancelAnimationFrame(this.timer);\n      this.timer = 0;\n    }\n  };\n\n  Base.prototype.destroy = function () {\n    this.hooks.destroy();\n    cancelAnimationFrame(this.timer);\n  };\n\n  return Base;\n}(); // iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\n// when bs use transition mode\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\n// it is weird\n// so we should validate position caculated by 'window.getComputedStyle'\n\n\nvar isValidPostion = function isValidPostion(startPoint, endPoint, currentPos, prePos) {\n  var computeDirection = function computeDirection(endValue, startValue) {\n    var delta = endValue - startValue;\n    var direction = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    return direction;\n  };\n\n  var directionX = computeDirection(endPoint.x, startPoint.x);\n  var directionY = computeDirection(endPoint.y, startPoint.y);\n  var deltaX = currentPos.x - prePos.x;\n  var deltaY = currentPos.y - prePos.y;\n  return directionX * deltaX <= 0 && directionY * deltaY <= 0;\n};\n\nvar Transition =\n/** @class */\nfunction (_super) {\n  __extends(Transition, _super);\n\n  function Transition() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Transition.prototype.startProbe = function (startPoint, endPoint) {\n    var _this = this;\n\n    var prePos = startPoint;\n\n    var probe = function probe() {\n      var pos = _this.translater.getComputedPosition();\n\n      if (isValidPostion(startPoint, endPoint, pos, prePos)) {\n        _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\n      } // call bs.stop() should not dispatch end hook again.\n      // forceStop hook will do this.\n\n      /* istanbul ignore if  */\n\n\n      if (!_this.pending) {\n        if (_this.callStopWhenPending) {\n          _this.callStopWhenPending = false;\n        } else {\n          // transition ends should dispatch end hook.\n          _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\n        }\n      }\n\n      prePos = pos;\n\n      if (_this.pending) {\n        _this.timer = requestAnimationFrame(probe);\n      }\n    }; // when manually call bs.stop(), then bs.scrollTo()\n    // we should reset callStopWhenPending to dispatch end hook\n\n\n    if (this.callStopWhenPending) {\n      this.setCallStop(false);\n    }\n\n    cancelAnimationFrame(this.timer);\n    probe();\n  };\n\n  Transition.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.style[style.transitionDuration] = time + 'ms';\n    this.hooks.trigger(this.hooks.eventTypes.time, time);\n  };\n\n  Transition.prototype.transitionTimingFunction = function (easing) {\n    this.style[style.transitionTimingFunction] = easing;\n    this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\n  };\n\n  Transition.prototype.transitionProperty = function () {\n    this.style[style.transitionProperty] = style.transform;\n  };\n\n  Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\n    this.setPending(time > 0);\n    this.transitionTimingFunction(easingFn);\n    this.transitionProperty();\n    this.transitionTime(time);\n    this.translate(endPoint);\n    var isRealtimeProbeType = this.options.probeType === 3\n    /* Realtime */\n    ;\n\n    if (time && isRealtimeProbeType) {\n      this.startProbe(startPoint, endPoint);\n    } // if we change content's transformY in a tick\n    // such as: 0 -> 50px -> 0\n    // transitionend will not be triggered\n    // so we forceupdate by reflow\n\n\n    if (!time) {\n      this._reflow = this.content.offsetHeight;\n\n      if (isRealtimeProbeType) {\n        this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n    }\n  };\n\n  Transition.prototype.doStop = function () {\n    var pending = this.pending;\n    this.setForceStopped(false);\n    this.setCallStop(false); // still in transition\n\n    if (pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n\n      var _a = this.translater.getComputedPosition(),\n          x = _a.x,\n          y = _a.y;\n\n      this.transitionTime();\n      this.translate({\n        x: x,\n        y: y\n      });\n      this.setForceStopped(true);\n      this.setCallStop(true);\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, {\n        x: x,\n        y: y\n      });\n    }\n\n    return pending;\n  };\n\n  Transition.prototype.stop = function () {\n    var stopFromTransition = this.doStop();\n\n    if (stopFromTransition) {\n      this.hooks.trigger(this.hooks.eventTypes.callStop);\n    }\n  };\n\n  return Transition;\n}(Base);\n\nvar Animation =\n/** @class */\nfunction (_super) {\n  __extends(Animation, _super);\n\n  function Animation() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\n    // time is 0\n    if (!time) {\n      this.translate(endPoint);\n\n      if (this.options.probeType === 3\n      /* Realtime */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n      return;\n    }\n\n    this.animate(startPoint, endPoint, time, easingFn);\n  };\n\n  Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\n    var _this = this;\n\n    var startTime = getNow();\n    var destTime = startTime + duration;\n    var isRealtimeProbeType = this.options.probeType === 3\n    /* Realtime */\n    ;\n\n    var step = function step() {\n      var now = getNow(); // js animation end\n\n      if (now >= destTime) {\n        _this.translate(endPoint);\n\n        if (isRealtimeProbeType) {\n          _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\n        }\n\n        _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\n\n        return;\n      }\n\n      now = (now - startTime) / duration;\n      var easing = easingFn(now);\n      var newPoint = {};\n      Object.keys(endPoint).forEach(function (key) {\n        var startValue = startPoint[key];\n        var endValue = endPoint[key];\n        newPoint[key] = (endValue - startValue) * easing + startValue;\n      });\n\n      _this.translate(newPoint);\n\n      if (isRealtimeProbeType) {\n        _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\n      }\n\n      if (_this.pending) {\n        _this.timer = requestAnimationFrame(step);\n      } // call bs.stop() should not dispatch end hook again.\n      // forceStop hook will do this.\n\n      /* istanbul ignore if  */\n\n\n      if (!_this.pending) {\n        if (_this.callStopWhenPending) {\n          _this.callStopWhenPending = false;\n        } else {\n          // raf ends should dispatch end hook.\n          _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\n        }\n      }\n    };\n\n    this.setPending(true); // when manually call bs.stop(), then bs.scrollTo()\n    // we should reset callStopWhenPending to dispatch end hook\n\n    if (this.callStopWhenPending) {\n      this.setCallStop(false);\n    }\n\n    cancelAnimationFrame(this.timer);\n    step();\n  };\n\n  Animation.prototype.doStop = function () {\n    var pending = this.pending;\n    this.setForceStopped(false);\n    this.setCallStop(false); // still in requestFrameAnimation\n\n    if (pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n      var pos = this.translater.getComputedPosition();\n      this.setForceStopped(true);\n      this.setCallStop(true);\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\n    }\n\n    return pending;\n  };\n\n  Animation.prototype.stop = function () {\n    var stopFromAnimation = this.doStop();\n\n    if (stopFromAnimation) {\n      this.hooks.trigger(this.hooks.eventTypes.callStop);\n    }\n  };\n\n  return Animation;\n}(Base);\n\nfunction createAnimater(element, translater, options) {\n  var useTransition = options.useTransition;\n  var animaterOptions = {};\n  Object.defineProperty(animaterOptions, 'probeType', {\n    enumerable: true,\n    configurable: false,\n    get: function get() {\n      return options.probeType;\n    }\n  });\n\n  if (useTransition) {\n    return new Transition(element, translater, animaterOptions);\n  } else {\n    return new Animation(element, translater, animaterOptions);\n  }\n}\n\nvar Behavior =\n/** @class */\nfunction () {\n  function Behavior(wrapper, content, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['beforeComputeBoundary', 'computeBoundary', 'momentum', 'end', 'ignoreHasScroll']);\n    this.refresh(content);\n  }\n\n  Behavior.prototype.start = function () {\n    this.dist = 0;\n    this.setMovingDirection(0\n    /* Default */\n    );\n    this.setDirection(0\n    /* Default */\n    );\n  };\n\n  Behavior.prototype.move = function (delta) {\n    delta = this.hasScroll ? delta : 0;\n    this.setMovingDirection(delta);\n    return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\n  };\n\n  Behavior.prototype.setMovingDirection = function (delta) {\n    this.movingDirection = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n  };\n\n  Behavior.prototype.setDirection = function (delta) {\n    this.direction = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n  };\n\n  Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\n    var newPos = this.currentPos + delta; // Slow down or stop if outside of the boundaries\n\n    if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\n      if (newPos > this.minScrollPos && this.options.bounces[0] || newPos < this.maxScrollPos && this.options.bounces[1]) {\n        newPos = this.currentPos + delta * dampingFactor;\n      } else {\n        newPos = newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\n      }\n    }\n\n    return newPos;\n  };\n\n  Behavior.prototype.end = function (duration) {\n    var momentumInfo = {\n      duration: 0\n    };\n    var absDist = Math.abs(this.currentPos - this.startPos); // start momentum animation if needed\n\n    if (this.options.momentum && duration < this.options.momentumLimitTime && absDist > this.options.momentumLimitDistance) {\n      var wrapperSize = this.direction === -1\n      /* Negative */\n      && this.options.bounces[0] || this.direction === 1\n      /* Positive */\n      && this.options.bounces[1] ? this.wrapperSize : 0;\n      momentumInfo = this.hasScroll ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options) : {\n        destination: this.currentPos,\n        duration: 0\n      };\n    } else {\n      this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\n    }\n\n    return momentumInfo;\n  };\n\n  Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\n    if (options === void 0) {\n      options = this.options;\n    }\n\n    var distance = current - start;\n    var speed = Math.abs(distance) / time;\n    var deceleration = options.deceleration,\n        swipeBounceTime = options.swipeBounceTime,\n        swipeTime = options.swipeTime;\n    var duration = Math.min(swipeTime, speed * 2 / deceleration);\n    var momentumData = {\n      destination: current + speed * speed / deceleration * (distance < 0 ? -1 : 1),\n      duration: duration,\n      rate: 15\n    };\n    this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\n\n    if (momentumData.destination < lowerMargin) {\n      momentumData.destination = wrapperSize ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - wrapperSize / momentumData.rate * speed) : lowerMargin;\n      momentumData.duration = swipeBounceTime;\n    } else if (momentumData.destination > upperMargin) {\n      momentumData.destination = wrapperSize ? Math.min(upperMargin + wrapperSize / 4, upperMargin + wrapperSize / momentumData.rate * speed) : upperMargin;\n      momentumData.duration = swipeBounceTime;\n    }\n\n    momentumData.destination = Math.round(momentumData.destination);\n    return momentumData;\n  };\n\n  Behavior.prototype.updateDirection = function () {\n    var absDist = this.currentPos - this.absStartPos;\n    this.setDirection(absDist);\n  };\n\n  Behavior.prototype.refresh = function (content) {\n    var _a = this.options.rect,\n        size = _a.size,\n        position = _a.position;\n    var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static'; // Force reflow\n\n    var wrapperRect = getRect(this.wrapper); // use client is more fair than offset\n\n    this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\n    this.setContent(content);\n    var contentRect = getRect(this.content);\n    this.contentSize = contentRect[size];\n    this.relativeOffset = contentRect[position];\n    /* istanbul ignore if  */\n\n    if (isWrapperStatic) {\n      this.relativeOffset -= wrapperRect[position];\n    }\n\n    this.computeBoundary();\n    this.setDirection(0\n    /* Default */\n    );\n  };\n\n  Behavior.prototype.setContent = function (content) {\n    if (content !== this.content) {\n      this.content = content;\n      this.resetState();\n    }\n  };\n\n  Behavior.prototype.resetState = function () {\n    this.currentPos = 0;\n    this.startPos = 0;\n    this.dist = 0;\n    this.setDirection(0\n    /* Default */\n    );\n    this.setMovingDirection(0\n    /* Default */\n    );\n    this.resetStartPos();\n  };\n\n  Behavior.prototype.computeBoundary = function () {\n    this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\n    var boundary = {\n      minScrollPos: 0,\n      maxScrollPos: this.wrapperSize - this.contentSize\n    };\n\n    if (boundary.maxScrollPos < 0) {\n      boundary.maxScrollPos -= this.relativeOffset;\n\n      if (this.options.specifiedIndexAsContent === 0) {\n        boundary.minScrollPos = -this.relativeOffset;\n      }\n    }\n\n    this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\n    this.minScrollPos = boundary.minScrollPos;\n    this.maxScrollPos = boundary.maxScrollPos;\n    this.hasScroll = this.options.scrollable && this.maxScrollPos < this.minScrollPos;\n\n    if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\n      this.maxScrollPos = this.minScrollPos;\n      this.contentSize = this.wrapperSize;\n    }\n  };\n\n  Behavior.prototype.updatePosition = function (pos) {\n    this.currentPos = pos;\n  };\n\n  Behavior.prototype.getCurrentPos = function () {\n    return this.currentPos;\n  };\n\n  Behavior.prototype.checkInBoundary = function () {\n    var position = this.adjustPosition(this.currentPos);\n    var inBoundary = position === this.getCurrentPos();\n    return {\n      position: position,\n      inBoundary: inBoundary\n    };\n  }; // adjust position when out of boundary\n\n\n  Behavior.prototype.adjustPosition = function (pos) {\n    if (!this.hasScroll && !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\n      pos = this.minScrollPos;\n    } else if (pos > this.minScrollPos) {\n      pos = this.minScrollPos;\n    } else if (pos < this.maxScrollPos) {\n      pos = this.maxScrollPos;\n    }\n\n    return pos;\n  };\n\n  Behavior.prototype.updateStartPos = function () {\n    this.startPos = this.currentPos;\n  };\n\n  Behavior.prototype.updateAbsStartPos = function () {\n    this.absStartPos = this.currentPos;\n  };\n\n  Behavior.prototype.resetStartPos = function () {\n    this.updateStartPos();\n    this.updateAbsStartPos();\n  };\n\n  Behavior.prototype.getAbsDist = function (delta) {\n    this.dist += delta;\n    return Math.abs(this.dist);\n  };\n\n  Behavior.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Behavior;\n}();\n\nvar _a, _b, _c, _d;\n\nvar PassthroughHandlers = (_a = {}, _a[\"yes\"\n/* Yes */\n] = function (e) {\n  return true;\n}, _a[\"no\"\n/* No */\n] = function (e) {\n  e.preventDefault();\n  return false;\n}, _a);\nvar DirectionMap = (_b = {}, _b[\"horizontal\"\n/* Horizontal */\n] = (_c = {}, _c[\"yes\"\n/* Yes */\n] = \"horizontal\"\n/* Horizontal */\n, _c[\"no\"\n/* No */\n] = \"vertical\"\n/* Vertical */\n, _c), _b[\"vertical\"\n/* Vertical */\n] = (_d = {}, _d[\"yes\"\n/* Yes */\n] = \"vertical\"\n/* Vertical */\n, _d[\"no\"\n/* No */\n] = \"horizontal\"\n/* Horizontal */\n, _d), _b);\n\nvar DirectionLockAction =\n/** @class */\nfunction () {\n  function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\n    this.directionLockThreshold = directionLockThreshold;\n    this.freeScroll = freeScroll;\n    this.eventPassthrough = eventPassthrough;\n    this.reset();\n  }\n\n  DirectionLockAction.prototype.reset = function () {\n    this.directionLocked = \"\"\n    /* Default */\n    ;\n  };\n\n  DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\n    this.computeDirectionLock(absDistX, absDistY);\n    return this.handleEventPassthrough(e);\n  };\n\n  DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\n    if (this.directionLocked === \"horizontal\"\n    /* Horizontal */\n    ) {\n      deltaY = 0;\n    } else if (this.directionLocked === \"vertical\"\n    /* Vertical */\n    ) {\n      deltaX = 0;\n    }\n\n    return {\n      deltaX: deltaX,\n      deltaY: deltaY\n    };\n  };\n\n  DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\n    // If you are scrolling in one direction, lock it\n    if (this.directionLocked === \"\"\n    /* Default */\n    && !this.freeScroll) {\n      if (absDistX > absDistY + this.directionLockThreshold) {\n        this.directionLocked = \"horizontal\"\n        /* Horizontal */\n        ; // lock horizontally\n      } else if (absDistY >= absDistX + this.directionLockThreshold) {\n        this.directionLocked = \"vertical\"\n        /* Vertical */\n        ; // lock vertically\n      } else {\n        this.directionLocked = \"none\"\n        /* None */\n        ; // no lock\n      }\n    }\n  };\n\n  DirectionLockAction.prototype.handleEventPassthrough = function (e) {\n    var handleMap = DirectionMap[this.directionLocked];\n\n    if (handleMap) {\n      if (this.eventPassthrough === handleMap[\"yes\"\n      /* Yes */\n      ]) {\n        return PassthroughHandlers[\"yes\"\n        /* Yes */\n        ](e);\n      } else if (this.eventPassthrough === handleMap[\"no\"\n      /* No */\n      ]) {\n        return PassthroughHandlers[\"no\"\n        /* No */\n        ](e);\n      }\n    }\n\n    return false;\n  };\n\n  return DirectionLockAction;\n}();\n\nvar applyQuadrantTransformation = function applyQuadrantTransformation(deltaX, deltaY, quadrant) {\n  if (quadrant === 2\n  /* Second */\n  ) {\n    return [deltaY, -deltaX];\n  } else if (quadrant === 3\n  /* Third */\n  ) {\n    return [-deltaX, -deltaY];\n  } else if (quadrant === 4\n  /* Forth */\n  ) {\n    return [-deltaY, deltaX];\n  } else {\n    return [deltaX, deltaY];\n  }\n};\n\nvar ScrollerActions =\n/** @class */\nfunction () {\n  function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\n    this.hooks = new EventEmitter(['start', 'beforeMove', 'scrollStart', 'scroll', 'beforeEnd', 'end', 'scrollEnd', 'contentNotMoved', 'detectMovingDirection', 'coordinateTransformation']);\n    this.scrollBehaviorX = scrollBehaviorX;\n    this.scrollBehaviorY = scrollBehaviorY;\n    this.actionsHandler = actionsHandler;\n    this.animater = animater;\n    this.options = options;\n    this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\n    this.enabled = true;\n    this.bindActionsHandler();\n  }\n\n  ScrollerActions.prototype.bindActionsHandler = function () {\n    var _this = this; // [mouse|touch]start event\n\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleStart(e);\n    }); // [mouse|touch]move event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\n      var deltaX = _a.deltaX,\n          deltaY = _a.deltaY,\n          e = _a.e;\n      if (!_this.enabled) return true;\n\n      var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant),\n          transformateDeltaX = _b[0],\n          transformateDeltaY = _b[1];\n\n      var transformateDeltaData = {\n        deltaX: transformateDeltaX,\n        deltaY: transformateDeltaY\n      };\n\n      _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\n\n      return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\n    }); // [mouse|touch]end event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleEnd(e);\n    }); // click\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\n      // handle native click event\n      if (_this.enabled && !e._constructed) {\n        _this.handleClick(e);\n      }\n    });\n  };\n\n  ScrollerActions.prototype.handleStart = function (e) {\n    var timestamp = getNow();\n    this.fingerMoved = false;\n    this.contentMoved = false;\n    this.startTime = timestamp;\n    this.directionLockAction.reset();\n    this.scrollBehaviorX.start();\n    this.scrollBehaviorY.start(); // force stopping last transition or animation\n\n    this.animater.doStop();\n    this.scrollBehaviorX.resetStartPos();\n    this.scrollBehaviorY.resetStartPos();\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\n      return;\n    }\n\n    var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\n    var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\n    var timestamp = getNow(); // We need to move at least momentumLimitDistance pixels\n    // for the scrolling to initiate\n\n    if (this.checkMomentum(absDistX, absDistY, timestamp)) {\n      return true;\n    }\n\n    if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\n      this.actionsHandler.setInitiated();\n      return true;\n    }\n\n    var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\n    var prevX = this.scrollBehaviorX.getCurrentPos();\n    var newX = this.scrollBehaviorX.move(delta.deltaX);\n    var prevY = this.scrollBehaviorY.getCurrentPos();\n    var newY = this.scrollBehaviorY.move(delta.deltaY);\n\n    if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\n      return;\n    }\n\n    if (!this.fingerMoved) {\n      this.fingerMoved = true;\n    }\n\n    var positionChanged = newX !== prevX || newY !== prevY;\n\n    if (!this.contentMoved && !positionChanged) {\n      this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\n    }\n\n    if (!this.contentMoved && positionChanged) {\n      this.contentMoved = true;\n      this.hooks.trigger(this.hooks.eventTypes.scrollStart);\n    }\n\n    if (this.contentMoved && positionChanged) {\n      this.animater.translate({\n        x: newX,\n        y: newY\n      });\n      this.dispatchScroll(timestamp);\n    }\n  };\n\n  ScrollerActions.prototype.dispatchScroll = function (timestamp) {\n    // dispatch scroll in interval time\n    if (timestamp - this.startTime > this.options.momentumLimitTime) {\n      // refresh time and starting position to initiate a momentum\n      this.startTime = timestamp;\n      this.scrollBehaviorX.updateStartPos();\n      this.scrollBehaviorY.updateStartPos();\n\n      if (this.options.probeType === 1\n      /* Throttle */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n      }\n    } // dispatch scroll all the time\n\n\n    if (this.options.probeType > 1\n    /* Throttle */\n    ) {\n      this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n    }\n  };\n\n  ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\n    return timestamp - this.endTime > this.options.momentumLimitTime && absDistY < this.options.momentumLimitDistance && absDistX < this.options.momentumLimitDistance;\n  };\n\n  ScrollerActions.prototype.handleEnd = function (e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\n      return;\n    }\n\n    var currentPos = this.getCurrentPos();\n    this.scrollBehaviorX.updateDirection();\n    this.scrollBehaviorY.updateDirection();\n\n    if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\n      return true;\n    }\n\n    currentPos = this.ensureIntegerPos(currentPos);\n    this.animater.translate(currentPos);\n    this.endTime = getNow();\n    var duration = this.endTime - this.startTime;\n    this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\n  };\n\n  ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\n    this.ensuringInteger = true;\n    var x = currentPos.x,\n        y = currentPos.y;\n    var _a = this.scrollBehaviorX,\n        minScrollPosX = _a.minScrollPos,\n        maxScrollPosX = _a.maxScrollPos;\n    var _b = this.scrollBehaviorY,\n        minScrollPosY = _b.minScrollPos,\n        maxScrollPosY = _b.maxScrollPos;\n    x = x > 0 ? Math.ceil(x) : Math.floor(x);\n    y = y > 0 ? Math.ceil(y) : Math.floor(y);\n    x = between(x, maxScrollPosX, minScrollPosX);\n    y = between(y, maxScrollPosY, minScrollPosY);\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  ScrollerActions.prototype.handleClick = function (e) {\n    if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  ScrollerActions.prototype.getCurrentPos = function () {\n    return {\n      x: this.scrollBehaviorX.getCurrentPos(),\n      y: this.scrollBehaviorY.getCurrentPos()\n    };\n  };\n\n  ScrollerActions.prototype.refresh = function () {\n    this.endTime = 0;\n  };\n\n  ScrollerActions.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return ScrollerActions;\n}();\n\nfunction createActionsHandlerOptions(bsOptions) {\n  var options = ['click', 'bindToWrapper', 'disableMouse', 'disableTouch', 'preventDefault', 'stopPropagation', 'tagException', 'preventDefaultException', 'autoEndDistance'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {});\n  return options;\n}\n\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\n  var options = ['momentum', 'momentumLimitTime', 'momentumLimitDistance', 'deceleration', 'swipeBounceTime', 'swipeTime', 'outOfBoundaryDampingFactor', 'specifiedIndexAsContent'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {}); // add extra property\n\n  options.scrollable = !!bsOptions[extraProp];\n  options.bounces = bounces;\n  options.rect = rect;\n  return options;\n}\n\nfunction bubbling(source, target, events) {\n  events.forEach(function (event) {\n    var sourceEvent;\n    var targetEvent;\n\n    if (typeof event === 'string') {\n      sourceEvent = targetEvent = event;\n    } else {\n      sourceEvent = event.source;\n      targetEvent = event.target;\n    }\n\n    source.on(sourceEvent, function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return target.trigger.apply(target, __spreadArrays([targetEvent], args));\n    });\n  });\n}\n\nfunction isSamePoint(startPoint, endPoint) {\n  // keys of startPoint and endPoint should be equal\n  var keys = Object.keys(startPoint);\n\n  for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n    var key = keys_1[_i];\n    if (startPoint[key] !== endPoint[key]) return false;\n  }\n\n  return true;\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\n\nvar Scroller =\n/** @class */\nfunction () {\n  function Scroller(wrapper, content, options) {\n    this.wrapper = wrapper;\n    this.content = content;\n    this.resizeTimeout = 0;\n    this.hooks = new EventEmitter(['beforeStart', 'beforeMove', 'beforeScrollStart', 'scrollStart', 'scroll', 'beforeEnd', 'scrollEnd', 'resize', 'touchEnd', 'end', 'flick', 'scrollCancel', 'momentum', 'scrollTo', 'minDistanceScroll', 'scrollToElement', 'beforeRefresh']);\n    this.options = options;\n    var _a = this.options.bounce,\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        bottom = _a.bottom; // direction X\n\n    this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\n      size: 'width',\n      position: 'left'\n    })); // direction Y\n\n    this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\n      size: 'height',\n      position: 'top'\n    }));\n    this.translater = new Translater(this.content);\n    this.animater = createAnimater(this.content, this.translater, this.options);\n    this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\n    this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\n    var resizeHandler = this.resize.bind(this);\n    this.resizeRegister = new EventRegister(window, [{\n      name: 'orientationchange',\n      handler: resizeHandler\n    }, {\n      name: 'resize',\n      handler: resizeHandler\n    }]);\n    this.registerTransitionEnd();\n    this.init();\n  }\n\n  Scroller.prototype.init = function () {\n    var _this = this;\n\n    this.bindTranslater();\n    this.bindAnimater();\n    this.bindActions(); // enable pointer events when scrolling ends\n\n    this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\n      _this.togglePointerEvents(true);\n    });\n  };\n\n  Scroller.prototype.registerTransitionEnd = function () {\n    this.transitionEndRegister = new EventRegister(this.content, [{\n      name: style.transitionEnd,\n      handler: this.transitionEnd.bind(this)\n    }]);\n  };\n\n  Scroller.prototype.bindTranslater = function () {\n    var _this = this;\n\n    var hooks = this.translater.hooks;\n    hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\n      if (_this.options.translateZ) {\n        transformStyle.push(_this.options.translateZ);\n      }\n    }); // disable pointer events when scrolling\n\n    hooks.on(hooks.eventTypes.translate, function (pos) {\n      var prevPos = _this.getCurrentPos();\n\n      _this.updatePositions(pos); // scrollEnd will dispatch when scroll is force stopping in touchstart handler\n      // so in touchend handler, don't toggle pointer-events\n\n\n      if (_this.actions.ensuringInteger === true) {\n        _this.actions.ensuringInteger = false;\n        return;\n      } // a valid translate\n\n\n      if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\n        _this.togglePointerEvents(false);\n      }\n    });\n  };\n\n  Scroller.prototype.bindAnimater = function () {\n    var _this = this; // reset position\n\n\n    this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\n      if (!_this.resetPosition(_this.options.bounceTime)) {\n        _this.animater.setPending(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n      }\n    });\n    bubbling(this.animater.hooks, this.hooks, [{\n      source: this.animater.hooks.eventTypes.move,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: this.animater.hooks.eventTypes.forceStop,\n      target: this.hooks.eventTypes.scrollEnd\n    }]);\n  };\n\n  Scroller.prototype.bindActions = function () {\n    var _this = this;\n\n    var actions = this.actions;\n    bubbling(actions.hooks, this.hooks, [{\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeStart\n    }, {\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeScrollStart\n    }, {\n      source: actions.hooks.eventTypes.beforeMove,\n      target: this.hooks.eventTypes.beforeMove\n    }, {\n      source: actions.hooks.eventTypes.scrollStart,\n      target: this.hooks.eventTypes.scrollStart\n    }, {\n      source: actions.hooks.eventTypes.scroll,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: actions.hooks.eventTypes.beforeEnd,\n      target: this.hooks.eventTypes.beforeEnd\n    }]);\n    actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\n      _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\n\n      if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\n        return true;\n      } // check if it is a click operation\n\n\n      if (!actions.fingerMoved) {\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\n\n        if (_this.checkClick(e)) {\n          return true;\n        }\n      } // reset if we are outside of the boundaries\n\n\n      if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\n        _this.animater.setForceStopped(false);\n\n        return true;\n      }\n    });\n    actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\n      var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\n      var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\n\n      if (_this.checkFlick(duration, deltaX, deltaY)) {\n        _this.animater.setForceStopped(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.flick);\n\n        return;\n      }\n\n      if (_this.momentum(pos, duration)) {\n        _this.animater.setForceStopped(false);\n\n        return;\n      }\n\n      if (actions.contentMoved) {\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n      }\n\n      if (_this.animater.forceStopped) {\n        _this.animater.setForceStopped(false);\n      }\n    });\n  };\n\n  Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\n    var flickMinMovingDistance = 1; // distinguish flick from click\n\n    if (this.hooks.events.flick.length > 1 && duration < this.options.flickLimitTime && deltaX < this.options.flickLimitDistance && deltaY < this.options.flickLimitDistance && (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\n      return true;\n    }\n  };\n\n  Scroller.prototype.momentum = function (pos, duration) {\n    var meta = {\n      time: 0,\n      easing: ease.swiper,\n      newX: pos.x,\n      newY: pos.y\n    }; // start momentum animation if needed\n\n    var momentumX = this.scrollBehaviorX.end(duration);\n    var momentumY = this.scrollBehaviorY.end(duration);\n    meta.newX = isUndef(momentumX.destination) ? meta.newX : momentumX.destination;\n    meta.newY = isUndef(momentumY.destination) ? meta.newY : momentumY.destination;\n    meta.time = Math.max(momentumX.duration, momentumY.duration);\n    this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this); // when x or y changed, do momentum animation now!\n\n    if (meta.newX !== pos.x || meta.newY !== pos.y) {\n      // change easing function when scroller goes out of the boundaries\n      if (meta.newX > this.scrollBehaviorX.minScrollPos || meta.newX < this.scrollBehaviorX.maxScrollPos || meta.newY > this.scrollBehaviorY.minScrollPos || meta.newY < this.scrollBehaviorY.maxScrollPos) {\n        meta.easing = ease.swipeBounce;\n      }\n\n      this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\n      return true;\n    }\n  };\n\n  Scroller.prototype.checkClick = function (e) {\n    var cancelable = {\n      preventClick: this.animater.forceStopped\n    }; // we scrolled less than momentumLimitDistance pixels\n\n    if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\n      this.animater.setForceStopped(false);\n      return true;\n    }\n\n    if (!cancelable.preventClick) {\n      var _dblclick = this.options.dblclick;\n      var dblclickTrigged = false;\n\n      if (_dblclick && this.lastClickTime) {\n        var _a = _dblclick.delay,\n            delay = _a === void 0 ? 300 : _a;\n\n        if (getNow() - this.lastClickTime < delay) {\n          dblclickTrigged = true;\n          dblclick(e);\n        }\n      }\n\n      if (this.options.tap) {\n        tap(e, this.options.tap);\n      }\n\n      if (this.options.click && !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n        click(e);\n      }\n\n      this.lastClickTime = dblclickTrigged ? null : getNow();\n      return true;\n    }\n\n    return false;\n  };\n\n  Scroller.prototype.resize = function () {\n    var _this = this;\n\n    if (!this.actions.enabled) {\n      return;\n    } // fix a scroll problem under Android condition\n\n    /* istanbul ignore if  */\n\n\n    if (isAndroid) {\n      this.wrapper.scrollTop = 0;\n    }\n\n    clearTimeout(this.resizeTimeout);\n    this.resizeTimeout = window.setTimeout(function () {\n      _this.hooks.trigger(_this.hooks.eventTypes.resize);\n    }, this.options.resizePolling);\n  };\n  /* istanbul ignore next */\n\n\n  Scroller.prototype.transitionEnd = function (e) {\n    if (e.target !== this.content || !this.animater.pending) {\n      return;\n    }\n\n    var animater = this.animater;\n    animater.transitionTime();\n\n    if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\n      this.animater.setPending(false);\n\n      if (this.options.probeType !== 3\n      /* Realtime */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\n      }\n    }\n  };\n\n  Scroller.prototype.togglePointerEvents = function (enabled) {\n    if (enabled === void 0) {\n      enabled = true;\n    }\n\n    var el = this.content.children.length ? this.content.children : [this.content];\n    var pointerEvents = enabled ? 'auto' : 'none';\n\n    for (var i = 0; i < el.length; i++) {\n      var node = el[i]; // ignore BetterScroll instance's wrapper DOM\n\n      /* istanbul ignore if  */\n\n      if (node.isBScrollContainer) {\n        continue;\n      }\n\n      node.style.pointerEvents = pointerEvents;\n    }\n  };\n\n  Scroller.prototype.refresh = function (content) {\n    var contentChanged = this.setContent(content);\n    this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\n    this.scrollBehaviorX.refresh(content);\n    this.scrollBehaviorY.refresh(content);\n\n    if (contentChanged) {\n      this.translater.setContent(content);\n      this.animater.setContent(content);\n      this.transitionEndRegister.destroy();\n      this.registerTransitionEnd();\n\n      if (this.options.bindToTarget) {\n        this.actionsHandler.setContent(content);\n      }\n    }\n\n    this.actions.refresh();\n    this.wrapperOffset = offset(this.wrapper);\n  };\n\n  Scroller.prototype.setContent = function (content) {\n    var contentChanged = content !== this.content;\n\n    if (contentChanged) {\n      this.content = content;\n    }\n\n    return contentChanged;\n  };\n\n  Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    var _a = this.getCurrentPos(),\n        x = _a.x,\n        y = _a.y;\n\n    easing = !easing ? ease.bounce : easing;\n    deltaX += x;\n    deltaY += y;\n    this.scrollTo(deltaX, deltaY, time, easing);\n  };\n\n  Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    if (extraTransform === void 0) {\n      extraTransform = {\n        start: {},\n        end: {}\n      };\n    }\n\n    var easingFn = this.options.useTransition ? easing.style : easing.fn;\n    var currentPos = this.getCurrentPos();\n\n    var startPoint = _assign({\n      x: currentPos.x,\n      y: currentPos.y\n    }, extraTransform.start);\n\n    var endPoint = _assign({\n      x: x,\n      y: y\n    }, extraTransform.end);\n\n    this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint); // it is an useless move\n\n    if (isSamePoint(startPoint, endPoint)) return;\n    var deltaX = Math.abs(endPoint.x - startPoint.x);\n    var deltaY = Math.abs(endPoint.y - startPoint.y); // considering of browser compatibility for decimal transform value\n    // force translating immediately\n\n    if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\n      time = 0;\n      this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\n    }\n\n    this.animater.move(startPoint, endPoint, time, easingFn);\n  };\n\n  Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\n    var targetEle = getElement(el);\n    var pos = offset(targetEle);\n\n    var getOffset = function getOffset(offset, size, wrapperSize) {\n      if (typeof offset === 'number') {\n        return offset;\n      } // if offsetX/Y are true we center the element to the screen\n\n\n      return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\n    };\n\n    offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\n    offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\n\n    var getPos = function getPos(pos, wrapperPos, offset, scrollBehavior) {\n      pos -= wrapperPos;\n      pos = scrollBehavior.adjustPosition(pos - offset);\n      return pos;\n    };\n\n    pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\n    pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\n\n    if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\n      return;\n    }\n\n    this.scrollTo(pos.left, pos.top, time, easing);\n  };\n\n  Scroller.prototype.resetPosition = function (time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    var _a = this.scrollBehaviorX.checkInBoundary(),\n        x = _a.position,\n        xInBoundary = _a.inBoundary;\n\n    var _b = this.scrollBehaviorY.checkInBoundary(),\n        y = _b.position,\n        yInBoundary = _b.inBoundary;\n\n    if (xInBoundary && yInBoundary) {\n      return false;\n    }\n    /* istanbul ignore if  */\n\n\n    if (isIOSBadVersion) {\n      // fix ios 13.4 bouncing\n      // see it in issues 982\n      this.reflow();\n    } // out of boundary\n\n\n    this.scrollTo(x, y, time, easing);\n    return true;\n  };\n  /* istanbul ignore next */\n\n\n  Scroller.prototype.reflow = function () {\n    this._reflow = this.content.offsetHeight;\n  };\n\n  Scroller.prototype.updatePositions = function (pos) {\n    this.scrollBehaviorX.updatePosition(pos.x);\n    this.scrollBehaviorY.updatePosition(pos.y);\n  };\n\n  Scroller.prototype.getCurrentPos = function () {\n    return this.actions.getCurrentPos();\n  };\n\n  Scroller.prototype.enable = function () {\n    this.actions.enabled = true;\n  };\n\n  Scroller.prototype.disable = function () {\n    cancelAnimationFrame(this.animater.timer);\n    this.actions.enabled = false;\n  };\n\n  Scroller.prototype.destroy = function () {\n    var _this = this;\n\n    var keys = ['resizeRegister', 'transitionEndRegister', 'actionsHandler', 'actions', 'hooks', 'animater', 'translater', 'scrollBehaviorX', 'scrollBehaviorY'];\n    keys.forEach(function (key) {\n      return _this[key].destroy();\n    });\n  };\n\n  return Scroller;\n}();\n\nvar BScrollConstructor =\n/** @class */\nfunction (_super) {\n  __extends(BScrollConstructor, _super);\n\n  function BScrollConstructor(el, options) {\n    var _this = _super.call(this, ['refresh', 'contentChanged', 'enable', 'disable', 'beforeScrollStart', 'scrollStart', 'scroll', 'scrollEnd', 'scrollCancel', 'touchEnd', 'flick', 'destroy']) || this;\n\n    var wrapper = getElement(el);\n\n    if (!wrapper) {\n      warn('Can not resolve the wrapper DOM.');\n      return _this;\n    }\n\n    _this.plugins = {};\n    _this.options = new OptionsConstructor().merge(options).process();\n\n    if (!_this.setContent(wrapper).valid) {\n      return _this;\n    }\n\n    _this.hooks = new EventEmitter(['refresh', 'enable', 'disable', 'destroy', 'beforeInitialScrollTo', 'contentChanged']);\n\n    _this.init(wrapper);\n\n    return _this;\n  }\n\n  BScrollConstructor.use = function (ctor) {\n    var name = ctor.pluginName;\n    var installed = BScrollConstructor.plugins.some(function (plugin) {\n      return ctor === plugin.ctor;\n    });\n    if (installed) return BScrollConstructor;\n\n    if (isUndef(name)) {\n      warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\n      return BScrollConstructor;\n    }\n\n    BScrollConstructor.pluginsMap[name] = true;\n    BScrollConstructor.plugins.push({\n      name: name,\n      applyOrder: ctor.applyOrder,\n      ctor: ctor\n    });\n    return BScrollConstructor;\n  };\n\n  BScrollConstructor.prototype.setContent = function (wrapper) {\n    var contentChanged = false;\n    var valid = true;\n    var content = wrapper.children[this.options.specifiedIndexAsContent];\n\n    if (!content) {\n      warn('The wrapper need at least one child element to be content element to scroll.');\n      valid = false;\n    } else {\n      contentChanged = this.content !== content;\n\n      if (contentChanged) {\n        this.content = content;\n      }\n    }\n\n    return {\n      valid: valid,\n      contentChanged: contentChanged\n    };\n  };\n\n  BScrollConstructor.prototype.init = function (wrapper) {\n    var _this = this;\n\n    this.wrapper = wrapper; // mark wrapper to recognize bs instance by DOM attribute\n\n    wrapper.isBScrollContainer = true;\n    this.scroller = new Scroller(wrapper, this.content, this.options);\n    this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\n      _this.refresh();\n    });\n    this.eventBubbling();\n    this.handleAutoBlur();\n    this.enable();\n    this.proxy(propertiesConfig$7);\n    this.applyPlugins(); // maybe boundary has changed, should refresh\n\n    this.refreshWithoutReset(this.content);\n    var _a = this.options,\n        startX = _a.startX,\n        startY = _a.startY;\n    var position = {\n      x: startX,\n      y: startY\n    }; // maybe plugins want to control scroll position\n\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\n      return;\n    }\n\n    this.scroller.scrollTo(position.x, position.y);\n  };\n\n  BScrollConstructor.prototype.applyPlugins = function () {\n    var _this = this;\n\n    var options = this.options;\n    BScrollConstructor.plugins.sort(function (a, b) {\n      var _a;\n\n      var applyOrderMap = (_a = {}, _a[\"pre\"\n      /* Pre */\n      ] = -1, _a[\"post\"\n      /* Post */\n      ] = 1, _a);\n      var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\n      var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\n      return aOrder - bOrder;\n    }).forEach(function (item) {\n      var ctor = item.ctor;\n\n      if (options[item.name] && typeof ctor === 'function') {\n        _this.plugins[item.name] = new ctor(_this);\n      }\n    });\n  };\n\n  BScrollConstructor.prototype.handleAutoBlur = function () {\n    /* istanbul ignore if  */\n    if (this.options.autoBlur) {\n      this.on(this.eventTypes.beforeScrollStart, function () {\n        var activeElement = document.activeElement;\n\n        if (activeElement && (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA')) {\n          activeElement.blur();\n        }\n      });\n    }\n  };\n\n  BScrollConstructor.prototype.eventBubbling = function () {\n    bubbling(this.scroller.hooks, this, [this.eventTypes.beforeScrollStart, this.eventTypes.scrollStart, this.eventTypes.scroll, this.eventTypes.scrollEnd, this.eventTypes.scrollCancel, this.eventTypes.touchEnd, this.eventTypes.flick]);\n  };\n\n  BScrollConstructor.prototype.refreshWithoutReset = function (content) {\n    this.scroller.refresh(content);\n    this.hooks.trigger(this.hooks.eventTypes.refresh, content);\n    this.trigger(this.eventTypes.refresh, content);\n  };\n\n  BScrollConstructor.prototype.proxy = function (propertiesConfig) {\n    var _this = this;\n\n    propertiesConfig.forEach(function (_a) {\n      var key = _a.key,\n          sourceKey = _a.sourceKey;\n      propertiesProxy(_this, sourceKey, key);\n    });\n  };\n\n  BScrollConstructor.prototype.refresh = function () {\n    var _a = this.setContent(this.wrapper),\n        contentChanged = _a.contentChanged,\n        valid = _a.valid;\n\n    if (valid) {\n      var content = this.content;\n      this.refreshWithoutReset(content);\n\n      if (contentChanged) {\n        this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\n        this.trigger(this.eventTypes.contentChanged, content);\n      }\n\n      this.scroller.resetPosition();\n    }\n  };\n\n  BScrollConstructor.prototype.enable = function () {\n    this.scroller.enable();\n    this.hooks.trigger(this.hooks.eventTypes.enable);\n    this.trigger(this.eventTypes.enable);\n  };\n\n  BScrollConstructor.prototype.disable = function () {\n    this.scroller.disable();\n    this.hooks.trigger(this.hooks.eventTypes.disable);\n    this.trigger(this.eventTypes.disable);\n  };\n\n  BScrollConstructor.prototype.destroy = function () {\n    this.hooks.trigger(this.hooks.eventTypes.destroy);\n    this.trigger(this.eventTypes.destroy);\n    this.scroller.destroy();\n  };\n\n  BScrollConstructor.prototype.eventRegister = function (names) {\n    this.registerType(names);\n  };\n\n  BScrollConstructor.plugins = [];\n  BScrollConstructor.pluginsMap = {};\n  return BScrollConstructor;\n}(EventEmitter);\n\nfunction createBScroll(el, options) {\n  var bs = new BScrollConstructor(el, options);\n  return bs;\n}\n\ncreateBScroll.use = BScrollConstructor.use;\ncreateBScroll.plugins = BScrollConstructor.plugins;\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\nvar BScroll = createBScroll;\n\nvar MouseWheel =\n/** @class */\nfunction () {\n  function MouseWheel(scroll) {\n    this.scroll = scroll;\n    this.wheelEndTimer = 0;\n    this.wheelMoveTimer = 0;\n    this.wheelStart = false;\n    this.init();\n  }\n\n  MouseWheel.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks();\n    this.registerEvent();\n  };\n\n  MouseWheel.prototype.handleBScroll = function () {\n    this.scroll.registerType(['alterOptions', 'mousewheelStart', 'mousewheelMove', 'mousewheelEnd']);\n  };\n\n  MouseWheel.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.mouseWheel === true ? {} : this.scroll.options.mouseWheel;\n    var defaultOptions = {\n      speed: 20,\n      invert: false,\n      easeTime: 300,\n      discreteTime: 400,\n      throttleTime: 0,\n      dampingFactor: 0.1\n    };\n    this.mouseWheelOpt = extend(defaultOptions, userOptions);\n  };\n\n  MouseWheel.prototype.handleHooks = function () {\n    this.hooksFn = [];\n    this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\n  };\n\n  MouseWheel.prototype.registerEvent = function () {\n    this.eventRegister = new EventRegister(this.scroll.scroller.wrapper, [{\n      name: 'wheel',\n      handler: this.wheelHandler.bind(this)\n    }, {\n      name: 'mousewheel',\n      handler: this.wheelHandler.bind(this)\n    }, {\n      name: 'DOMMouseScroll',\n      handler: this.wheelHandler.bind(this)\n    }]);\n  };\n\n  MouseWheel.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  MouseWheel.prototype.wheelHandler = function (e) {\n    if (!this.scroll.enabled) {\n      return;\n    }\n\n    this.beforeHandler(e); // start\n\n    if (!this.wheelStart) {\n      this.wheelStartHandler(e);\n      this.wheelStart = true;\n    } // move\n\n\n    var delta = this.getWheelDelta(e);\n    this.wheelMoveHandler(delta); // end\n\n    this.wheelEndDetector(delta);\n  };\n\n  MouseWheel.prototype.wheelStartHandler = function (e) {\n    this.cleanCache();\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    scrollBehaviorX.setMovingDirection(0\n    /* Default */\n    );\n    scrollBehaviorY.setMovingDirection(0\n    /* Default */\n    );\n    scrollBehaviorX.setDirection(0\n    /* Default */\n    );\n    scrollBehaviorY.setDirection(0\n    /* Default */\n    );\n    this.scroll.trigger(this.scroll.eventTypes.alterOptions, this.mouseWheelOpt);\n    this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\n  };\n\n  MouseWheel.prototype.cleanCache = function () {\n    this.deltaCache = [];\n  };\n\n  MouseWheel.prototype.wheelMoveHandler = function (delta) {\n    var _this = this;\n\n    var _a = this.mouseWheelOpt,\n        throttleTime = _a.throttleTime,\n        dampingFactor = _a.dampingFactor;\n\n    if (throttleTime && this.wheelMoveTimer) {\n      this.deltaCache.push(delta);\n    } else {\n      var cachedDelta = this.deltaCache.reduce(function (prev, current) {\n        return {\n          x: prev.x + current.x,\n          y: prev.y + current.y\n        };\n      }, {\n        x: 0,\n        y: 0\n      });\n      this.cleanCache();\n      var _b = this.scroll.scroller,\n          scrollBehaviorX = _b.scrollBehaviorX,\n          scrollBehaviorY = _b.scrollBehaviorY;\n      scrollBehaviorX.setMovingDirection(-delta.directionX);\n      scrollBehaviorY.setMovingDirection(-delta.directionY);\n      scrollBehaviorX.setDirection(delta.x);\n      scrollBehaviorY.setDirection(delta.y); // when out of boundary, perform a damping scroll\n\n      var newX = scrollBehaviorX.performDampingAlgorithm(Math.round(delta.x) + cachedDelta.x, dampingFactor);\n      var newY = scrollBehaviorY.performDampingAlgorithm(Math.round(delta.y) + cachedDelta.x, dampingFactor);\n\n      if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\n        x: newX,\n        y: newY\n      })) {\n        var easeTime = this.getEaseTime();\n\n        if (newX !== this.scroll.x || newY !== this.scroll.y) {\n          this.scroll.scrollTo(newX, newY, easeTime);\n        }\n      }\n\n      if (throttleTime) {\n        this.wheelMoveTimer = window.setTimeout(function () {\n          _this.wheelMoveTimer = 0;\n        }, throttleTime);\n      }\n    }\n  };\n\n  MouseWheel.prototype.wheelEndDetector = function (delta) {\n    var _this = this;\n\n    window.clearTimeout(this.wheelEndTimer);\n    this.wheelEndTimer = window.setTimeout(function () {\n      _this.wheelStart = false;\n      window.clearTimeout(_this.wheelMoveTimer);\n      _this.wheelMoveTimer = 0;\n\n      _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\n    }, this.mouseWheelOpt.discreteTime);\n  };\n\n  MouseWheel.prototype.getWheelDelta = function (e) {\n    var _a = this.mouseWheelOpt,\n        speed = _a.speed,\n        invert = _a.invert;\n    var wheelDeltaX = 0;\n    var wheelDeltaY = 0;\n    var direction = invert ? -1\n    /* Negative */\n    : 1\n    /* Positive */\n    ;\n\n    switch (true) {\n      case 'deltaX' in e:\n        if (e.deltaMode === 1) {\n          wheelDeltaX = -e.deltaX * speed;\n          wheelDeltaY = -e.deltaY * speed;\n        } else {\n          wheelDeltaX = -e.deltaX;\n          wheelDeltaY = -e.deltaY;\n        }\n\n        break;\n\n      case 'wheelDeltaX' in e:\n        wheelDeltaX = e.wheelDeltaX / 120 * speed;\n        wheelDeltaY = e.wheelDeltaY / 120 * speed;\n        break;\n\n      case 'wheelDelta' in e:\n        wheelDeltaX = wheelDeltaY = e.wheelDelta / 120 * speed;\n        break;\n\n      case 'detail' in e:\n        wheelDeltaX = wheelDeltaY = -e.detail / 3 * speed;\n        break;\n    }\n\n    wheelDeltaX *= direction;\n    wheelDeltaY *= direction;\n\n    if (!this.scroll.hasVerticalScroll) {\n      if (Math.abs(wheelDeltaY) > Math.abs(wheelDeltaX)) {\n        wheelDeltaX = wheelDeltaY;\n      }\n\n      wheelDeltaY = 0;\n    }\n\n    if (!this.scroll.hasHorizontalScroll) {\n      wheelDeltaX = 0;\n    }\n\n    var directionX = wheelDeltaX > 0 ? -1\n    /* Negative */\n    : wheelDeltaX < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    var directionY = wheelDeltaY > 0 ? -1\n    /* Negative */\n    : wheelDeltaY < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    return {\n      x: wheelDeltaX,\n      y: wheelDeltaY,\n      directionX: directionX,\n      directionY: directionY\n    };\n  };\n\n  MouseWheel.prototype.beforeHandler = function (e) {\n    var _a = this.scroll.options,\n        preventDefault = _a.preventDefault,\n        stopPropagation = _a.stopPropagation,\n        preventDefaultException = _a.preventDefaultException;\n\n    if (preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException)) {\n      e.preventDefault();\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n    }\n  };\n\n  MouseWheel.prototype.getEaseTime = function () {\n    var SAFE_EASETIME = 100;\n    var easeTime = this.mouseWheelOpt.easeTime; // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\n    // easeTime needs to be greater than 100\n\n    if (easeTime < SAFE_EASETIME) {\n      warn(\"easeTime should be greater than 100.\" + \"If mouseWheel easeTime is too small,\" + \"scrollEnd will be triggered many times.\");\n    }\n\n    return Math.max(easeTime, SAFE_EASETIME);\n  };\n\n  MouseWheel.prototype.destroy = function () {\n    this.eventRegister.destroy();\n    window.clearTimeout(this.wheelEndTimer);\n    window.clearTimeout(this.wheelMoveTimer);\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n  };\n\n  MouseWheel.pluginName = 'mouseWheel';\n  MouseWheel.applyOrder = \"pre\"\n  /* Pre */\n  ;\n  return MouseWheel;\n}();\n\nvar ObserveDOM =\n/** @class */\nfunction () {\n  function ObserveDOM(scroll) {\n    this.scroll = scroll;\n    this.stopObserver = false;\n    this.init();\n  }\n\n  ObserveDOM.prototype.init = function () {\n    this.handleMutationObserver();\n    this.handleHooks();\n  };\n\n  ObserveDOM.prototype.handleMutationObserver = function () {\n    var _this = this;\n\n    if (typeof MutationObserver !== 'undefined') {\n      var timer_1 = 0;\n      this.observer = new MutationObserver(function (mutations) {\n        _this.mutationObserverHandler(mutations, timer_1);\n      });\n      this.startObserve(this.observer);\n    } else {\n      this.checkDOMUpdate();\n    }\n  };\n\n  ObserveDOM.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\n      _this.stopObserve(); // launch a new mutationObserver\n\n\n      _this.handleMutationObserver();\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.enable, function () {\n      if (_this.stopObserver) {\n        _this.handleMutationObserver();\n      }\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.disable, function () {\n      _this.stopObserve();\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\n      _this.destroy();\n    });\n  };\n\n  ObserveDOM.prototype.mutationObserverHandler = function (mutations, timer) {\n    var _this = this;\n\n    if (this.shouldNotRefresh()) {\n      return;\n    }\n\n    var immediateRefresh = false;\n    var deferredRefresh = false;\n\n    for (var i = 0; i < mutations.length; i++) {\n      var mutation = mutations[i];\n\n      if (mutation.type !== 'attributes') {\n        immediateRefresh = true;\n        break;\n      } else {\n        if (mutation.target !== this.scroll.scroller.content) {\n          deferredRefresh = true;\n          break;\n        }\n      }\n    }\n\n    if (immediateRefresh) {\n      this.scroll.refresh();\n    } else if (deferredRefresh) {\n      // attributes changes too often\n      clearTimeout(timer);\n      timer = window.setTimeout(function () {\n        if (!_this.shouldNotRefresh()) {\n          _this.scroll.refresh();\n        }\n      }, 60);\n    }\n  };\n\n  ObserveDOM.prototype.startObserve = function (observer) {\n    var config = {\n      attributes: true,\n      childList: true,\n      subtree: true\n    };\n    observer.observe(this.scroll.scroller.content, config);\n  };\n\n  ObserveDOM.prototype.shouldNotRefresh = function () {\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    var outsideBoundaries = scrollBehaviorX.currentPos > scrollBehaviorX.minScrollPos || scrollBehaviorX.currentPos < scrollBehaviorX.maxScrollPos || scrollBehaviorY.currentPos > scrollBehaviorY.minScrollPos || scrollBehaviorY.currentPos < scrollBehaviorY.maxScrollPos;\n    return scroller.animater.pending || outsideBoundaries;\n  };\n\n  ObserveDOM.prototype.checkDOMUpdate = function () {\n    var _this = this;\n\n    var content = this.scroll.scroller.content;\n    var contentRect = getRect(content);\n    var oldWidth = contentRect.width;\n    var oldHeight = contentRect.height;\n\n    var check = function check() {\n      if (_this.stopObserver) {\n        return;\n      }\n\n      contentRect = getRect(content);\n      var newWidth = contentRect.width;\n      var newHeight = contentRect.height;\n\n      if (oldWidth !== newWidth || oldHeight !== newHeight) {\n        _this.scroll.refresh();\n      }\n\n      oldWidth = newWidth;\n      oldHeight = newHeight;\n      next();\n    };\n\n    var next = function next() {\n      setTimeout(function () {\n        check();\n      }, 1000);\n    };\n\n    next();\n  };\n\n  ObserveDOM.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  ObserveDOM.prototype.stopObserve = function () {\n    this.stopObserver = true;\n\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n  };\n\n  ObserveDOM.prototype.destroy = function () {\n    this.stopObserve();\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  ObserveDOM.pluginName = 'observeDOM';\n  return ObserveDOM;\n}();\n\nvar sourcePrefix$6 = 'plugins.pullDownRefresh';\nvar propertiesMap$6 = [{\n  key: 'finishPullDown',\n  name: 'finishPullDown'\n}, {\n  key: 'openPullDown',\n  name: 'openPullDown'\n}, {\n  key: 'closePullDown',\n  name: 'closePullDown'\n}, {\n  key: 'autoPullDownRefresh',\n  name: 'autoPullDownRefresh'\n}];\nvar propertiesConfig$6 = propertiesMap$6.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$6 + \".\" + item.name\n  };\n});\nvar PULLING_DOWN_EVENT = 'pullingDown';\nvar ENTER_THRESHOLD_EVENT = 'enterThreshold';\nvar LEAVE_THRESHOLD_EVENT = 'leaveThreshold';\n\nvar PullDown =\n/** @class */\nfunction () {\n  function PullDown(scroll) {\n    this.scroll = scroll;\n    this.pulling = 0\n    /* DEFAULT */\n    ;\n    this.thresholdBoundary = 0\n    /* DEFAULT */\n    ;\n    this.init();\n  }\n\n  PullDown.prototype.setPulling = function (status) {\n    this.pulling = status;\n  };\n\n  PullDown.prototype.setThresholdBoundary = function (boundary) {\n    this.thresholdBoundary = boundary;\n  };\n\n  PullDown.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions(this.scroll.options.pullDownRefresh);\n    this.handleHooks();\n    this.watch();\n  };\n\n  PullDown.prototype.handleBScroll = function () {\n    this.scroll.registerType([PULLING_DOWN_EVENT, ENTER_THRESHOLD_EVENT, LEAVE_THRESHOLD_EVENT]);\n    this.scroll.proxy(propertiesConfig$6);\n  };\n\n  PullDown.prototype.handleOptions = function (userOptions) {\n    if (userOptions === void 0) {\n      userOptions = {};\n    }\n\n    userOptions = userOptions === true ? {} : userOptions;\n    var defaultOptions = {\n      threshold: 90,\n      stop: 40\n    };\n    this.options = extend(defaultOptions, userOptions);\n    this.scroll.options.probeType = 3\n    /* Realtime */\n    ;\n  };\n\n  PullDown.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorY = scroller.scrollBehaviorY;\n    this.currentMinScrollY = this.cachedOriginanMinScrollY = scrollBehaviorY.minScrollPos;\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\n      _this.finishPullDown();\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      // content is smaller than wrapper\n      if (boundary.maxScrollPos > 0) {\n        // allow scrolling when content is not full of wrapper\n        boundary.maxScrollPos = -1;\n      }\n\n      boundary.minScrollPos = _this.currentMinScrollY;\n    }); // integrate with mousewheel\n\n    if (this.hasMouseWheelPlugin()) {\n      this.registerHooks(this.scroll, this.scroll.eventTypes.alterOptions, function (mouseWheelOptions) {\n        var SANE_DISCRETE_TIME = 300;\n        var SANE_EASE_TIME = 350;\n        mouseWheelOptions.discreteTime = SANE_DISCRETE_TIME; // easeTime > discreteTime ensure goInto checkPullDown function\n\n        mouseWheelOptions.easeTime = SANE_EASE_TIME;\n      });\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function () {\n        // mouseWheel need trigger checkPullDown manually\n        scroller.hooks.trigger(scroller.hooks.eventTypes.end);\n      });\n    }\n  };\n\n  PullDown.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  PullDown.prototype.hasMouseWheelPlugin = function () {\n    return !!this.scroll.eventTypes.alterOptions;\n  };\n\n  PullDown.prototype.watch = function () {\n    var scroller = this.scroll.scroller;\n    this.watching = true;\n    this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.end, this.checkPullDown);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\n\n    if (this.hasMouseWheelPlugin()) {\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\n    }\n  };\n\n  PullDown.prototype.resetStateBeforeScrollStart = function () {\n    // current fetching pulldownRefresh has ended\n    if (!this.isFetchingStatus()) {\n      this.setPulling(1\n      /* MOVING */\n      );\n      this.setThresholdBoundary(0\n      /* DEFAULT */\n      );\n    }\n  };\n\n  PullDown.prototype.checkLocationOfThresholdBoundary = function () {\n    // pulldownRefresh is in the phase of Moving\n    if (this.pulling === 1\n    /* MOVING */\n    ) {\n      var scroll_1 = this.scroll; // enter threshold boundary\n\n      var enteredThresholdBoundary = this.thresholdBoundary !== 1\n      /* INSIDE */\n      && this.locateInsideThresholdBoundary(); // leave threshold boundary\n\n      var leftThresholdBoundary = this.thresholdBoundary !== 2\n      /* OUTSIDE */\n      && !this.locateInsideThresholdBoundary();\n\n      if (enteredThresholdBoundary) {\n        this.setThresholdBoundary(1\n        /* INSIDE */\n        );\n        scroll_1.trigger(ENTER_THRESHOLD_EVENT);\n      }\n\n      if (leftThresholdBoundary) {\n        this.setThresholdBoundary(2\n        /* OUTSIDE */\n        );\n        scroll_1.trigger(LEAVE_THRESHOLD_EVENT);\n      }\n    }\n  };\n\n  PullDown.prototype.locateInsideThresholdBoundary = function () {\n    return this.scroll.y <= this.options.threshold;\n  };\n\n  PullDown.prototype.unwatch = function () {\n    var scroll = this.scroll;\n    var scroller = scroll.scroller;\n    this.watching = false;\n    scroller.hooks.off(scroller.hooks.eventTypes.end, this.checkPullDown);\n    scroll.off(scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\n    scroll.off(scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\n\n    if (this.hasMouseWheelPlugin()) {\n      scroll.off(scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\n    }\n  };\n\n  PullDown.prototype.checkPullDown = function () {\n    var _a = this.options,\n        threshold = _a.threshold,\n        stop = _a.stop; // check if a real pull down action\n\n    if (this.scroll.y < threshold) {\n      return false;\n    }\n\n    if (this.pulling === 1\n    /* MOVING */\n    ) {\n      this.modifyBehaviorYBoundary(stop);\n      this.setPulling(2\n      /* FETCHING */\n      );\n      this.scroll.trigger(PULLING_DOWN_EVENT);\n    }\n\n    this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\n    return this.isFetchingStatus();\n  };\n\n  PullDown.prototype.isFetchingStatus = function () {\n    return this.pulling === 2\n    /* FETCHING */\n    ;\n  };\n\n  PullDown.prototype.modifyBehaviorYBoundary = function (stopDistance) {\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY; // manually modify minScrollPos for a hang animation\n    // to prevent from resetPosition\n\n    this.cachedOriginanMinScrollY = scrollBehaviorY.minScrollPos;\n    this.currentMinScrollY = stopDistance;\n    scrollBehaviorY.computeBoundary();\n  };\n\n  PullDown.prototype.finishPullDown = function () {\n    if (this.isFetchingStatus()) {\n      var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY; // restore minScrollY since the hang animation has ended\n\n      this.currentMinScrollY = this.cachedOriginanMinScrollY;\n      scrollBehaviorY.computeBoundary();\n      this.setPulling(0\n      /* DEFAULT */\n      );\n      this.scroll.resetPosition(this.scroll.options.bounceTime, ease.bounce);\n    }\n  }; // allow 'true' type is compat for beta version implements\n\n\n  PullDown.prototype.openPullDown = function (config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    this.handleOptions(config);\n\n    if (!this.watching) {\n      this.watch();\n    }\n  };\n\n  PullDown.prototype.closePullDown = function () {\n    this.unwatch();\n  };\n\n  PullDown.prototype.autoPullDownRefresh = function () {\n    var _a = this.options,\n        threshold = _a.threshold,\n        stop = _a.stop;\n\n    if (this.isFetchingStatus() || !this.watching) {\n      return;\n    }\n\n    this.modifyBehaviorYBoundary(stop);\n    this.scroll.trigger(this.scroll.eventTypes.scrollStart);\n    this.scroll.scrollTo(this.scroll.x, threshold);\n    this.setPulling(2\n    /* FETCHING */\n    );\n    this.scroll.trigger(PULLING_DOWN_EVENT);\n    this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\n  };\n\n  PullDown.pluginName = 'pullDownRefresh';\n  return PullDown;\n}();\n\nvar sourcePrefix$5 = 'plugins.pullUpLoad';\nvar propertiesMap$5 = [{\n  key: 'finishPullUp',\n  name: 'finishPullUp'\n}, {\n  key: 'openPullUp',\n  name: 'openPullUp'\n}, {\n  key: 'closePullUp',\n  name: 'closePullUp'\n}, {\n  key: 'autoPullUpLoad',\n  name: 'autoPullUpLoad'\n}];\nvar propertiesConfig$5 = propertiesMap$5.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$5 + \".\" + item.name\n  };\n});\nvar PULL_UP_HOOKS_NAME = 'pullingUp';\n\nvar PullUp =\n/** @class */\nfunction () {\n  function PullUp(scroll) {\n    this.scroll = scroll;\n    this.pulling = false;\n    this.watching = false;\n    this.init();\n  }\n\n  PullUp.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions(this.scroll.options.pullUpLoad);\n    this.handleHooks();\n    this.watch();\n  };\n\n  PullUp.prototype.handleBScroll = function () {\n    this.scroll.registerType([PULL_UP_HOOKS_NAME]);\n    this.scroll.proxy(propertiesConfig$5);\n  };\n\n  PullUp.prototype.handleOptions = function (userOptions) {\n    if (userOptions === void 0) {\n      userOptions = {};\n    }\n\n    userOptions = userOptions === true ? {} : userOptions;\n    var defaultOptions = {\n      threshold: 0\n    };\n    this.options = extend(defaultOptions, userOptions);\n    this.scroll.options.probeType = 3\n    /* Realtime */\n    ;\n  };\n\n  PullUp.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\n      _this.finishPullUp();\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      // content is smaller than wrapper\n      if (boundary.maxScrollPos > 0) {\n        // allow scrolling when content is not full of wrapper\n        boundary.maxScrollPos = -1;\n      }\n    });\n  };\n\n  PullUp.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  PullUp.prototype.watch = function () {\n    if (this.watching) {\n      return;\n    }\n\n    this.watching = true;\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkPullUp);\n  };\n\n  PullUp.prototype.unwatch = function () {\n    this.watching = false;\n    this.scroll.off(this.scroll.eventTypes.scroll, this.checkPullUp);\n  };\n\n  PullUp.prototype.checkPullUp = function (pos) {\n    var _this = this;\n\n    var threshold = this.options.threshold;\n\n    if (this.scroll.movingDirectionY === 1\n    /* Positive */\n    && pos.y <= this.scroll.maxScrollY + threshold) {\n      this.pulling = true; // must reset pulling after scrollEnd\n\n      this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\n        _this.pulling = false;\n      });\n      this.unwatch();\n      this.scroll.trigger(PULL_UP_HOOKS_NAME);\n    }\n  };\n\n  PullUp.prototype.finishPullUp = function () {\n    var _this = this; // reset Direction, fix #936\n\n\n    this.scroll.scroller.scrollBehaviorY.setMovingDirection(0\n    /* Default */\n    );\n\n    if (this.pulling) {\n      this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\n        _this.watch();\n      });\n    } else {\n      this.watch();\n    }\n  }; // allow 'true' type is compat for beta version implements\n\n\n  PullUp.prototype.openPullUp = function (config) {\n    if (config === void 0) {\n      config = {};\n    }\n\n    this.handleOptions(config);\n    this.watch();\n  };\n\n  PullUp.prototype.closePullUp = function () {\n    this.unwatch();\n  };\n\n  PullUp.prototype.autoPullUpLoad = function () {\n    var threshold = this.options.threshold;\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n\n    if (this.pulling || !this.watching) {\n      return;\n    } // simulate a pullUp action\n\n\n    var NEGATIVE_VALUE = -1;\n    var outOfBoundaryPos = scrollBehaviorY.maxScrollPos + threshold + NEGATIVE_VALUE;\n    this.scroll.scroller.scrollBehaviorY.setMovingDirection(NEGATIVE_VALUE);\n    this.scroll.scrollTo(this.scroll.x, outOfBoundaryPos, this.scroll.options.bounceTime);\n  };\n\n  PullUp.pluginName = 'pullUpLoad';\n  return PullUp;\n}();\n\nvar EventHandler =\n/** @class */\nfunction () {\n  function EventHandler(indicator, options) {\n    this.indicator = indicator;\n    this.options = options;\n    this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\n    this.registerEvents();\n  }\n\n  EventHandler.prototype.registerEvents = function () {\n    var _a = this.options,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch;\n    var startEvents = [];\n    var moveEvents = [];\n    var endEvents = [];\n\n    if (!disableMouse) {\n      startEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (!disableTouch) {\n      startEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.startEventRegister = new EventRegister(this.indicator.indicatorEl, startEvents);\n    this.moveEventRegister = new EventRegister(window, moveEvents);\n    this.endEventRegister = new EventRegister(window, endEvents);\n  };\n\n  EventHandler.prototype.BScrollIsDisabled = function () {\n    return !this.indicator.scroll.enabled;\n  };\n\n  EventHandler.prototype.start = function (e) {\n    if (this.BScrollIsDisabled()) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    e.preventDefault();\n    e.stopPropagation();\n    this.initiated = true;\n    this.lastPoint = point[this.indicator.keysMap.point];\n    this.hooks.trigger(this.hooks.eventTypes.touchStart);\n  };\n\n  EventHandler.prototype.move = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    var pointPos = point[this.indicator.keysMap.point];\n    e.preventDefault();\n    e.stopPropagation();\n    var delta = pointPos - this.lastPoint;\n    this.lastPoint = pointPos;\n    this.hooks.trigger(this.hooks.eventTypes.touchMove, delta);\n  };\n\n  EventHandler.prototype.end = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    this.initiated = false;\n    e.preventDefault();\n    e.stopPropagation();\n    this.hooks.trigger(this.hooks.eventTypes.touchEnd);\n  };\n\n  EventHandler.prototype.destroy = function () {\n    this.startEventRegister.destroy();\n    this.moveEventRegister.destroy();\n    this.endEventRegister.destroy();\n  };\n\n  return EventHandler;\n}();\n\nvar Indicator$1 =\n/** @class */\nfunction () {\n  function Indicator(scroll, options) {\n    this.scroll = scroll;\n    this.options = options;\n    this.hooksFn = [];\n    this.wrapper = options.wrapper;\n    this.direction = options.direction;\n    this.indicatorEl = this.wrapper.children[0];\n    this.keysMap = this.getKeysMap();\n    this.handleFade();\n    this.handleHooks();\n  }\n\n  Indicator.prototype.handleFade = function () {\n    if (this.options.fade) {\n      this.wrapper.style.opacity = '0';\n    }\n  };\n\n  Indicator.prototype.handleHooks = function () {\n    var _this = this;\n\n    var _a = this.options,\n        fade = _a.fade,\n        interactive = _a.interactive,\n        scrollbarTrackClickable = _a.scrollbarTrackClickable;\n    var scroll = this.scroll;\n    var scrollHooks = scroll.hooks;\n    var translaterHooks = scroll.scroller.translater.hooks;\n    var animaterHooks = scroll.scroller.animater.hooks;\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\n    this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\n      var hasScrollKey = _this.keysMap.hasScroll;\n\n      if (_this.scroll[hasScrollKey]) {\n        _this.updatePosition(pos);\n      }\n    });\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\n\n    if (fade) {\n      this.registerHooks(scroll, scroll.eventTypes.scrollEnd, function () {\n        _this.fade();\n      });\n      this.registerHooks(scroll, scroll.eventTypes.scrollStart, function () {\n        _this.fade(true);\n      }); // for mousewheel event\n\n      if (scroll.eventTypes.mousewheelStart && scroll.eventTypes.mousewheelEnd) {\n        this.registerHooks(scroll, scroll.eventTypes.mousewheelStart, function () {\n          _this.fade(true);\n        });\n        this.registerHooks(scroll, scroll.eventTypes.mousewheelMove, function () {\n          _this.fade(true);\n        });\n        this.registerHooks(scroll, scroll.eventTypes.mousewheelEnd, function () {\n          _this.fade();\n        });\n      }\n    }\n\n    if (interactive) {\n      var _b = this.scroll.options,\n          disableMouse = _b.disableMouse,\n          disableTouch = _b.disableTouch;\n      this.eventHandler = new EventHandler(this, {\n        disableMouse: disableMouse,\n        disableTouch: disableTouch\n      });\n      var eventHandlerHooks = this.eventHandler.hooks;\n      this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchStart, this.startHandler);\n      this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchMove, this.moveHandler);\n      this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchEnd, this.endHandler);\n    }\n\n    if (scrollbarTrackClickable) {\n      this.bindClick();\n    }\n  };\n\n  Indicator.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Indicator.prototype.bindClick = function () {\n    var wrapper = this.wrapper;\n    this.clickEventRegister = new EventRegister(wrapper, [{\n      name: 'click',\n      handler: this.handleClick.bind(this)\n    }]);\n  };\n\n  Indicator.prototype.handleClick = function (e) {\n    var newPos = this.calculateclickOffsetPos(e);\n    var _a = this.scroll,\n        x = _a.x,\n        y = _a.y;\n    x = this.direction === \"horizontal\"\n    /* Horizontal */\n    ? newPos : x;\n    y = this.direction === \"vertical\"\n    /* Vertical */\n    ? newPos : y;\n    this.scroll.scrollTo(x, y, this.options.scrollbarTrackOffsetTime);\n  };\n\n  Indicator.prototype.calculateclickOffsetPos = function (e) {\n    var _a = this.keysMap,\n        poinKey = _a.point,\n        domRectKey = _a.domRect;\n    var scrollbarTrackOffsetType = this.options.scrollbarTrackOffsetType;\n    var clickPointOffset = e[poinKey] - this.wrapperRect[domRectKey];\n    var scrollToWhere = clickPointOffset < this.currentPos ? -1\n    /* Up */\n    : 1\n    /* Down */\n    ;\n    var delta = 0;\n    var currentPos = this.currentPos;\n\n    if (scrollbarTrackOffsetType === \"step\"\n    /* Step */\n    ) {\n      delta = this.scrollInfo.baseSize * scrollToWhere;\n    } else {\n      delta = 0;\n      currentPos = clickPointOffset;\n    }\n\n    return this.newPos(currentPos, delta, this.scrollInfo);\n  };\n\n  Indicator.prototype.getKeysMap = function () {\n    if (this.direction === \"vertical\"\n    /* Vertical */\n    ) {\n      return {\n        hasScroll: 'hasVerticalScroll',\n        size: 'height',\n        wrapperSize: 'clientHeight',\n        scrollerSize: 'scrollerHeight',\n        maxScrollPos: 'maxScrollY',\n        pos: 'y',\n        point: 'pageY',\n        translateProperty: 'translateY',\n        domRect: 'top'\n      };\n    }\n\n    return {\n      hasScroll: 'hasHorizontalScroll',\n      size: 'width',\n      wrapperSize: 'clientWidth',\n      scrollerSize: 'scrollerWidth',\n      maxScrollPos: 'maxScrollX',\n      pos: 'x',\n      point: 'pageX',\n      translateProperty: 'translateX',\n      domRect: 'left'\n    };\n  };\n\n  Indicator.prototype.fade = function (visible) {\n    var _a = this.options,\n        fadeInTime = _a.fadeInTime,\n        fadeOutTime = _a.fadeOutTime;\n    var time = visible ? fadeInTime : fadeOutTime;\n    var wrapper = this.wrapper;\n    wrapper.style[style.transitionDuration] = time + 'ms';\n    wrapper.style.opacity = visible ? '1' : '0';\n  };\n\n  Indicator.prototype.refresh = function () {\n    var hasScrollKey = this.keysMap.hasScroll;\n    var scroll = this.scroll;\n    var x = scroll.x,\n        y = scroll.y;\n    this.wrapperRect = this.wrapper.getBoundingClientRect();\n\n    if (this.canScroll(scroll[hasScrollKey])) {\n      var _a = this.keysMap,\n          wrapperSizeKey = _a.wrapperSize,\n          scrollerSizeKey = _a.scrollerSize,\n          maxScrollPosKey = _a.maxScrollPos;\n      this.scrollInfo = this.refreshScrollInfo(this.wrapper[wrapperSizeKey], scroll[scrollerSizeKey], scroll[maxScrollPosKey], this.indicatorEl[wrapperSizeKey]);\n      this.updatePosition({\n        x: x,\n        y: y\n      });\n    }\n  };\n\n  Indicator.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.indicatorEl.style[style.transitionDuration] = time + 'ms';\n  };\n\n  Indicator.prototype.transitionTimingFunction = function (easing) {\n    this.indicatorEl.style[style.transitionTimingFunction] = easing;\n  };\n\n  Indicator.prototype.canScroll = function (hasScroll) {\n    this.wrapper.style.display = hasScroll ? 'block' : 'none';\n    return hasScroll;\n  };\n\n  Indicator.prototype.refreshScrollInfo = function (wrapperSize, scrollerSize, maxScrollPos, indicatorElSize) {\n    var baseSize = Math.max(Math.round(wrapperSize * wrapperSize / (scrollerSize || wrapperSize || 1)), this.options.minSize);\n\n    if (this.options.isCustom) {\n      baseSize = indicatorElSize;\n    }\n\n    var maxIndicatorScrollPos = wrapperSize - baseSize; // sizeRatio is negative\n\n    var sizeRatio = maxIndicatorScrollPos / maxScrollPos;\n    return {\n      baseSize: baseSize,\n      maxScrollPos: maxIndicatorScrollPos,\n      minScrollPos: 0,\n      sizeRatio: sizeRatio\n    };\n  };\n\n  Indicator.prototype.updatePosition = function (point) {\n    var _a = this.caculatePosAndSize(point, this.scrollInfo),\n        pos = _a.pos,\n        size = _a.size;\n\n    this.refreshStyle(size, pos);\n    this.currentPos = pos;\n  };\n\n  Indicator.prototype.caculatePosAndSize = function (point, scrollInfo) {\n    var posKey = this.keysMap.pos;\n    var sizeRatio = scrollInfo.sizeRatio,\n        baseSize = scrollInfo.baseSize,\n        maxScrollPos = scrollInfo.maxScrollPos,\n        minScrollPos = scrollInfo.minScrollPos;\n    var minSize = this.options.minSize;\n    var pos = Math.round(sizeRatio * point[posKey]);\n    var size; // when out of boundary, slow down size reduction\n\n    if (pos < minScrollPos) {\n      size = Math.max(baseSize + pos * 3, minSize);\n      pos = minScrollPos;\n    } else if (pos > maxScrollPos) {\n      size = Math.max(baseSize - (pos - maxScrollPos) * 3, minSize);\n      pos = maxScrollPos + baseSize - size;\n    } else {\n      size = baseSize;\n    }\n\n    return {\n      pos: pos,\n      size: size\n    };\n  };\n\n  Indicator.prototype.refreshStyle = function (size, pos) {\n    var _a = this.keysMap,\n        translatePropertyKey = _a.translateProperty,\n        sizeKey = _a.size;\n    var translateZ = this.scroll.options.translateZ;\n    this.indicatorEl.style[sizeKey] = size + \"px\";\n    this.indicatorEl.style[style.transform] = translatePropertyKey + \"(\" + pos + \"px)\" + translateZ;\n  };\n\n  Indicator.prototype.startHandler = function () {\n    this.moved = false;\n    this.startTime = getNow();\n    this.transitionTime();\n    this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\n  };\n\n  Indicator.prototype.moveHandler = function (delta) {\n    if (!this.moved && !this.indicatorNotMoved(delta)) {\n      this.moved = true;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\n    }\n\n    if (this.moved) {\n      var newPos = this.newPos(this.currentPos, delta, this.scrollInfo);\n      this.syncBScroll(newPos);\n    }\n  };\n\n  Indicator.prototype.endHandler = function () {\n    if (this.moved) {\n      var _a = this.scroll,\n          x = _a.x,\n          y = _a.y;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\n        x: x,\n        y: y\n      });\n    }\n  };\n\n  Indicator.prototype.indicatorNotMoved = function (delta) {\n    var currentPos = this.currentPos;\n    var _a = this.scrollInfo,\n        maxScrollPos = _a.maxScrollPos,\n        minScrollPos = _a.minScrollPos;\n    var notMoved = currentPos === minScrollPos && delta <= 0 || currentPos === maxScrollPos && delta >= 0;\n    return notMoved;\n  };\n\n  Indicator.prototype.syncBScroll = function (newPos) {\n    var timestamp = getNow();\n    var _a = this.scroll,\n        x = _a.x,\n        y = _a.y,\n        options = _a.options,\n        scroller = _a.scroller,\n        maxScrollY = _a.maxScrollY,\n        minScrollY = _a.minScrollY,\n        maxScrollX = _a.maxScrollX,\n        minScrollX = _a.minScrollX;\n    var probeType = options.probeType,\n        momentumLimitTime = options.momentumLimitTime;\n    var position = {\n      x: x,\n      y: y\n    };\n\n    if (this.direction === \"vertical\"\n    /* Vertical */\n    ) {\n      position.y = between(newPos, maxScrollY, minScrollY);\n    } else {\n      position.x = between(newPos, maxScrollX, minScrollX);\n    }\n\n    scroller.translater.translate(position); // dispatch scroll in interval time\n\n    if (timestamp - this.startTime > momentumLimitTime) {\n      this.startTime = timestamp;\n\n      if (probeType === 1\n      /* Throttle */\n      ) {\n        scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\n      }\n    } // dispatch scroll all the time\n\n\n    if (probeType > 1\n    /* Throttle */\n    ) {\n      scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\n    }\n  };\n\n  Indicator.prototype.newPos = function (currentPos, delta, scrollInfo) {\n    var maxScrollPos = scrollInfo.maxScrollPos,\n        sizeRatio = scrollInfo.sizeRatio,\n        minScrollPos = scrollInfo.minScrollPos;\n    var newPos = currentPos + delta;\n    newPos = between(newPos, minScrollPos, maxScrollPos);\n    return Math.round(newPos / sizeRatio);\n  };\n\n  Indicator.prototype.destroy = function () {\n    var _a = this.options,\n        interactive = _a.interactive,\n        scrollbarTrackClickable = _a.scrollbarTrackClickable,\n        isCustom = _a.isCustom;\n\n    if (interactive) {\n      this.eventHandler.destroy();\n    }\n\n    if (scrollbarTrackClickable) {\n      this.clickEventRegister.destroy();\n    }\n\n    if (!isCustom) {\n      this.wrapper.parentNode.removeChild(this.wrapper);\n    }\n\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  return Indicator;\n}();\n\nvar ScrollBar =\n/** @class */\nfunction () {\n  function ScrollBar(scroll) {\n    this.scroll = scroll;\n    this.handleOptions();\n    this.createIndicators();\n    this.handleHooks();\n  }\n\n  ScrollBar.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    scroll.hooks.on(scroll.hooks.eventTypes.destroy, function () {\n      for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\n        var indicator = _a[_i];\n        indicator.destroy();\n      }\n    });\n  };\n\n  ScrollBar.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.scrollbar === true ? {} : this.scroll.options.scrollbar;\n    var defaultOptions = {\n      fade: true,\n      fadeInTime: 250,\n      fadeOutTime: 500,\n      interactive: false,\n      customElements: [],\n      minSize: 8,\n      scrollbarTrackClickable: false,\n      scrollbarTrackOffsetType: \"step\"\n      /* Step */\n      ,\n      scrollbarTrackOffsetTime: 300\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  ScrollBar.prototype.createIndicators = function () {\n    var indicatorOptions;\n    var scroll = this.scroll;\n    var indicators = [];\n    var scrollDirectionConfigKeys = ['scrollX', 'scrollY'];\n    var indicatorDirections = [\"horizontal\"\n    /* Horizontal */\n    , \"vertical\"\n    /* Vertical */\n    ];\n    var customScrollbarEls = this.options.customElements;\n\n    for (var i = 0; i < scrollDirectionConfigKeys.length; i++) {\n      var key = scrollDirectionConfigKeys[i]; // wanna scroll in specified direction\n\n      if (scroll.options[key]) {\n        var customElement = customScrollbarEls.shift();\n        var direction = indicatorDirections[i];\n        var isCustom = false;\n        var scrollbarWrapper = customElement ? customElement : this.createScrollbarElement(direction); // internal scrollbar\n\n        if (scrollbarWrapper !== customElement) {\n          scroll.wrapper.appendChild(scrollbarWrapper);\n        } else {\n          // custom scrollbar passed by users\n          isCustom = true;\n        }\n\n        indicatorOptions = _assign(_assign({\n          wrapper: scrollbarWrapper,\n          direction: direction\n        }, this.options), {\n          isCustom: isCustom\n        });\n        indicators.push(new Indicator$1(scroll, indicatorOptions));\n      }\n    }\n\n    this.indicators = indicators;\n  };\n\n  ScrollBar.prototype.createScrollbarElement = function (direction, scrollbarTrackClickable) {\n    if (scrollbarTrackClickable === void 0) {\n      scrollbarTrackClickable = this.options.scrollbarTrackClickable;\n    }\n\n    var scrollbarWrapperEl = document.createElement('div');\n    var scrollbarIndicatorEl = document.createElement('div');\n    scrollbarWrapperEl.style.cssText = 'position:absolute;z-index:9999;overflow:hidden;';\n    scrollbarIndicatorEl.style.cssText = 'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\n    scrollbarIndicatorEl.className = 'bscroll-indicator';\n\n    if (direction === \"horizontal\"\n    /* Horizontal */\n    ) {\n      scrollbarWrapperEl.style.cssText += 'height:7px;left:2px;right:2px;bottom:0;';\n      scrollbarIndicatorEl.style.height = '100%';\n      scrollbarWrapperEl.className = 'bscroll-horizontal-scrollbar';\n    } else {\n      scrollbarWrapperEl.style.cssText += 'width:7px;bottom:2px;top:2px;right:1px;';\n      scrollbarIndicatorEl.style.width = '100%';\n      scrollbarWrapperEl.className = 'bscroll-vertical-scrollbar';\n    }\n\n    if (!scrollbarTrackClickable) {\n      scrollbarWrapperEl.style.cssText += 'pointer-events:none;';\n    }\n\n    scrollbarWrapperEl.appendChild(scrollbarIndicatorEl);\n    return scrollbarWrapperEl;\n  };\n\n  ScrollBar.pluginName = 'scrollbar';\n  return ScrollBar;\n}();\n\nvar PagesMatrix =\n/** @class */\nfunction () {\n  function PagesMatrix(scroll) {\n    this.scroll = scroll;\n    this.init();\n  }\n\n  PagesMatrix.prototype.init = function () {\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    this.wrapperWidth = scrollBehaviorX.wrapperSize;\n    this.wrapperHeight = scrollBehaviorY.wrapperSize;\n    this.scrollerHeight = scrollBehaviorY.contentSize;\n    this.scrollerWidth = scrollBehaviorX.contentSize;\n    this.pages = this.buildPagesMatrix(this.wrapperWidth, this.wrapperHeight);\n    this.pageLengthOfX = this.pages ? this.pages.length : 0;\n    this.pageLengthOfY = this.pages && this.pages[0] ? this.pages[0].length : 0;\n  };\n\n  PagesMatrix.prototype.getPageStats = function (pageX, pageY) {\n    return this.pages[pageX][pageY];\n  };\n\n  PagesMatrix.prototype.getNearestPageIndex = function (x, y) {\n    var pageX = 0;\n    var pageY = 0;\n    var l = this.pages.length;\n\n    for (; pageX < l - 1; pageX++) {\n      if (x >= this.pages[pageX][0].cx) {\n        break;\n      }\n    }\n\n    l = this.pages[pageX].length;\n\n    for (; pageY < l - 1; pageY++) {\n      if (y >= this.pages[0][pageY].cy) {\n        break;\n      }\n    }\n\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }; // (n x 1) matrix for horizontal scroll or\n  // (1 * n) matrix for vertical scroll\n\n\n  PagesMatrix.prototype.buildPagesMatrix = function (stepX, stepY) {\n    var pages = [];\n    var x = 0;\n    var y;\n    var cx;\n    var cy;\n    var i = 0;\n    var l;\n    var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\n    var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\n    cx = Math.round(stepX / 2);\n    cy = Math.round(stepY / 2);\n\n    while (x > -this.scrollerWidth) {\n      pages[i] = [];\n      l = 0;\n      y = 0;\n\n      while (y > -this.scrollerHeight) {\n        pages[i][l] = {\n          x: Math.max(x, maxScrollPosX),\n          y: Math.max(y, maxScrollPosY),\n          width: stepX,\n          height: stepY,\n          cx: x - cx,\n          cy: y - cy\n        };\n        y -= stepY;\n        l++;\n      }\n\n      x -= stepX;\n      i++;\n    }\n\n    return pages;\n  };\n\n  return PagesMatrix;\n}();\n\nvar BASE_PAGE = {\n  pageX: 0,\n  pageY: 0,\n  x: 0,\n  y: 0\n};\n\nvar SlidePages =\n/** @class */\nfunction () {\n  function SlidePages(scroll, slideOptions) {\n    this.scroll = scroll;\n    this.slideOptions = slideOptions;\n    this.slideX = false;\n    this.slideY = false;\n    this.currentPage = extend({}, BASE_PAGE);\n  }\n\n  SlidePages.prototype.refresh = function () {\n    this.pagesMatrix = new PagesMatrix(this.scroll);\n    this.checkSlideLoop();\n    this.currentPage = this.getAdjustedCurrentPage();\n  };\n\n  SlidePages.prototype.getAdjustedCurrentPage = function () {\n    var _a = this.currentPage,\n        pageX = _a.pageX,\n        pageY = _a.pageY; // page index should be handled\n    // because page counts may reduce\n\n    pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 1);\n    pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 1); // loop scene should also be respected\n    // because clonedNode will cause pageLength increasing\n\n    if (this.loopX) {\n      pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 2);\n    }\n\n    if (this.loopY) {\n      pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 2);\n    }\n\n    var _b = this.pagesMatrix.getPageStats(pageX, pageY),\n        x = _b.x,\n        y = _b.y;\n\n    return {\n      pageX: pageX,\n      pageY: pageY,\n      x: x,\n      y: y\n    };\n  };\n\n  SlidePages.prototype.setCurrentPage = function (newPage) {\n    this.currentPage = newPage;\n  };\n\n  SlidePages.prototype.getInternalPage = function (pageX, pageY) {\n    if (pageX >= this.pagesMatrix.pageLengthOfX) {\n      pageX = this.pagesMatrix.pageLengthOfX - 1;\n    } else if (pageX < 0) {\n      pageX = 0;\n    }\n\n    if (pageY >= this.pagesMatrix.pageLengthOfY) {\n      pageY = this.pagesMatrix.pageLengthOfY - 1;\n    } else if (pageY < 0) {\n      pageY = 0;\n    }\n\n    var _a = this.pagesMatrix.getPageStats(pageX, pageY),\n        x = _a.x,\n        y = _a.y;\n\n    return {\n      pageX: pageX,\n      pageY: pageY,\n      x: x,\n      y: y\n    };\n  };\n\n  SlidePages.prototype.getInitialPage = function (showFirstPage, firstInitialised) {\n    if (showFirstPage === void 0) {\n      showFirstPage = false;\n    }\n\n    if (firstInitialised === void 0) {\n      firstInitialised = false;\n    }\n\n    var _a = this.slideOptions,\n        startPageXIndex = _a.startPageXIndex,\n        startPageYIndex = _a.startPageYIndex;\n    var firstPageX = this.loopX ? 1 : 0;\n    var firstPageY = this.loopY ? 1 : 0;\n    var pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\n    var pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\n\n    if (firstInitialised) {\n      pageX = this.loopX ? startPageXIndex + 1 : startPageXIndex;\n      pageY = this.loopY ? startPageYIndex + 1 : startPageYIndex;\n    } else {\n      pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\n      pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\n    }\n\n    var _b = this.pagesMatrix.getPageStats(pageX, pageY),\n        x = _b.x,\n        y = _b.y;\n\n    return {\n      pageX: pageX,\n      pageY: pageY,\n      x: x,\n      y: y\n    };\n  };\n\n  SlidePages.prototype.getExposedPage = function (page) {\n    var exposedPage = extend({}, page); // only pageX or pageY need fix\n\n    if (this.loopX) {\n      exposedPage.pageX = this.fixedPage(exposedPage.pageX, this.pagesMatrix.pageLengthOfX - 2);\n    }\n\n    if (this.loopY) {\n      exposedPage.pageY = this.fixedPage(exposedPage.pageY, this.pagesMatrix.pageLengthOfY - 2);\n    }\n\n    return exposedPage;\n  };\n\n  SlidePages.prototype.getExposedPageByPageIndex = function (pageIndexX, pageIndexY) {\n    var page = {\n      pageX: pageIndexX,\n      pageY: pageIndexY\n    };\n\n    if (this.loopX) {\n      page.pageX = pageIndexX + 1;\n    }\n\n    if (this.loopY) {\n      page.pageY = pageIndexY + 1;\n    }\n\n    var _a = this.pagesMatrix.getPageStats(page.pageX, page.pageY),\n        x = _a.x,\n        y = _a.y;\n\n    return {\n      x: x,\n      y: y,\n      pageX: pageIndexX,\n      pageY: pageIndexY\n    };\n  };\n\n  SlidePages.prototype.getWillChangedPage = function (page) {\n    page = extend({}, page); // Page need fix\n\n    if (this.loopX) {\n      page.pageX = this.fixedPage(page.pageX, this.pagesMatrix.pageLengthOfX - 2);\n      page.x = this.pagesMatrix.getPageStats(page.pageX + 1, 0).x;\n    }\n\n    if (this.loopY) {\n      page.pageY = this.fixedPage(page.pageY, this.pagesMatrix.pageLengthOfY - 2);\n      page.y = this.pagesMatrix.getPageStats(0, page.pageY + 1).y;\n    }\n\n    return page;\n  };\n\n  SlidePages.prototype.fixedPage = function (page, realPageLen) {\n    var pageIndex = [];\n\n    for (var i = 0; i < realPageLen; i++) {\n      pageIndex.push(i);\n    }\n\n    pageIndex.unshift(realPageLen - 1);\n    pageIndex.push(0);\n    return pageIndex[page];\n  };\n\n  SlidePages.prototype.getPageStats = function () {\n    return this.pagesMatrix.getPageStats(this.currentPage.pageX, this.currentPage.pageY);\n  };\n\n  SlidePages.prototype.getValidPageIndex = function (x, y) {\n    var lastX = this.pagesMatrix.pageLengthOfX - 1;\n    var lastY = this.pagesMatrix.pageLengthOfY - 1;\n    var firstX = 0;\n    var firstY = 0;\n\n    if (this.loopX) {\n      x += 1;\n      firstX = firstX + 1;\n      lastX = lastX - 1;\n    }\n\n    if (this.loopY) {\n      y += 1;\n      firstY = firstY + 1;\n      lastY = lastY - 1;\n    }\n\n    x = between(x, firstX, lastX);\n    y = between(y, firstY, lastY);\n    return {\n      pageX: x,\n      pageY: y\n    };\n  };\n\n  SlidePages.prototype.nextPageIndex = function () {\n    return this.getPageIndexByDirection(\"positive\"\n    /* Positive */\n    );\n  };\n\n  SlidePages.prototype.prevPageIndex = function () {\n    return this.getPageIndexByDirection(\"negative\"\n    /* Negative */\n    );\n  };\n\n  SlidePages.prototype.getNearestPage = function (x, y) {\n    var pageIndex = this.pagesMatrix.getNearestPageIndex(x, y);\n    var pageX = pageIndex.pageX,\n        pageY = pageIndex.pageY;\n    var newX = this.pagesMatrix.getPageStats(pageX, 0).x;\n    var newY = this.pagesMatrix.getPageStats(0, pageY).y;\n    return {\n      x: newX,\n      y: newY,\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n\n  SlidePages.prototype.getPageByDirection = function (page, directionX, directionY) {\n    var pageX = page.pageX,\n        pageY = page.pageY;\n\n    if (pageX === this.currentPage.pageX) {\n      pageX = between(pageX + directionX, 0, this.pagesMatrix.pageLengthOfX - 1);\n    }\n\n    if (pageY === this.currentPage.pageY) {\n      pageY = between(pageY + directionY, 0, this.pagesMatrix.pageLengthOfY - 1);\n    }\n\n    var x = this.pagesMatrix.getPageStats(pageX, 0).x;\n    var y = this.pagesMatrix.getPageStats(0, pageY).y;\n    return {\n      x: x,\n      y: y,\n      pageX: pageX,\n      pageY: pageY\n    };\n  };\n\n  SlidePages.prototype.resetLoopPage = function () {\n    if (this.loopX) {\n      if (this.currentPage.pageX === 0) {\n        return {\n          pageX: this.pagesMatrix.pageLengthOfX - 2,\n          pageY: this.currentPage.pageY\n        };\n      }\n\n      if (this.currentPage.pageX === this.pagesMatrix.pageLengthOfX - 1) {\n        return {\n          pageX: 1,\n          pageY: this.currentPage.pageY\n        };\n      }\n    }\n\n    if (this.loopY) {\n      if (this.currentPage.pageY === 0) {\n        return {\n          pageX: this.currentPage.pageX,\n          pageY: this.pagesMatrix.pageLengthOfY - 2\n        };\n      }\n\n      if (this.currentPage.pageY === this.pagesMatrix.pageLengthOfY - 1) {\n        return {\n          pageX: this.currentPage.pageX,\n          pageY: 1\n        };\n      }\n    }\n  };\n\n  SlidePages.prototype.getPageIndexByDirection = function (direction) {\n    var x = this.currentPage.pageX;\n    var y = this.currentPage.pageY;\n\n    if (this.slideX) {\n      x = direction === \"negative\"\n      /* Negative */\n      ? x - 1 : x + 1;\n    }\n\n    if (this.slideY) {\n      y = direction === \"negative\"\n      /* Negative */\n      ? y - 1 : y + 1;\n    }\n\n    return {\n      pageX: x,\n      pageY: y\n    };\n  };\n\n  SlidePages.prototype.checkSlideLoop = function () {\n    this.wannaLoop = this.slideOptions.loop;\n\n    if (this.pagesMatrix.pageLengthOfX > 1) {\n      this.slideX = true;\n    } else {\n      this.slideX = false;\n    }\n\n    if (this.pagesMatrix.pages[0] && this.pagesMatrix.pageLengthOfY > 1) {\n      this.slideY = true;\n    } else {\n      this.slideY = false;\n    }\n\n    this.loopX = this.wannaLoop && this.slideX;\n    this.loopY = this.wannaLoop && this.slideY;\n\n    if (this.slideX && this.slideY) {\n      warn('slide does not support two direction at the same time.');\n    }\n  };\n\n  return SlidePages;\n}();\n\nvar sourcePrefix$4 = 'plugins.slide';\nvar propertiesMap$4 = [{\n  key: 'next',\n  name: 'next'\n}, {\n  key: 'prev',\n  name: 'prev'\n}, {\n  key: 'goToPage',\n  name: 'goToPage'\n}, {\n  key: 'getCurrentPage',\n  name: 'getCurrentPage'\n}, {\n  key: 'startPlay',\n  name: 'startPlay'\n}, {\n  key: 'pausePlay',\n  name: 'pausePlay'\n}];\nvar propertiesConfig$4 = propertiesMap$4.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$4 + \".\" + item.name\n  };\n});\n\nvar samePage = function samePage(p1, p2) {\n  return p1.pageX === p2.pageX && p1.pageY === p2.pageY;\n};\n\nvar Slide =\n/** @class */\nfunction () {\n  function Slide(scroll) {\n    this.scroll = scroll;\n    this.cachedClonedPageDOM = [];\n    this.resetLooping = false;\n    this.autoplayTimer = 0;\n\n    if (!this.satisfyInitialization()) {\n      return;\n    }\n\n    this.init();\n  }\n\n  Slide.prototype.satisfyInitialization = function () {\n    if (this.scroll.scroller.content.children.length <= 0) {\n      warn(\"slide need at least one slide page to be initialised.\" + \"please check your DOM layout.\");\n      return false;\n    }\n\n    return true;\n  };\n\n  Slide.prototype.init = function () {\n    this.willChangeToPage = extend({}, BASE_PAGE);\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks();\n    this.createPages();\n  };\n\n  Slide.prototype.createPages = function () {\n    this.pages = new SlidePages(this.scroll, this.options);\n  };\n\n  Slide.prototype.handleBScroll = function () {\n    this.scroll.registerType(['slideWillChange', 'slidePageChanged']);\n    this.scroll.proxy(propertiesConfig$4);\n  };\n\n  Slide.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.slide === true ? {} : this.scroll.options.slide;\n    var defaultOptions = {\n      loop: true,\n      threshold: 0.1,\n      speed: 400,\n      easing: ease.bounce,\n      listenFlick: true,\n      autoplay: true,\n      interval: 3000,\n      startPageXIndex: 0,\n      startPageYIndex: 0\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  Slide.prototype.handleLoop = function (prevSlideContent) {\n    var loop = this.options.loop;\n    var slideContent = this.scroll.scroller.content;\n    var currentSlidePagesLength = slideContent.children.length; // only should respect loop scene\n\n    if (loop) {\n      if (slideContent !== prevSlideContent) {\n        this.resetLoopChangedStatus();\n        this.removeClonedSlidePage(prevSlideContent);\n        currentSlidePagesLength > 1 && this.cloneFirstAndLastSlidePage(slideContent);\n      } else {\n        // many pages reduce to one page\n        if (currentSlidePagesLength === 3 && this.initialised) {\n          this.removeClonedSlidePage(slideContent);\n          this.moreToOnePageInLoop = true;\n          this.oneToMorePagesInLoop = false;\n        } else if (currentSlidePagesLength > 1) {\n          // one page increases to many page\n          if (this.initialised && this.cachedClonedPageDOM.length === 0) {\n            this.oneToMorePagesInLoop = true;\n            this.moreToOnePageInLoop = false;\n          } else {\n            this.removeClonedSlidePage(slideContent);\n            this.resetLoopChangedStatus();\n          }\n\n          this.cloneFirstAndLastSlidePage(slideContent);\n        } else {\n          this.resetLoopChangedStatus();\n        }\n      }\n    }\n  };\n\n  Slide.prototype.resetLoopChangedStatus = function () {\n    this.moreToOnePageInLoop = false;\n    this.oneToMorePagesInLoop = false;\n  };\n\n  Slide.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scrollHooks = this.scroll.hooks;\n    var scrollerHooks = this.scroll.scroller.hooks;\n    var listenFlick = this.options.listenFlick;\n    this.prevContent = this.scroll.scroller.content;\n    this.hooksFn = []; // scroll\n\n    this.registerHooks(this.scroll, this.scroll.eventTypes.beforeScrollStart, this.pausePlay);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.modifyCurrentPage);\n    this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.startPlay); // for mousewheel event\n\n    if (this.scroll.eventTypes.mousewheelMove) {\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelMove, function () {\n        // prevent default action of mousewheelMove\n        return true;\n      });\n      this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function (delta) {\n        if (delta.directionX === 1\n        /* Positive */\n        || delta.directionY === 1\n        /* Positive */\n        ) {\n          _this.next();\n        }\n\n        if (delta.directionX === -1\n        /* Negative */\n        || delta.directionY === -1\n        /* Negative */\n        ) {\n          _this.prev();\n        }\n      });\n    } // scrollHooks\n\n\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refreshHandler);\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.destroy, this.destroy); // scroller\n\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.beforeRefresh, function () {\n      _this.handleLoop(_this.prevContent);\n\n      _this.setSlideInlineStyle();\n    });\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.momentum, this.modifyScrollMetaHandler);\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.scroll, this.scrollHandler); // a click operation will clearTimer, so restart a new one\n\n    this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.checkClick, this.startPlay);\n\n    if (listenFlick) {\n      this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.flick, this.flickHandler);\n    }\n  };\n\n  Slide.prototype.startPlay = function () {\n    var _this = this;\n\n    var _a = this.options,\n        interval = _a.interval,\n        autoplay = _a.autoplay;\n\n    if (autoplay) {\n      clearTimeout(this.autoplayTimer);\n      this.autoplayTimer = window.setTimeout(function () {\n        _this.next();\n      }, interval);\n    }\n  };\n\n  Slide.prototype.pausePlay = function () {\n    if (this.options.autoplay) {\n      clearTimeout(this.autoplayTimer);\n    }\n  };\n\n  Slide.prototype.setSlideInlineStyle = function () {\n    var styleConfigurations = [{\n      direction: 'scrollX',\n      sizeType: 'offsetWidth',\n      styleType: 'width'\n    }, {\n      direction: 'scrollY',\n      sizeType: 'offsetHeight',\n      styleType: 'height'\n    }];\n    var _a = this.scroll.scroller,\n        slideContent = _a.content,\n        slideWrapper = _a.wrapper;\n    var scrollOptions = this.scroll.options;\n    styleConfigurations.forEach(function (_a) {\n      var direction = _a.direction,\n          sizeType = _a.sizeType,\n          styleType = _a.styleType; // wanna scroll in this direction\n\n      if (scrollOptions[direction]) {\n        var size = slideWrapper[sizeType];\n        var children = slideContent.children;\n        var length_1 = children.length;\n\n        for (var i = 0; i < length_1; i++) {\n          var slidePageDOM = children[i];\n          slidePageDOM.style[styleType] = size + 'px';\n        }\n\n        slideContent.style[styleType] = size * length_1 + 'px';\n      }\n    });\n  };\n\n  Slide.prototype.next = function (time, easing) {\n    var _a = this.pages.nextPageIndex(),\n        pageX = _a.pageX,\n        pageY = _a.pageY;\n\n    this.goTo(pageX, pageY, time, easing);\n  };\n\n  Slide.prototype.prev = function (time, easing) {\n    var _a = this.pages.prevPageIndex(),\n        pageX = _a.pageX,\n        pageY = _a.pageY;\n\n    this.goTo(pageX, pageY, time, easing);\n  };\n\n  Slide.prototype.goToPage = function (pageX, pageY, time, easing) {\n    var pageIndex = this.pages.getValidPageIndex(pageX, pageY);\n    this.goTo(pageIndex.pageX, pageIndex.pageY, time, easing);\n  };\n\n  Slide.prototype.getCurrentPage = function () {\n    return this.exposedPage || this.pages.getInitialPage(false, true);\n  };\n\n  Slide.prototype.setCurrentPage = function (page) {\n    this.pages.setCurrentPage(page);\n    this.exposedPage = this.pages.getExposedPage(page);\n  };\n\n  Slide.prototype.nearestPage = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var maxScrollPosX = scrollBehaviorX.maxScrollPos,\n        minScrollPosX = scrollBehaviorX.minScrollPos;\n    var maxScrollPosY = scrollBehaviorY.maxScrollPos,\n        minScrollPosY = scrollBehaviorY.minScrollPos;\n    return this.pages.getNearestPage(between(x, maxScrollPosX, minScrollPosX), between(y, maxScrollPosY, minScrollPosY));\n  };\n\n  Slide.prototype.satisfyThreshold = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var satisfied = true;\n\n    if (Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX && Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY) {\n      satisfied = false;\n    }\n\n    return satisfied;\n  };\n\n  Slide.prototype.refreshHandler = function (content) {\n    var _this = this;\n\n    if (!this.satisfyInitialization()) {\n      return;\n    }\n\n    this.pages.refresh();\n    this.computeThreshold();\n    var contentChanged = this.contentChanged = this.prevContent !== content;\n\n    if (contentChanged) {\n      this.prevContent = content;\n    }\n\n    var initPage = this.pages.getInitialPage(this.oneToMorePagesInLoop || this.moreToOnePageInLoop, contentChanged || !this.initialised);\n\n    if (this.initialised) {\n      this.goTo(initPage.pageX, initPage.pageY, 0);\n    } else {\n      this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\n        _this.initialised = true;\n        position.x = initPage.x;\n        position.y = initPage.y;\n      });\n    }\n\n    this.startPlay();\n  };\n\n  Slide.prototype.computeThreshold = function () {\n    var threshold = this.options.threshold; // Integer\n\n    if (threshold % 1 === 0) {\n      this.thresholdX = threshold;\n      this.thresholdY = threshold;\n    } else {\n      // decimal\n      var _a = this.pages.getPageStats(),\n          width = _a.width,\n          height = _a.height;\n\n      this.thresholdX = Math.round(width * threshold);\n      this.thresholdY = Math.round(height * threshold);\n    }\n  };\n\n  Slide.prototype.cloneFirstAndLastSlidePage = function (slideContent) {\n    var children = slideContent.children;\n    var preprendDOM = children[children.length - 1].cloneNode(true);\n    var appendDOM = children[0].cloneNode(true);\n    prepend(preprendDOM, slideContent);\n    slideContent.appendChild(appendDOM);\n    this.cachedClonedPageDOM = [preprendDOM, appendDOM];\n  };\n\n  Slide.prototype.removeClonedSlidePage = function (slideContent) {\n    // maybe slideContent has removed from DOM Tree\n    var slidePages = slideContent && slideContent.children || [];\n\n    if (slidePages.length) {\n      this.cachedClonedPageDOM.forEach(function (el) {\n        removeChild(slideContent, el);\n      });\n    }\n\n    this.cachedClonedPageDOM = [];\n  };\n\n  Slide.prototype.modifyCurrentPage = function (point) {\n    var _a = this.getCurrentPage(),\n        prevExposedPageX = _a.pageX,\n        prevExposedPageY = _a.pageY;\n\n    var newPage = this.nearestPage(point.x, point.y);\n    this.setCurrentPage(newPage);\n    /* istanbul ignore if */\n\n    if (this.contentChanged) {\n      this.contentChanged = false;\n      return true;\n    }\n\n    var _b = this.getCurrentPage(),\n        currentExposedPageX = _b.pageX,\n        currentExposedPageY = _b.pageY;\n\n    this.pageWillChangeTo(newPage); // loop is true, and one page becomes many pages when call bs.refresh\n\n    if (this.oneToMorePagesInLoop) {\n      this.oneToMorePagesInLoop = false;\n      return true;\n    } // loop is true, and many page becomes one page when call bs.refresh\n    // if prevPage > 0, dispatch slidePageChanged and scrollEnd events\n\n    /* istanbul ignore if */\n\n\n    if (this.moreToOnePageInLoop && prevExposedPageX === 0 && prevExposedPageY === 0) {\n      this.moreToOnePageInLoop = false;\n      return true;\n    }\n\n    if (prevExposedPageX !== currentExposedPageX || prevExposedPageY !== currentExposedPageY) {\n      // only trust pageX & pageY when loop is true\n      var page = this.pages.getExposedPageByPageIndex(currentExposedPageX, currentExposedPageY);\n      this.scroll.trigger(this.scroll.eventTypes.slidePageChanged, page);\n    } // triggered by resetLoop\n\n\n    if (this.resetLooping) {\n      this.resetLooping = false;\n      return;\n    }\n\n    var changePage = this.pages.resetLoopPage();\n\n    if (changePage) {\n      this.resetLooping = true;\n      this.goTo(changePage.pageX, changePage.pageY, 0); // stop user's scrollEnd\n      // since it is a seamless scroll\n\n      return true;\n    }\n  };\n\n  Slide.prototype.goTo = function (pageX, pageY, time, easing) {\n    var newPage = this.pages.getInternalPage(pageX, pageY);\n    var scrollEasing = easing || this.options.easing || ease.bounce;\n    var x = newPage.x,\n        y = newPage.y;\n    var deltaX = x - this.scroll.scroller.scrollBehaviorX.currentPos;\n    var deltaY = y - this.scroll.scroller.scrollBehaviorY.currentPos;\n    /* istanbul ignore if */\n\n    if (!deltaX && !deltaY) {\n      this.scroll.scroller.togglePointerEvents(true);\n      return;\n    }\n\n    time = time === undefined ? this.getEaseTime(deltaX, deltaY) : time;\n    this.scroll.scroller.scrollTo(x, y, time, scrollEasing);\n  };\n\n  Slide.prototype.flickHandler = function () {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var currentPosX = scrollBehaviorX.currentPos,\n        startPosX = scrollBehaviorX.startPos,\n        directionX = scrollBehaviorX.direction;\n    var currentPosY = scrollBehaviorY.currentPos,\n        startPosY = scrollBehaviorY.startPos,\n        directionY = scrollBehaviorY.direction;\n    var _b = this.pages.currentPage,\n        pageX = _b.pageX,\n        pageY = _b.pageY;\n    var time = this.getEaseTime(currentPosX - startPosX, currentPosY - startPosY);\n    this.goTo(pageX + directionX, pageY + directionY, time);\n  };\n\n  Slide.prototype.getEaseTime = function (deltaX, deltaY) {\n    return this.options.speed || Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300);\n  };\n\n  Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY,\n        animater = _a.animater;\n    var newX = scrollMeta.newX;\n    var newY = scrollMeta.newY;\n    var newPage = this.satisfyThreshold(newX, newY) || animater.forceStopped ? this.pages.getPageByDirection(this.nearestPage(newX, newY), scrollBehaviorX.direction, scrollBehaviorY.direction) : this.pages.currentPage;\n    scrollMeta.time = this.getEaseTime(scrollMeta.newX - newPage.x, scrollMeta.newY - newPage.y);\n    scrollMeta.newX = newPage.x;\n    scrollMeta.newY = newPage.y;\n    scrollMeta.easing = this.options.easing || ease.bounce;\n  };\n\n  Slide.prototype.scrollHandler = function (_a) {\n    var x = _a.x,\n        y = _a.y;\n\n    if (this.satisfyThreshold(x, y)) {\n      var newPage = this.nearestPage(x, y);\n      this.pageWillChangeTo(newPage);\n    }\n  };\n\n  Slide.prototype.pageWillChangeTo = function (newPage) {\n    var changeToPage = this.pages.getWillChangedPage(newPage);\n\n    if (!samePage(this.willChangeToPage, changeToPage)) {\n      this.willChangeToPage = changeToPage;\n      this.scroll.trigger(this.scroll.eventTypes.slideWillChange, this.willChangeToPage);\n    }\n  };\n\n  Slide.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Slide.prototype.destroy = function () {\n    var slideContent = this.scroll.scroller.content;\n    var _a = this.options,\n        loop = _a.loop,\n        autoplay = _a.autoplay;\n\n    if (loop) {\n      this.removeClonedSlidePage(slideContent);\n    }\n\n    if (autoplay) {\n      clearTimeout(this.autoplayTimer);\n    }\n\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n\n      if (hooks.eventTypes[hooksName]) {\n        hooks.off(hooksName, handlerFn);\n      }\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Slide.pluginName = 'slide';\n  return Slide;\n}();\n\nvar sourcePrefix$3 = 'plugins.wheel';\nvar propertiesMap$3 = [{\n  key: 'wheelTo',\n  name: 'wheelTo'\n}, {\n  key: 'getSelectedIndex',\n  name: 'getSelectedIndex'\n}, {\n  key: 'restorePosition',\n  name: 'restorePosition'\n}];\nvar propertiesConfig$3 = propertiesMap$3.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$3 + \".\" + item.name\n  };\n});\nvar WHEEL_INDEX_CHANGED_EVENT_NAME = 'wheelIndexChanged';\nvar CONSTANTS = {\n  rate: 4\n};\n\nvar Wheel =\n/** @class */\nfunction () {\n  function Wheel(scroll) {\n    this.scroll = scroll;\n    this.init();\n  }\n\n  Wheel.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks(); // init boundary for Wheel\n\n    this.refreshBoundary();\n    this.setSelectedIndex(this.options.selectedIndex);\n  };\n\n  Wheel.prototype.handleBScroll = function () {\n    this.scroll.proxy(propertiesConfig$3);\n    this.scroll.registerType([WHEEL_INDEX_CHANGED_EVENT_NAME]);\n  };\n\n  Wheel.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.wheel === true ? {} : this.scroll.options.wheel;\n    var defaultOptions = {\n      wheelWrapperClass: 'wheel-scroll',\n      wheelItemClass: 'wheel-item',\n      rotate: 25,\n      adjustTime: 400,\n      selectedIndex: 0,\n      wheelDisabledItemClass: 'wheel-disabled-item'\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  Wheel.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    var scroller = this.scroll.scroller;\n    var actionsHandler = scroller.actionsHandler,\n        scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY,\n        animater = scroller.animater;\n    var prevContent = scroller.content; // BScroll\n\n    scroll.on(scroll.eventTypes.scrollEnd, function (position) {\n      var index = _this.findNearestValidWheel(position.y).index;\n\n      if (scroller.animater.forceStopped && !_this.isAdjustingPosition) {\n        _this.target = _this.items[index]; // since stopped from an animation.\n        // prevent user's scrollEnd callback triggered twice\n\n        return true;\n      } else {\n        _this.setSelectedIndex(index);\n\n        if (_this.isAdjustingPosition) {\n          _this.isAdjustingPosition = false;\n        }\n      }\n    }); // BScroll.hooks\n\n    this.scroll.hooks.on(this.scroll.hooks.eventTypes.refresh, function (content) {\n      if (content !== prevContent) {\n        prevContent = content;\n\n        _this.setSelectedIndex(_this.options.selectedIndex, true);\n      } // rotate all wheel-items\n      // because position may not change\n\n\n      _this.rotateX(_this.scroll.y); // check we are stop at a disable item or not\n\n\n      _this.wheelTo(_this.selectedIndex, 0);\n    });\n    this.scroll.hooks.on(this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\n      // selectedIndex has higher priority than bs.options.startY\n      position.x = 0;\n      position.y = -(_this.selectedIndex * _this.itemHeight);\n    }); // Scroller\n\n    scroller.hooks.on(scroller.hooks.eventTypes.checkClick, function () {\n      var index = HTMLCollectionToArray(_this.items).indexOf(_this.target);\n      if (index === -1) return true;\n\n      _this.wheelTo(index, _this.options.adjustTime, ease.swipe);\n\n      return true;\n    });\n    scroller.hooks.on(scroller.hooks.eventTypes.scrollTo, function (endPoint) {\n      endPoint.y = _this.findNearestValidWheel(endPoint.y).y;\n    }); // when content is scrolling\n    // click wheel-item DOM repeatedly and crazily will cause scrollEnd not triggered\n    // so reset forceStopped\n\n    scroller.hooks.on(scroller.hooks.eventTypes.minDistanceScroll, function () {\n      var animater = scroller.animater;\n\n      if (animater.forceStopped === true) {\n        animater.forceStopped = false;\n      }\n    });\n    scroller.hooks.on(scroller.hooks.eventTypes.scrollToElement, function (el, pos) {\n      if (!hasClass(el, _this.options.wheelItemClass)) {\n        return true;\n      } else {\n        pos.top = _this.findNearestValidWheel(pos.top).y;\n      }\n    }); // ActionsHandler\n\n    actionsHandler.hooks.on(actionsHandler.hooks.eventTypes.beforeStart, function (e) {\n      _this.target = e.target;\n    }); // ScrollBehaviorX\n    // Wheel has no x direction now\n\n    scrollBehaviorX.hooks.on(scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\n      boundary.maxScrollPos = 0;\n      boundary.minScrollPos = 0;\n    }); // ScrollBehaviorY\n\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      _this.items = _this.scroll.scroller.content.children;\n\n      _this.checkWheelAllDisabled();\n\n      _this.itemHeight = _this.items.length > 0 ? scrollBehaviorY.contentSize / _this.items.length : 0;\n      boundary.maxScrollPos = -_this.itemHeight * (_this.items.length - 1);\n      boundary.minScrollPos = 0;\n    });\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.momentum, function (momentumInfo) {\n      momentumInfo.rate = CONSTANTS.rate;\n      momentumInfo.destination = _this.findNearestValidWheel(momentumInfo.destination).y;\n    });\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.end, function (momentumInfo) {\n      var validWheel = _this.findNearestValidWheel(scrollBehaviorY.currentPos);\n\n      momentumInfo.destination = validWheel.y;\n      momentumInfo.duration = _this.options.adjustTime;\n    }); // Animater\n\n    animater.hooks.on(animater.hooks.eventTypes.time, function (time) {\n      _this.transitionDuration(time);\n    });\n    animater.hooks.on(animater.hooks.eventTypes.timeFunction, function (easing) {\n      _this.timeFunction(easing);\n    }); // bs.stop() to make wheel stop at a correct position when pending\n\n    animater.hooks.on(animater.hooks.eventTypes.callStop, function () {\n      var index = _this.findNearestValidWheel(_this.scroll.y).index;\n\n      _this.isAdjustingPosition = true;\n\n      _this.wheelTo(index, 0);\n    }); // Translater\n\n    animater.translater.hooks.on(animater.translater.hooks.eventTypes.translate, function (endPoint) {\n      _this.rotateX(endPoint.y);\n    });\n  };\n\n  Wheel.prototype.refreshBoundary = function () {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY,\n        content = _a.content;\n    scrollBehaviorX.refresh(content);\n    scrollBehaviorY.refresh(content);\n  };\n\n  Wheel.prototype.setSelectedIndex = function (index, contentChanged) {\n    if (contentChanged === void 0) {\n      contentChanged = false;\n    }\n\n    var prevSelectedIndex = this.selectedIndex;\n    this.selectedIndex = index; // if content DOM changed, should not trigger event\n\n    if (prevSelectedIndex !== index && !contentChanged) {\n      this.scroll.trigger(WHEEL_INDEX_CHANGED_EVENT_NAME, index);\n    }\n  };\n\n  Wheel.prototype.getSelectedIndex = function () {\n    return this.selectedIndex;\n  };\n\n  Wheel.prototype.wheelTo = function (index, time, ease) {\n    if (index === void 0) {\n      index = 0;\n    }\n\n    if (time === void 0) {\n      time = 0;\n    }\n\n    var y = -index * this.itemHeight;\n    this.scroll.scrollTo(0, y, time, ease);\n  };\n\n  Wheel.prototype.restorePosition = function () {\n    // bs is scrolling\n    var isPending = this.scroll.pending;\n\n    if (isPending) {\n      var selectedIndex = this.getSelectedIndex();\n      this.scroll.scroller.animater.clearTimer();\n      this.wheelTo(selectedIndex, 0);\n    }\n  };\n\n  Wheel.prototype.transitionDuration = function (time) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].style[style.transitionDuration] = time + 'ms';\n    }\n  };\n\n  Wheel.prototype.timeFunction = function (easing) {\n    for (var i = 0; i < this.items.length; i++) {\n      this.items[i].style[style.transitionTimingFunction] = easing;\n    }\n  };\n\n  Wheel.prototype.rotateX = function (y) {\n    var _a = this.options.rotate,\n        rotate = _a === void 0 ? 25 : _a;\n\n    for (var i = 0; i < this.items.length; i++) {\n      var deg = rotate * (y / this.itemHeight + i); // Too small value is invalid in some phones, issue 1026\n\n      var SafeDeg = deg.toFixed(3);\n      this.items[i].style[style.transform] = \"rotateX(\" + SafeDeg + \"deg)\";\n    }\n  };\n\n  Wheel.prototype.findNearestValidWheel = function (y) {\n    y = y > 0 ? 0 : y < this.scroll.maxScrollY ? this.scroll.maxScrollY : y;\n    var currentIndex = Math.abs(Math.round(-y / this.itemHeight));\n    var cacheIndex = currentIndex;\n    var items = this.items;\n    var wheelDisabledItemClassName = this.options.wheelDisabledItemClass; // implement web native select element\n    // first, check whether there is a enable item whose index is smaller than currentIndex\n    // then, check whether there is a enable item whose index is bigger than currentIndex\n    // otherwise, there are all disabled items, just keep currentIndex unchange\n\n    while (currentIndex >= 0) {\n      if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\n        break;\n      }\n\n      currentIndex--;\n    }\n\n    if (currentIndex < 0) {\n      currentIndex = cacheIndex;\n\n      while (currentIndex <= items.length - 1) {\n        if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\n          break;\n        }\n\n        currentIndex++;\n      }\n    } // keep it unchange when all the items are disabled\n\n\n    if (currentIndex === items.length) {\n      currentIndex = cacheIndex;\n    } // when all the items are disabled, selectedIndex should always be -1\n\n\n    return {\n      index: this.wheelItemsAllDisabled ? -1 : currentIndex,\n      y: -currentIndex * this.itemHeight\n    };\n  };\n\n  Wheel.prototype.checkWheelAllDisabled = function () {\n    var wheelDisabledItemClassName = this.options.wheelDisabledItemClass;\n    var items = this.items;\n    this.wheelItemsAllDisabled = true;\n\n    for (var i = 0; i < items.length; i++) {\n      if (!hasClass(items[i], wheelDisabledItemClassName)) {\n        this.wheelItemsAllDisabled = false;\n        break;\n      }\n    }\n  };\n\n  Wheel.pluginName = 'wheel';\n  return Wheel;\n}();\n\nvar sourcePrefix$2 = 'plugins.zoom';\nvar propertiesMap$2 = [{\n  key: 'zoomTo',\n  name: 'zoomTo'\n}];\nvar propertiesConfig$2 = propertiesMap$2.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$2 + \".\" + item.name\n  };\n});\nvar TWO_FINGERS = 2;\nvar RAW_SCALE = 1;\n\nvar Zoom =\n/** @class */\nfunction () {\n  function Zoom(scroll) {\n    this.scroll = scroll;\n    this.scale = RAW_SCALE;\n    this.prevScale = 1;\n    this.init();\n  }\n\n  Zoom.prototype.init = function () {\n    this.handleBScroll();\n    this.handleOptions();\n    this.handleHooks();\n    this.tryInitialZoomTo(this.zoomOpt);\n  };\n\n  Zoom.prototype.zoomTo = function (scale, x, y, bounceTime) {\n    var _a = this.resolveOrigin(x, y),\n        originX = _a.originX,\n        originY = _a.originY;\n\n    var origin = {\n      x: originX,\n      y: originY,\n      baseScale: this.scale\n    };\n\n    this._doZoomTo(scale, origin, bounceTime, true);\n  };\n\n  Zoom.prototype.handleBScroll = function () {\n    this.scroll.proxy(propertiesConfig$2);\n    this.scroll.registerType(['beforeZoomStart', 'zoomStart', 'zooming', 'zoomEnd']);\n  };\n\n  Zoom.prototype.handleOptions = function () {\n    var userOptions = this.scroll.options.zoom === true ? {} : this.scroll.options.zoom;\n    var defaultOptions = {\n      start: 1,\n      min: 1,\n      max: 4,\n      initialOrigin: [0, 0],\n      minimalZoomDistance: 5,\n      bounceTime: 800\n    };\n    this.zoomOpt = extend(defaultOptions, userOptions);\n  };\n\n  Zoom.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    var scroller = this.scroll.scroller;\n    this.wrapper = this.scroll.scroller.wrapper;\n    this.setTransformOrigin(this.scroll.scroller.content);\n    var scrollBehaviorX = scroller.scrollBehaviorX;\n    var scrollBehaviorY = scroller.scrollBehaviorY;\n    this.hooksFn = []; // BScroll\n\n    this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.contentChanged, function (content) {\n      _this.setTransformOrigin(content);\n\n      _this.scale = RAW_SCALE;\n\n      _this.tryInitialZoomTo(_this.zoomOpt);\n    });\n    this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.beforeInitialScrollTo, function () {\n      // if perform a zoom action, we should prevent initial scroll when initialised\n      if (_this.zoomOpt.start !== RAW_SCALE) {\n        return true;\n      }\n    }); // enlarge boundary\n\n    this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.beforeComputeBoundary, function () {\n      // content may change, don't cache it's size\n      var contentSize = getRect(_this.scroll.scroller.content);\n      scrollBehaviorX.contentSize = Math.floor(contentSize.width * _this.scale);\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.beforeComputeBoundary, function () {\n      // content may change, don't cache it's size\n      var contentSize = getRect(_this.scroll.scroller.content);\n      scrollBehaviorY.contentSize = Math.floor(contentSize.height * _this.scale);\n    }); // touch event\n\n    this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.start, function (e) {\n      var numberOfFingers = e.touches && e.touches.length || 0;\n\n      _this.fingersOperation(numberOfFingers);\n\n      if (numberOfFingers === TWO_FINGERS) {\n        _this.zoomStart(e);\n      }\n    });\n    this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeMove, function (e) {\n      var numberOfFingers = e.touches && e.touches.length || 0;\n\n      _this.fingersOperation(numberOfFingers);\n\n      if (numberOfFingers === TWO_FINGERS) {\n        _this.zoom(e);\n\n        return true;\n      }\n    });\n    this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeEnd, function (e) {\n      var numberOfFingers = _this.fingersOperation();\n\n      if (numberOfFingers === TWO_FINGERS) {\n        _this.zoomEnd();\n\n        return true;\n      }\n    });\n    this.registerHooks(scroller.translater.hooks, scroller.translater.hooks.eventTypes.beforeTranslate, function (transformStyle, point) {\n      var scale = point.scale ? point.scale : _this.prevScale;\n      _this.prevScale = scale;\n      transformStyle.push(\"scale(\" + scale + \")\");\n    });\n    this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.scrollEnd, function () {\n      if (_this.fingersOperation() === TWO_FINGERS) {\n        _this.scroll.trigger(_this.scroll.eventTypes.zoomEnd, {\n          scale: _this.scale\n        });\n      }\n    });\n    this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\n  };\n\n  Zoom.prototype.setTransformOrigin = function (content) {\n    content.style[style.transformOrigin] = '0 0';\n  };\n\n  Zoom.prototype.tryInitialZoomTo = function (options) {\n    var start = options.start,\n        initialOrigin = options.initialOrigin;\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n\n    if (start !== RAW_SCALE) {\n      // Movable plugin may wanna modify minScrollPos or maxScrollPos\n      // so we force Movable to caculate them\n      this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\n      this.zoomTo(start, initialOrigin[0], initialOrigin[1], 0);\n    }\n  }; // getter or setter operation\n\n\n  Zoom.prototype.fingersOperation = function (amounts) {\n    if (typeof amounts === 'number') {\n      this.numberOfFingers = amounts;\n    } else {\n      return this.numberOfFingers;\n    }\n  };\n\n  Zoom.prototype._doZoomTo = function (scale, origin, time, useCurrentPos) {\n    var _this = this;\n\n    if (time === void 0) {\n      time = this.zoomOpt.bounceTime;\n    }\n\n    if (useCurrentPos === void 0) {\n      useCurrentPos = false;\n    }\n\n    var _a = this.zoomOpt,\n        min = _a.min,\n        max = _a.max;\n    var fromScale = this.scale;\n    var toScale = between(scale, min, max);\n\n    (function () {\n      if (time === 0) {\n        _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\n          scale: toScale\n        });\n\n        return;\n      }\n\n      if (time > 0) {\n        var timer_1;\n        var startTime_1 = getNow();\n        var endTime_1 = startTime_1 + time;\n\n        var scheduler_1 = function scheduler_1() {\n          var now = getNow();\n\n          if (now >= endTime_1) {\n            _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\n              scale: toScale\n            });\n\n            cancelAnimationFrame(timer_1);\n            return;\n          }\n\n          var ratio = ease.bounce.fn((now - startTime_1) / time);\n          var currentScale = ratio * (toScale - fromScale) + fromScale;\n\n          _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\n            scale: currentScale\n          });\n\n          timer_1 = requestAnimationFrame(scheduler_1);\n        }; // start scheduler job\n\n\n        scheduler_1();\n      }\n    })(); // suppose you are zooming by two fingers\n\n\n    this.fingersOperation(2);\n\n    this._zoomTo(toScale, fromScale, origin, time, useCurrentPos);\n  };\n\n  Zoom.prototype._zoomTo = function (toScale, fromScale, origin, time, useCurrentPos) {\n    if (useCurrentPos === void 0) {\n      useCurrentPos = false;\n    }\n\n    var ratio = toScale / origin.baseScale;\n    this.setScale(toScale);\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]); // position is restrained in boundary\n\n    var newX = this.getNewPos(origin.x, ratio, scrollBehaviorX, true, useCurrentPos);\n    var newY = this.getNewPos(origin.y, ratio, scrollBehaviorY, true, useCurrentPos);\n\n    if (scrollBehaviorX.currentPos !== Math.round(newX) || scrollBehaviorY.currentPos !== Math.round(newY) || toScale !== fromScale) {\n      scroller.scrollTo(newX, newY, time, ease.bounce, {\n        start: {\n          scale: fromScale\n        },\n        end: {\n          scale: toScale\n        }\n      });\n    }\n  };\n\n  Zoom.prototype.resolveOrigin = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var resolveFormula = {\n      left: function left() {\n        return 0;\n      },\n      top: function top() {\n        return 0;\n      },\n      right: function right() {\n        return scrollBehaviorX.contentSize;\n      },\n      bottom: function bottom() {\n        return scrollBehaviorY.contentSize;\n      },\n      center: function center(index) {\n        var baseSize = index === 0 ? scrollBehaviorX.contentSize : scrollBehaviorY.contentSize;\n        return baseSize / 2;\n      }\n    };\n    return {\n      originX: typeof x === 'number' ? x : resolveFormula[x](0),\n      originY: typeof y === 'number' ? y : resolveFormula[y](1)\n    };\n  };\n\n  Zoom.prototype.zoomStart = function (e) {\n    var firstFinger = e.touches[0];\n    var secondFinger = e.touches[1];\n    this.startDistance = this.getFingerDistance(e);\n    this.startScale = this.scale;\n\n    var _a = offsetToBody(this.wrapper),\n        left = _a.left,\n        top = _a.top;\n\n    this.origin = {\n      x: Math.abs(firstFinger.pageX + secondFinger.pageX) / 2 + left - this.scroll.x,\n      y: Math.abs(firstFinger.pageY + secondFinger.pageY) / 2 + top - this.scroll.y,\n      baseScale: this.startScale\n    };\n    this.scroll.trigger(this.scroll.eventTypes.beforeZoomStart);\n  };\n\n  Zoom.prototype.zoom = function (e) {\n    var currentDistance = this.getFingerDistance(e); // at least minimalZoomDistance pixels for the zoom to initiate\n\n    if (!this.zoomed && Math.abs(currentDistance - this.startDistance) < this.zoomOpt.minimalZoomDistance) {\n      return;\n    } // when out of boundary , perform a damping algorithm\n\n\n    var endScale = this.dampingScale(currentDistance / this.startDistance * this.startScale);\n    var ratio = endScale / this.startScale;\n    this.setScale(endScale);\n\n    if (!this.zoomed) {\n      this.zoomed = true;\n      this.scroll.trigger(this.scroll.eventTypes.zoomStart);\n    }\n\n    var scroller = this.scroll.scroller;\n    var scrollBehaviorX = scroller.scrollBehaviorX,\n        scrollBehaviorY = scroller.scrollBehaviorY;\n    var x = this.getNewPos(this.origin.x, ratio, scrollBehaviorX, false, false);\n    var y = this.getNewPos(this.origin.y, ratio, scrollBehaviorY, false, false);\n    this.scroll.trigger(this.scroll.eventTypes.zooming, {\n      scale: this.scale\n    });\n    scroller.translater.translate({\n      x: x,\n      y: y,\n      scale: endScale\n    });\n  };\n\n  Zoom.prototype.zoomEnd = function () {\n    if (!this.zoomed) return; // if out of boundary, do rebound!\n\n    if (this.shouldRebound()) {\n      this._doZoomTo(this.scale, this.origin, this.zoomOpt.bounceTime);\n\n      return;\n    }\n\n    this.scroll.trigger(this.scroll.eventTypes.zoomEnd, {\n      scale: this.scale\n    });\n  };\n\n  Zoom.prototype.getFingerDistance = function (e) {\n    var firstFinger = e.touches[0];\n    var secondFinger = e.touches[1];\n    var deltaX = Math.abs(firstFinger.pageX - secondFinger.pageX);\n    var deltaY = Math.abs(firstFinger.pageY - secondFinger.pageY);\n    return getDistance(deltaX, deltaY);\n  };\n\n  Zoom.prototype.shouldRebound = function () {\n    var _a = this.zoomOpt,\n        min = _a.min,\n        max = _a.max;\n    var currentScale = this.scale; // scale exceeded!\n\n    if (currentScale !== between(currentScale, min, max)) {\n      return true;\n    }\n\n    var _b = this.scroll.scroller,\n        scrollBehaviorX = _b.scrollBehaviorX,\n        scrollBehaviorY = _b.scrollBehaviorY; // enlarge boundaries manually when zoom is end\n\n    this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\n    var xInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\n    var yInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\n    return !(xInBoundary && yInBoundary);\n  };\n\n  Zoom.prototype.dampingScale = function (scale) {\n    var _a = this.zoomOpt,\n        min = _a.min,\n        max = _a.max;\n\n    if (scale < min) {\n      scale = 0.5 * min * Math.pow(2.0, scale / min);\n    } else if (scale > max) {\n      scale = 2.0 * max * Math.pow(0.5, max / scale);\n    }\n\n    return scale;\n  };\n\n  Zoom.prototype.setScale = function (scale) {\n    this.scale = scale;\n  };\n\n  Zoom.prototype.resetBoundaries = function (scrollBehaviorPairs) {\n    scrollBehaviorPairs.forEach(function (behavior) {\n      return behavior.computeBoundary();\n    });\n  };\n\n  Zoom.prototype.getNewPos = function (origin, lastScale, scrollBehavior, shouldInBoundary, useCurrentPos) {\n    if (useCurrentPos === void 0) {\n      useCurrentPos = false;\n    }\n\n    var newPos = origin - origin * lastScale + (useCurrentPos ? scrollBehavior.currentPos : scrollBehavior.startPos);\n\n    if (shouldInBoundary) {\n      newPos = between(newPos, scrollBehavior.maxScrollPos, scrollBehavior.minScrollPos);\n    } // maxScrollPos or minScrollPos maybe a negative or positive digital\n\n\n    return newPos > 0 ? Math.floor(newPos) : Math.ceil(newPos);\n  };\n\n  Zoom.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Zoom.prototype.destroy = function () {\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Zoom.pluginName = 'zoom';\n  return Zoom;\n}();\n\nvar BScrollFamily =\n/** @class */\nfunction () {\n  function BScrollFamily(scroll) {\n    this.ancestors = [];\n    this.descendants = [];\n    this.hooksManager = [];\n    this.analyzed = false;\n    this.selfScroll = scroll;\n  }\n\n  BScrollFamily.create = function (scroll) {\n    return new BScrollFamily(scroll);\n  };\n\n  BScrollFamily.prototype.hasAncestors = function (bscrollFamily) {\n    var index = findIndex(this.ancestors, function (_a) {\n      var item = _a[0];\n      return item === bscrollFamily;\n    });\n    return index > -1;\n  };\n\n  BScrollFamily.prototype.hasDescendants = function (bscrollFamily) {\n    var index = findIndex(this.descendants, function (_a) {\n      var item = _a[0];\n      return item === bscrollFamily;\n    });\n    return index > -1;\n  };\n\n  BScrollFamily.prototype.addAncestor = function (bscrollFamily, distance) {\n    var ancestors = this.ancestors;\n    ancestors.push([bscrollFamily, distance]); // by ascend\n\n    ancestors.sort(function (a, b) {\n      return a[1] - b[1];\n    });\n  };\n\n  BScrollFamily.prototype.addDescendant = function (bscrollFamily, distance) {\n    var descendants = this.descendants;\n    descendants.push([bscrollFamily, distance]); // by ascend\n\n    descendants.sort(function (a, b) {\n      return a[1] - b[1];\n    });\n  };\n\n  BScrollFamily.prototype.removeAncestor = function (bscrollFamily) {\n    var ancestors = this.ancestors;\n\n    if (ancestors.length) {\n      var index = findIndex(this.ancestors, function (_a) {\n        var item = _a[0];\n        return item === bscrollFamily;\n      });\n\n      if (index > -1) {\n        return ancestors.splice(index, 1);\n      }\n    }\n  };\n\n  BScrollFamily.prototype.removeDescendant = function (bscrollFamily) {\n    var descendants = this.descendants;\n\n    if (descendants.length) {\n      var index = findIndex(this.descendants, function (_a) {\n        var item = _a[0];\n        return item === bscrollFamily;\n      });\n\n      if (index > -1) {\n        return descendants.splice(index, 1);\n      }\n    }\n  };\n\n  BScrollFamily.prototype.registerHooks = function (hook, eventType, handler) {\n    hook.on(eventType, handler);\n    this.hooksManager.push([hook, eventType, handler]);\n  };\n\n  BScrollFamily.prototype.setAnalyzed = function (flag) {\n    if (flag === void 0) {\n      flag = false;\n    }\n\n    this.analyzed = flag;\n  };\n\n  BScrollFamily.prototype.purge = function () {\n    var _this = this; // remove self from graph\n\n\n    this.ancestors.forEach(function (_a) {\n      var bscrollFamily = _a[0];\n      bscrollFamily.removeDescendant(_this);\n    });\n    this.descendants.forEach(function (_a) {\n      var bscrollFamily = _a[0];\n      bscrollFamily.removeAncestor(_this);\n    }); // remove all hook handlers\n\n    this.hooksManager.forEach(function (_a) {\n      var hooks = _a[0],\n          eventType = _a[1],\n          handler = _a[2];\n      hooks.off(eventType, handler);\n    });\n    this.hooksManager = [];\n  };\n\n  return BScrollFamily;\n}();\n\nvar sourcePrefix$1 = 'plugins.nestedScroll';\nvar propertiesMap$1 = [{\n  key: 'purgeNestedScroll',\n  name: 'purgeNestedScroll'\n}];\nvar propertiesConfig$1 = propertiesMap$1.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix$1 + \".\" + item.name\n  };\n});\nvar DEFAUL_GROUP_ID = 'INTERNAL_NESTED_SCROLL';\n\nvar forceScrollStopHandler = function forceScrollStopHandler(scrolls) {\n  scrolls.forEach(function (scroll) {\n    if (scroll.pending) {\n      scroll.stop();\n      scroll.resetPosition();\n    }\n  });\n};\n\nvar enableScrollHander = function enableScrollHander(scrolls) {\n  scrolls.forEach(function (scroll) {\n    scroll.enable();\n  });\n};\n\nvar disableScrollHander = function disableScrollHander(scrolls, currentScroll) {\n  scrolls.forEach(function (scroll) {\n    if (scroll.hasHorizontalScroll === currentScroll.hasHorizontalScroll || scroll.hasVerticalScroll === currentScroll.hasVerticalScroll) {\n      scroll.disable();\n    }\n  });\n};\n\nvar syncTouchstartData = function syncTouchstartData(scrolls) {\n  scrolls.forEach(function (scroll) {\n    var _a = scroll.scroller,\n        actions = _a.actions,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY; // prevent click triggering many times\n\n    actions.fingerMoved = true;\n    actions.contentMoved = false;\n    actions.directionLockAction.reset();\n    scrollBehaviorX.start();\n    scrollBehaviorY.start();\n    scrollBehaviorX.resetStartPos();\n    scrollBehaviorY.resetStartPos();\n    actions.startTime = +new Date();\n  });\n};\n\nvar isOutOfBoundary = function isOutOfBoundary(scroll) {\n  var hasHorizontalScroll = scroll.hasHorizontalScroll,\n      hasVerticalScroll = scroll.hasVerticalScroll,\n      x = scroll.x,\n      y = scroll.y,\n      minScrollX = scroll.minScrollX,\n      maxScrollX = scroll.maxScrollX,\n      minScrollY = scroll.minScrollY,\n      maxScrollY = scroll.maxScrollY,\n      movingDirectionX = scroll.movingDirectionX,\n      movingDirectionY = scroll.movingDirectionY;\n  var ret = false;\n  var outOfLeftBoundary = x >= minScrollX && movingDirectionX === -1\n  /* Negative */\n  ;\n  var outOfRightBoundary = x <= maxScrollX && movingDirectionX === 1\n  /* Positive */\n  ;\n  var outOfTopBoundary = y >= minScrollY && movingDirectionY === -1\n  /* Negative */\n  ;\n  var outOfBottomBoundary = y <= maxScrollY && movingDirectionY === 1\n  /* Positive */\n  ;\n\n  if (hasVerticalScroll) {\n    ret = outOfTopBoundary || outOfBottomBoundary;\n  } else if (hasHorizontalScroll) {\n    ret = outOfLeftBoundary || outOfRightBoundary;\n  }\n\n  return ret;\n};\n\nvar isResettingPosition = function isResettingPosition(scroll) {\n  var hasHorizontalScroll = scroll.hasHorizontalScroll,\n      hasVerticalScroll = scroll.hasVerticalScroll,\n      x = scroll.x,\n      y = scroll.y,\n      minScrollX = scroll.minScrollX,\n      maxScrollX = scroll.maxScrollX,\n      minScrollY = scroll.minScrollY,\n      maxScrollY = scroll.maxScrollY;\n  var ret = false;\n  var outOfLeftBoundary = x > minScrollX;\n  var outOfRightBoundary = x < maxScrollX;\n  var outOfTopBoundary = y > minScrollY;\n  var outOfBottomBoundary = y < maxScrollY;\n\n  if (hasVerticalScroll) {\n    ret = outOfTopBoundary || outOfBottomBoundary;\n  } else if (hasHorizontalScroll) {\n    ret = outOfLeftBoundary || outOfRightBoundary;\n  }\n\n  return ret;\n};\n\nvar resetPositionHandler = function resetPositionHandler(scroll) {\n  scroll.scroller.reflow();\n  scroll.resetPosition(0\n  /* Immediately */\n  );\n};\n\nvar calculateDistance = function calculateDistance(childNode, parentNode) {\n  var distance = 0;\n  var parent = childNode.parentNode;\n\n  while (parent && parent !== parentNode) {\n    distance++;\n    parent = parent.parentNode;\n  }\n\n  return distance;\n};\n\nvar NestedScroll =\n/** @class */\nfunction () {\n  function NestedScroll(scroll) {\n    var groupId = this.handleOptions(scroll);\n    var instance = NestedScroll.instancesMap[groupId];\n\n    if (!instance) {\n      instance = NestedScroll.instancesMap[groupId] = this;\n      instance.store = [];\n      instance.hooksFn = [];\n    }\n\n    instance.init(scroll);\n    return instance;\n  }\n\n  NestedScroll.getAllNestedScrolls = function () {\n    var instancesMap = NestedScroll.instancesMap;\n    return Object.keys(instancesMap).map(function (key) {\n      return instancesMap[key];\n    });\n  };\n\n  NestedScroll.purgeAllNestedScrolls = function () {\n    var nestedScrolls = NestedScroll.getAllNestedScrolls();\n    nestedScrolls.forEach(function (ns) {\n      return ns.purgeNestedScroll();\n    });\n  };\n\n  NestedScroll.prototype.handleOptions = function (scroll) {\n    var userOptions = scroll.options.nestedScroll === true ? {} : scroll.options.nestedScroll;\n    var defaultOptions = {\n      groupId: DEFAUL_GROUP_ID\n    };\n    this.options = extend(defaultOptions, userOptions);\n\n    var groupIdType = _typeof(this.options.groupId);\n\n    if (groupIdType !== 'string' && groupIdType !== 'number') {\n      warn('groupId must be string or number for NestedScroll plugin');\n    }\n\n    return this.options.groupId;\n  };\n\n  NestedScroll.prototype.init = function (scroll) {\n    scroll.proxy(propertiesConfig$1);\n    this.addBScroll(scroll);\n    this.buildBScrollGraph();\n    this.analyzeBScrollGraph();\n    this.ensureEventInvokeSequence();\n    this.handleHooks(scroll);\n  };\n\n  NestedScroll.prototype.handleHooks = function (scroll) {\n    var _this = this;\n\n    this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.destroy, function () {\n      _this.deleteScroll(scroll);\n    });\n  };\n\n  NestedScroll.prototype.deleteScroll = function (scroll) {\n    var wrapper = scroll.wrapper;\n    wrapper.isBScrollContainer = undefined;\n    var store = this.store;\n    var hooksFn = this.hooksFn;\n    var i = findIndex(store, function (bscrollFamily) {\n      return bscrollFamily.selfScroll === scroll;\n    });\n\n    if (i > -1) {\n      var bscrollFamily = store[i];\n      bscrollFamily.purge();\n      store.splice(i, 1);\n    }\n\n    var k = findIndex(hooksFn, function (_a) {\n      var hooks = _a[0];\n      return hooks === scroll.hooks;\n    });\n\n    if (k > -1) {\n      var _a = hooksFn[k],\n          hooks = _a[0],\n          eventType = _a[1],\n          handler = _a[2];\n      hooks.off(eventType, handler);\n      hooksFn.splice(k, 1);\n    }\n  };\n\n  NestedScroll.prototype.addBScroll = function (scroll) {\n    this.store.push(BScrollFamily.create(scroll));\n  };\n\n  NestedScroll.prototype.buildBScrollGraph = function () {\n    var store = this.store;\n    var bf1;\n    var bf2;\n    var wrapper1;\n    var wrapper2;\n    var len = this.store.length; // build graph\n\n    for (var i = 0; i < len; i++) {\n      bf1 = store[i];\n      wrapper1 = bf1.selfScroll.wrapper;\n\n      for (var j = 0; j < len; j++) {\n        bf2 = store[j];\n        wrapper2 = bf2.selfScroll.wrapper; // same bs\n\n        if (bf1 === bf2) continue;\n        if (!wrapper1.contains(wrapper2)) continue; // bs1 contains bs2\n\n        var distance = calculateDistance(wrapper2, wrapper1);\n\n        if (!bf1.hasDescendants(bf2)) {\n          bf1.addDescendant(bf2, distance);\n        }\n\n        if (!bf2.hasAncestors(bf1)) {\n          bf2.addAncestor(bf1, distance);\n        }\n      }\n    }\n  };\n\n  NestedScroll.prototype.analyzeBScrollGraph = function () {\n    this.store.forEach(function (bscrollFamily) {\n      if (bscrollFamily.analyzed) {\n        return;\n      }\n\n      var ancestors = bscrollFamily.ancestors,\n          descendants = bscrollFamily.descendants,\n          currentScroll = bscrollFamily.selfScroll;\n\n      var beforeScrollStartHandler = function beforeScrollStartHandler() {\n        // always get the latest scroll\n        var ancestorScrolls = ancestors.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        var descendantScrolls = descendants.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        forceScrollStopHandler(__spreadArrays(ancestorScrolls, descendantScrolls));\n\n        if (isResettingPosition(currentScroll)) {\n          resetPositionHandler(currentScroll);\n        }\n\n        syncTouchstartData(ancestorScrolls);\n        disableScrollHander(ancestorScrolls, currentScroll);\n      };\n\n      var touchEndHandler = function touchEndHandler() {\n        var ancestorScrolls = ancestors.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        var descendantScrolls = descendants.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        enableScrollHander(__spreadArrays(ancestorScrolls, descendantScrolls));\n      };\n\n      bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.beforeScrollStart, beforeScrollStartHandler);\n      bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.touchEnd, touchEndHandler);\n      var selfActionsHooks = currentScroll.scroller.actions.hooks;\n      bscrollFamily.registerHooks(selfActionsHooks, selfActionsHooks.eventTypes.detectMovingDirection, function () {\n        var ancestorScrolls = ancestors.map(function (_a) {\n          var bscrollFamily = _a[0];\n          return bscrollFamily.selfScroll;\n        });\n        var parentScroll = ancestorScrolls[0];\n        var otherAncestorScrolls = ancestorScrolls.slice(1);\n        var contentMoved = currentScroll.scroller.actions.contentMoved;\n        var isTopScroll = ancestorScrolls.length === 0;\n\n        if (contentMoved) {\n          disableScrollHander(ancestorScrolls, currentScroll);\n        } else if (!isTopScroll) {\n          if (isOutOfBoundary(currentScroll)) {\n            disableScrollHander([currentScroll], currentScroll);\n\n            if (parentScroll) {\n              enableScrollHander([parentScroll]);\n            }\n\n            disableScrollHander(otherAncestorScrolls, currentScroll);\n            return true;\n          }\n        }\n      });\n      bscrollFamily.setAnalyzed(true);\n    });\n  }; // make sure touchmove|touchend invoke from child to parent\n\n\n  NestedScroll.prototype.ensureEventInvokeSequence = function () {\n    var copied = this.store.slice();\n    var sequencedScroll = copied.sort(function (a, b) {\n      return a.descendants.length - b.descendants.length;\n    });\n    sequencedScroll.forEach(function (bscrollFamily) {\n      var scroll = bscrollFamily.selfScroll;\n      scroll.scroller.actionsHandler.rebindDOMEvents();\n    });\n  };\n\n  NestedScroll.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  NestedScroll.prototype.purgeNestedScroll = function () {\n    var groupId = this.options.groupId;\n    this.store.forEach(function (bscrollFamily) {\n      bscrollFamily.purge();\n    });\n    this.store = [];\n    this.hooksFn.forEach(function (_a) {\n      var hooks = _a[0],\n          eventType = _a[1],\n          handler = _a[2];\n      hooks.off(eventType, handler);\n    });\n    this.hooksFn = [];\n    delete NestedScroll.instancesMap[groupId];\n  };\n\n  NestedScroll.pluginName = 'nestedScroll';\n  NestedScroll.instancesMap = {};\n  return NestedScroll;\n}();\n\nvar PRE_NUM = 10;\nvar POST_NUM = 30;\n\nvar IndexCalculator =\n/** @class */\nfunction () {\n  function IndexCalculator(wrapperHeight, tombstoneHeight) {\n    this.wrapperHeight = wrapperHeight;\n    this.tombstoneHeight = tombstoneHeight;\n    this.lastDirection = 1\n    /* DOWN */\n    ;\n    this.lastPos = 0;\n  }\n\n  IndexCalculator.prototype.calculate = function (pos, list) {\n    var offset = pos - this.lastPos;\n    this.lastPos = pos;\n    var direction = this.getDirection(offset); // important! start index is much more important than end index.\n\n    var start = this.calculateIndex(0, pos, list);\n    var end = this.calculateIndex(start, pos + this.wrapperHeight, list);\n\n    if (direction === 1\n    /* DOWN */\n    ) {\n      start -= PRE_NUM;\n      end += POST_NUM;\n    } else {\n      start -= POST_NUM;\n      end += PRE_NUM;\n    }\n\n    if (start < 0) {\n      start = 0;\n    }\n\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  IndexCalculator.prototype.getDirection = function (offset) {\n    var direction;\n\n    if (offset > 0) {\n      direction = 1\n      /* DOWN */\n      ;\n    } else if (offset < 0) {\n      direction = 0\n      /* UP */\n      ;\n    } else {\n      return this.lastDirection;\n    }\n\n    this.lastDirection = direction;\n    return direction;\n  };\n\n  IndexCalculator.prototype.calculateIndex = function (start, offset, list) {\n    if (offset <= 0) {\n      return start;\n    }\n\n    var i = start;\n    var startPos = list[i] && list[i].pos !== -1 ? list[i].pos : 0;\n    var lastPos = startPos;\n    var tombstone = 0;\n\n    while (i < list.length && list[i].pos < offset) {\n      lastPos = list[i].pos;\n      i++;\n    }\n\n    if (i === list.length) {\n      tombstone = Math.floor((offset - lastPos) / this.tombstoneHeight);\n    }\n\n    i += tombstone;\n    return i;\n  };\n\n  IndexCalculator.prototype.resetState = function () {\n    this.lastDirection = 1\n    /* DOWN */\n    ;\n    this.lastPos = 0;\n  };\n\n  return IndexCalculator;\n}();\n\nvar ListItem =\n/** @class */\nfunction () {\n  function ListItem() {\n    this.data = null;\n    this.dom = null;\n    this.tombstone = null;\n    this.width = 0;\n    this.height = 0;\n    this.pos = 0;\n  }\n\n  return ListItem;\n}();\n\nvar DataManager =\n/** @class */\nfunction () {\n  function DataManager(list, fetchFn, onFetchFinish) {\n    this.fetchFn = fetchFn;\n    this.onFetchFinish = onFetchFinish;\n    this.loadedNum = 0;\n    this.fetching = false;\n    this.hasMore = true;\n    this.list = list || [];\n  }\n\n  DataManager.prototype.update = function (end) {\n    return __awaiter(this, void 0, void 0, function () {\n      var len;\n      return __generator(this, function (_a) {\n        if (!this.hasMore) {\n          end = Math.min(end, this.list.length);\n        } // add data placeholder\n\n\n        if (end > this.list.length) {\n          len = end - this.list.length;\n          this.addEmptyData(len);\n        } // tslint:disable-next-line: no-floating-promises\n\n\n        return [2\n        /*return*/\n        , this.checkToFetch(end)];\n      });\n    });\n  };\n\n  DataManager.prototype.add = function (data) {\n    for (var i = 0; i < data.length; i++) {\n      if (!this.list[this.loadedNum]) {\n        this.list[this.loadedNum] = {\n          data: data[i]\n        };\n      } else {\n        this.list[this.loadedNum] = _assign(_assign({}, this.list[this.loadedNum]), {\n          data: data[i]\n        });\n      }\n\n      this.loadedNum++;\n    }\n\n    return this.list;\n  };\n\n  DataManager.prototype.addEmptyData = function (len) {\n    for (var i = 0; i < len; i++) {\n      this.list.push(new ListItem());\n    }\n\n    return this.list;\n  };\n\n  DataManager.prototype.fetch = function (len) {\n    return __awaiter(this, void 0, void 0, function () {\n      var data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (this.fetching) {\n              return [2\n              /*return*/\n              , []];\n            }\n\n            this.fetching = true;\n            return [4\n            /*yield*/\n            , this.fetchFn(len)];\n\n          case 1:\n            data = _a.sent();\n            this.fetching = false;\n            return [2\n            /*return*/\n            , data];\n        }\n      });\n    });\n  };\n\n  DataManager.prototype.checkToFetch = function (end) {\n    return __awaiter(this, void 0, void 0, function () {\n      var min, newData, currentEnd;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!this.hasMore) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            if (end <= this.loadedNum) {\n              return [2\n              /*return*/\n              ];\n            }\n\n            min = end - this.loadedNum;\n            return [4\n            /*yield*/\n            , this.fetch(min)];\n\n          case 1:\n            newData = _a.sent();\n\n            if (newData instanceof Array && newData.length) {\n              this.add(newData);\n              currentEnd = this.onFetchFinish(this.list, true);\n              return [2\n              /*return*/\n              , this.checkToFetch(currentEnd)];\n            } else if (typeof newData === 'boolean' && newData === false) {\n              this.hasMore = false;\n              this.list.splice(this.loadedNum);\n              this.onFetchFinish(this.list, false);\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  DataManager.prototype.getList = function () {\n    return this.list;\n  };\n\n  DataManager.prototype.resetState = function () {\n    this.loadedNum = 0;\n    this.fetching = false;\n    this.hasMore = true;\n    this.list = [];\n  };\n\n  return DataManager;\n}();\n\nvar Tombstone =\n/** @class */\nfunction () {\n  function Tombstone(create) {\n    this.create = create;\n    this.cached = [];\n    this.width = 0;\n    this.height = 0;\n    this.initialed = false;\n    this.getSize();\n  }\n\n  Tombstone.isTombstone = function (el) {\n    if (el && el.classList) {\n      return el.classList.contains('tombstone');\n    }\n\n    return false;\n  };\n\n  Tombstone.prototype.getSize = function () {\n    if (!this.initialed) {\n      var tombstone = this.create();\n      tombstone.style.position = 'absolute';\n      document.body.appendChild(tombstone);\n      tombstone.style.display = '';\n      this.height = tombstone.offsetHeight;\n      this.width = tombstone.offsetWidth;\n      document.body.removeChild(tombstone);\n      this.cached.push(tombstone);\n    }\n  };\n\n  Tombstone.prototype.getOne = function () {\n    var tombstone = this.cached.pop();\n\n    if (tombstone) {\n      var tombstoneStyle = tombstone.style;\n      tombstoneStyle.display = '';\n      tombstoneStyle.opacity = '1';\n      tombstoneStyle[style.transform] = '';\n      tombstoneStyle[style.transition] = '';\n      return tombstone;\n    }\n\n    return this.create();\n  };\n\n  Tombstone.prototype.recycle = function (tombstones) {\n    for (var _i = 0, tombstones_1 = tombstones; _i < tombstones_1.length; _i++) {\n      var tombstone = tombstones_1[_i];\n      tombstone.style.display = 'none';\n      this.cached.push(tombstone);\n    }\n\n    return this.cached;\n  };\n\n  Tombstone.prototype.recycleOne = function (tombstone) {\n    this.cached.push(tombstone);\n    return this.cached;\n  };\n\n  return Tombstone;\n}();\n\nvar ANIMATION_DURATION_MS = 200;\n\nvar DomManager =\n/** @class */\nfunction () {\n  function DomManager(content, renderFn, tombstone) {\n    this.renderFn = renderFn;\n    this.tombstone = tombstone;\n    this.unusedDom = [];\n    this.timers = [];\n    this.setContent(content);\n  }\n\n  DomManager.prototype.update = function (list, start, end) {\n    if (start >= list.length) {\n      start = list.length - 1;\n    }\n\n    if (end > list.length) {\n      end = list.length;\n    }\n\n    this.collectUnusedDom(list, start, end);\n    this.createDom(list, start, end);\n    this.cacheHeight(list, start, end);\n\n    var _a = this.positionDom(list, start, end),\n        startPos = _a.startPos,\n        startDelta = _a.startDelta,\n        endPos = _a.endPos;\n\n    return {\n      start: start,\n      startPos: startPos,\n      startDelta: startDelta,\n      end: end,\n      endPos: endPos\n    };\n  };\n\n  DomManager.prototype.collectUnusedDom = function (list, start, end) {\n    // TODO optimise\n    for (var i = 0; i < list.length; i++) {\n      if (i === start) {\n        i = end - 1;\n        continue;\n      }\n\n      if (list[i].dom) {\n        var dom = list[i].dom;\n\n        if (Tombstone.isTombstone(dom)) {\n          this.tombstone.recycleOne(dom);\n          dom.style.display = 'none';\n        } else {\n          this.unusedDom.push(dom);\n        }\n\n        list[i].dom = null;\n      }\n    }\n\n    return list;\n  };\n\n  DomManager.prototype.createDom = function (list, start, end) {\n    for (var i = start; i < end; i++) {\n      var dom = list[i].dom;\n      var data = list[i].data;\n\n      if (dom) {\n        if (Tombstone.isTombstone(dom) && data) {\n          list[i].tombstone = dom;\n          list[i].dom = null;\n        } else {\n          continue;\n        }\n      }\n\n      dom = data ? this.renderFn(data, this.unusedDom.pop()) : this.tombstone.getOne();\n      dom.style.position = 'absolute';\n      list[i].dom = dom;\n      list[i].pos = -1;\n      this.content.appendChild(dom);\n    }\n  };\n\n  DomManager.prototype.cacheHeight = function (list, start, end) {\n    for (var i = start; i < end; i++) {\n      if (list[i].data && !list[i].height) {\n        list[i].height = list[i].dom.offsetHeight;\n      }\n    }\n  };\n\n  DomManager.prototype.positionDom = function (list, start, end) {\n    var _this = this;\n\n    var tombstoneEles = [];\n\n    var _a = this.getStartPos(list, start, end),\n        startPos = _a.start,\n        startDelta = _a.delta;\n\n    var pos = startPos;\n\n    for (var i = start; i < end; i++) {\n      var tombstone = list[i].tombstone;\n\n      if (tombstone) {\n        var tombstoneStyle = tombstone.style;\n        tombstoneStyle[style.transition] = cssVendor + \"transform \" + ANIMATION_DURATION_MS + \"ms, opacity \" + ANIMATION_DURATION_MS + \"ms\";\n        tombstoneStyle[style.transform] = \"translateY(\" + pos + \"px)\";\n        tombstoneStyle.opacity = '0';\n        list[i].tombstone = null;\n        tombstoneEles.push(tombstone);\n      }\n\n      if (list[i].dom && list[i].pos !== pos) {\n        list[i].dom.style[style.transform] = \"translateY(\" + pos + \"px)\";\n        list[i].pos = pos;\n      }\n\n      pos += list[i].height || this.tombstone.height;\n    }\n\n    var timerId = window.setTimeout(function () {\n      _this.tombstone.recycle(tombstoneEles);\n    }, ANIMATION_DURATION_MS);\n    this.timers.push(timerId);\n    return {\n      startPos: startPos,\n      startDelta: startDelta,\n      endPos: pos\n    };\n  };\n\n  DomManager.prototype.getStartPos = function (list, start, end) {\n    if (list[start] && list[start].pos !== -1) {\n      return {\n        start: list[start].pos,\n        delta: 0\n      };\n    } // TODO optimise\n\n\n    var pos = list[0].pos === -1 ? 0 : list[0].pos;\n\n    for (var i_1 = 0; i_1 < start; i_1++) {\n      pos += list[i_1].height || this.tombstone.height;\n    }\n\n    var originPos = pos;\n    var i;\n\n    for (i = start; i < end; i++) {\n      if (!Tombstone.isTombstone(list[i].dom) && list[i].pos !== -1) {\n        pos = list[i].pos;\n        break;\n      }\n    }\n\n    var x = i;\n\n    if (x < end) {\n      while (x > start) {\n        pos -= list[x - 1].height;\n        x--;\n      }\n    }\n\n    var delta = originPos - pos;\n    return {\n      start: pos,\n      delta: delta\n    };\n  };\n\n  DomManager.prototype.removeTombstone = function () {\n    var tombstones = this.content.querySelectorAll('.tombstone');\n\n    for (var i = tombstones.length - 1; i >= 0; i--) {\n      this.content.removeChild(tombstones[i]);\n    }\n  };\n\n  DomManager.prototype.setContent = function (content) {\n    if (content !== this.content) {\n      this.content = content;\n    }\n  };\n\n  DomManager.prototype.destroy = function () {\n    this.removeTombstone();\n    this.timers.forEach(function (id) {\n      clearTimeout(id);\n    });\n  };\n\n  DomManager.prototype.resetState = function () {\n    this.destroy();\n    this.timers = [];\n    this.unusedDom = [];\n  };\n\n  return DomManager;\n}();\n\nvar EXTRA_SCROLL_Y = -2000;\n\nvar InfinityScroll =\n/** @class */\nfunction () {\n  function InfinityScroll(scroll) {\n    this.scroll = scroll;\n    this.start = 0;\n    this.end = 0;\n    this.init();\n  }\n\n  InfinityScroll.prototype.init = function () {\n    var _this = this;\n\n    this.handleOptions();\n    var _a = this.options,\n        fetchFn = _a.fetch,\n        renderFn = _a.render,\n        createTombstoneFn = _a.createTombstone;\n    this.tombstone = new Tombstone(createTombstoneFn);\n    this.indexCalculator = new IndexCalculator(this.scroll.scroller.scrollBehaviorY.wrapperSize, this.tombstone.height);\n    this.domManager = new DomManager(this.scroll.scroller.content, renderFn, this.tombstone);\n    this.dataManager = new DataManager([], fetchFn, this.onFetchFinish.bind(this));\n    this.scroll.on(this.scroll.eventTypes.destroy, this.destroy, this);\n    this.scroll.on(this.scroll.eventTypes.scroll, this.update, this);\n    this.scroll.on(this.scroll.eventTypes.contentChanged, function (content) {\n      _this.domManager.setContent(content);\n\n      _this.indexCalculator.resetState();\n\n      _this.domManager.resetState();\n\n      _this.dataManager.resetState();\n\n      _this.update({\n        y: 0\n      });\n    });\n    var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\n    scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, this.modifyBoundary, this);\n    this.update({\n      y: 0\n    });\n  };\n\n  InfinityScroll.prototype.modifyBoundary = function (boundary) {\n    // manually set position to allow scroll\n    boundary.maxScrollPos = EXTRA_SCROLL_Y;\n  };\n\n  InfinityScroll.prototype.handleOptions = function () {\n    // narrow down type to an object\n    var infinityOptions = this.scroll.options.infinity;\n\n    if (infinityOptions) {\n      if (typeof infinityOptions.fetch !== 'function') {\n        warn('Infinity plugin need fetch Function to new data.');\n      }\n\n      if (typeof infinityOptions.render !== 'function') {\n        warn('Infinity plugin need render Function to render each item.');\n      }\n\n      if (typeof infinityOptions.render !== 'function') {\n        warn('Infinity plugin need createTombstone Function to create tombstone.');\n      }\n\n      this.options = infinityOptions;\n    }\n\n    this.scroll.options.probeType = 3\n    /* Realtime */\n    ;\n  };\n\n  InfinityScroll.prototype.update = function (pos) {\n    var position = Math.round(-pos.y); // important! calculate start/end index to render\n\n    var _a = this.indexCalculator.calculate(position, this.dataManager.getList()),\n        start = _a.start,\n        end = _a.end;\n\n    this.start = start;\n    this.end = end; // tslint:disable-next-line: no-floating-promises\n\n    this.dataManager.update(end);\n    this.updateDom(this.dataManager.getList());\n  };\n\n  InfinityScroll.prototype.onFetchFinish = function (list, hasMore) {\n    var end = this.updateDom(list).end;\n\n    if (!hasMore) {\n      this.domManager.removeTombstone();\n      this.scroll.scroller.animater.stop();\n      this.scroll.resetPosition();\n    } // tslint:disable-next-line: no-floating-promises\n\n\n    return end;\n  };\n\n  InfinityScroll.prototype.updateDom = function (list) {\n    var _a = this.domManager.update(list, this.start, this.end),\n        end = _a.end,\n        startPos = _a.startPos,\n        endPos = _a.endPos,\n        startDelta = _a.startDelta;\n\n    if (startDelta) {\n      this.scroll.minScrollY = startDelta;\n    }\n\n    if (endPos > this.scroll.maxScrollY) {\n      this.scroll.maxScrollY = -(endPos - this.scroll.scroller.scrollBehaviorY.wrapperSize);\n    }\n\n    return {\n      end: end,\n      startPos: startPos,\n      endPos: endPos\n    };\n  };\n\n  InfinityScroll.prototype.destroy = function () {\n    var _a = this.scroll.scroller,\n        content = _a.content,\n        scrollBehaviorY = _a.scrollBehaviorY;\n\n    while (content.firstChild) {\n      content.removeChild(content.firstChild);\n    }\n\n    this.domManager.destroy();\n    this.scroll.off('scroll', this.update);\n    this.scroll.off('destroy', this.destroy);\n    scrollBehaviorY.hooks.off(scrollBehaviorY.hooks.eventTypes.computeBoundary);\n  };\n\n  InfinityScroll.pluginName = 'infinity';\n  return InfinityScroll;\n}();\n\nvar sourcePrefix = 'plugins.movable';\nvar propertiesMap = [{\n  key: 'putAt',\n  name: 'putAt'\n}];\nvar propertiesConfig = propertiesMap.map(function (item) {\n  return {\n    key: item.key,\n    sourceKey: sourcePrefix + \".\" + item.name\n  };\n});\n\nvar Movable =\n/** @class */\nfunction () {\n  function Movable(scroll) {\n    this.scroll = scroll;\n    this.handleBScroll();\n    this.handleHooks();\n  }\n\n  Movable.prototype.handleBScroll = function () {\n    this.scroll.proxy(propertiesConfig);\n  };\n\n  Movable.prototype.handleHooks = function () {\n    var _this = this;\n\n    this.hooksFn = [];\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n\n    var computeBoundary = function computeBoundary(boundary, behavior) {\n      if (boundary.maxScrollPos > 0) {\n        // content is smaller than wrapper\n        boundary.minScrollPos = behavior.wrapperSize - behavior.contentSize;\n        boundary.maxScrollPos = 0;\n      }\n    };\n\n    this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.ignoreHasScroll, function () {\n      return true;\n    });\n    this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\n      computeBoundary(boundary, scrollBehaviorX);\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.ignoreHasScroll, function () {\n      return true;\n    });\n    this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\n      computeBoundary(boundary, scrollBehaviorY);\n    });\n    this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\n      _this.destroy();\n    });\n  };\n\n  Movable.prototype.putAt = function (x, y, time, easing) {\n    if (time === void 0) {\n      time = this.scroll.options.bounceTime;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    var position = this.resolvePostion(x, y);\n    this.scroll.scrollTo(position.x, position.y, time, easing);\n  };\n\n  Movable.prototype.resolvePostion = function (x, y) {\n    var _a = this.scroll.scroller,\n        scrollBehaviorX = _a.scrollBehaviorX,\n        scrollBehaviorY = _a.scrollBehaviorY;\n    var resolveFormula = {\n      left: function left() {\n        return 0;\n      },\n      top: function top() {\n        return 0;\n      },\n      right: function right() {\n        return scrollBehaviorX.minScrollPos;\n      },\n      bottom: function bottom() {\n        return scrollBehaviorY.minScrollPos;\n      },\n      center: function center(index) {\n        var baseSize = index === 0 ? scrollBehaviorX.minScrollPos : scrollBehaviorY.minScrollPos;\n        return baseSize / 2;\n      }\n    };\n    return {\n      x: typeof x === 'number' ? x : resolveFormula[x](0),\n      y: typeof y === 'number' ? y : resolveFormula[y](1)\n    };\n  };\n\n  Movable.prototype.destroy = function () {\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  Movable.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Movable.pluginName = 'movable';\n  Movable.applyOrder = \"pre\"\n  /* Pre */\n  ;\n  return Movable;\n}();\n\nvar isImageTag = function isImageTag(el) {\n  return el.tagName.toLowerCase() === 'img';\n};\n\nvar ObserveImage =\n/** @class */\nfunction () {\n  function ObserveImage(scroll) {\n    this.scroll = scroll;\n    this.refreshTimer = 0;\n    this.init();\n  }\n\n  ObserveImage.prototype.init = function () {\n    this.handleOptions(this.scroll.options.observeImage);\n    this.bindEventsToWrapper();\n  };\n\n  ObserveImage.prototype.handleOptions = function (userOptions) {\n    if (userOptions === void 0) {\n      userOptions = {};\n    }\n\n    userOptions = userOptions === true ? {} : userOptions;\n    var defaultOptions = {\n      debounceTime: 100\n    };\n    this.options = extend(defaultOptions, userOptions);\n  };\n\n  ObserveImage.prototype.bindEventsToWrapper = function () {\n    var wrapper = this.scroll.scroller.wrapper;\n    this.imageLoadEventRegister = new EventRegister(wrapper, [{\n      name: 'load',\n      handler: this.load.bind(this),\n      capture: true\n    }]);\n    this.imageErrorEventRegister = new EventRegister(wrapper, [{\n      name: 'error',\n      handler: this.load.bind(this),\n      capture: true\n    }]);\n  };\n\n  ObserveImage.prototype.load = function (e) {\n    var _this = this;\n\n    var target = e.target;\n    var debounceTime = this.options.debounceTime;\n\n    if (target && isImageTag(target)) {\n      if (debounceTime === 0) {\n        this.scroll.refresh();\n      } else {\n        clearTimeout(this.refreshTimer);\n        this.refreshTimer = window.setTimeout(function () {\n          _this.scroll.refresh();\n        }, this.options.debounceTime);\n      }\n    }\n  };\n\n  ObserveImage.pluginName = 'observeImage';\n  return ObserveImage;\n}();\n\nvar resolveRatioOption = function resolveRatioOption(ratioConfig) {\n  var ret = {\n    ratioX: 0,\n    ratioY: 0\n  };\n  /* istanbul ignore if  */\n\n  if (!ratioConfig) {\n    return ret;\n  }\n\n  if (typeof ratioConfig === 'number') {\n    ret.ratioX = ret.ratioY = ratioConfig;\n  } else if (_typeof(ratioConfig) === 'object' && ratioConfig) {\n    ret.ratioX = ratioConfig.x || 0;\n    ret.ratioY = ratioConfig.y || 0;\n  }\n\n  return ret;\n};\n\nvar handleBubbleAndCancelable = function handleBubbleAndCancelable(e) {\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nvar Indicator =\n/** @class */\nfunction () {\n  function Indicator(scroll, options) {\n    this.scroll = scroll;\n    this.options = options;\n    this.currentPos = {\n      x: 0,\n      y: 0\n    };\n    this.hooksFn = [];\n    this.handleDOM();\n    this.handleHooks();\n    this.handleInteractive();\n  }\n\n  Indicator.prototype.handleDOM = function () {\n    var _a = this.options,\n        relationElement = _a.relationElement,\n        _b = _a.relationElementHandleElementIndex,\n        relationElementHandleElementIndex = _b === void 0 ? 0 : _b;\n    this.wrapper = relationElement;\n    this.indicatorEl = this.wrapper.children[relationElementHandleElementIndex];\n  };\n\n  Indicator.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scroll = this.scroll;\n    var scrollHooks = scroll.hooks;\n    var translaterHooks = scroll.scroller.translater.hooks;\n    var animaterHooks = scroll.scroller.animater.hooks;\n    this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\n    this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\n      _this.updatePosition(pos);\n    });\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\n    this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\n  };\n\n  Indicator.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.indicatorEl.style[style.transitionDuration] = time + 'ms';\n  };\n\n  Indicator.prototype.transitionTimingFunction = function (easing) {\n    this.indicatorEl.style[style.transitionTimingFunction] = easing;\n  };\n\n  Indicator.prototype.handleInteractive = function () {\n    if (this.options.interactive !== false) {\n      this.registerEvents();\n    }\n  };\n\n  Indicator.prototype.registerHooks = function (hooks, name, handler) {\n    hooks.on(name, handler, this);\n    this.hooksFn.push([hooks, name, handler]);\n  };\n\n  Indicator.prototype.registerEvents = function () {\n    var _a = this.scroll.options,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch;\n    var startEvents = [];\n    var moveEvents = [];\n    var endEvents = [];\n\n    if (!disableMouse) {\n      startEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (!disableTouch) {\n      startEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      moveEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      });\n      endEvents.push({\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.startEventRegister = new EventRegister(this.indicatorEl, startEvents);\n    this.moveEventRegister = new EventRegister(window, moveEvents);\n    this.endEventRegister = new EventRegister(window, endEvents);\n  };\n\n  Indicator.prototype.refresh = function () {\n    var _a = this.scroll,\n        x = _a.x,\n        y = _a.y,\n        hasHorizontalScroll = _a.hasHorizontalScroll,\n        hasVerticalScroll = _a.hasVerticalScroll,\n        maxBScrollX = _a.maxScrollX,\n        maxBScrollY = _a.maxScrollY;\n\n    var _b = resolveRatioOption(this.options.ratio),\n        ratioX = _b.ratioX,\n        ratioY = _b.ratioY;\n\n    var _c = getClientSize(this.wrapper),\n        wrapperWidth = _c.width,\n        wrapperHeight = _c.height;\n\n    var _d = getRect(this.indicatorEl),\n        indicatorWidth = _d.width,\n        indicatorHeight = _d.height;\n\n    if (hasHorizontalScroll) {\n      this.maxScrollX = wrapperWidth - indicatorWidth;\n      this.translateXSign = this.maxScrollX > 0 ? -1\n      /* Positive */\n      : 1\n      /* NotPositive */\n      ;\n      this.minScrollX = 0; // ensure positive\n\n      this.ratioX = ratioX ? ratioX : Math.abs(this.maxScrollX / maxBScrollX);\n    }\n\n    if (hasVerticalScroll) {\n      this.maxScrollY = wrapperHeight - indicatorHeight;\n      this.translateYSign = this.maxScrollY > 0 ? -1\n      /* Positive */\n      : 1\n      /* NotPositive */\n      ;\n      this.minScrollY = 0;\n      this.ratioY = ratioY ? ratioY : Math.abs(this.maxScrollY / maxBScrollY);\n    }\n\n    this.updatePosition({\n      x: x,\n      y: y\n    });\n  };\n\n  Indicator.prototype.start = function (e) {\n    if (this.BScrollIsDisabled()) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    handleBubbleAndCancelable(e);\n    this.initiated = true;\n    this.moved = false;\n    this.lastPointX = point.pageX;\n    this.lastPointY = point.pageY;\n    this.startTime = getNow();\n    this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\n  };\n\n  Indicator.prototype.BScrollIsDisabled = function () {\n    return !this.scroll.enabled;\n  };\n\n  Indicator.prototype.move = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    var point = e.touches ? e.touches[0] : e;\n    var pointX = point.pageX;\n    var pointY = point.pageY;\n    handleBubbleAndCancelable(e);\n    var deltaX = pointX - this.lastPointX;\n    var deltaY = pointY - this.lastPointY;\n    this.lastPointX = pointX;\n    this.lastPointY = pointY;\n\n    if (!this.moved && !this.indicatorNotMoved(deltaX, deltaY)) {\n      this.moved = true;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\n    }\n\n    if (this.moved) {\n      var newPos = this.getBScrollPosByRatio(this.currentPos, deltaX, deltaY);\n      this.syncBScroll(newPos);\n    }\n  };\n\n  Indicator.prototype.end = function (e) {\n    if (!this.initiated) {\n      return;\n    }\n\n    this.initiated = false;\n    handleBubbleAndCancelable(e);\n\n    if (this.moved) {\n      var _a = this.scroll,\n          x = _a.x,\n          y = _a.y;\n      this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\n        x: x,\n        y: y\n      });\n    }\n  };\n\n  Indicator.prototype.getBScrollPosByRatio = function (currentPos, deltaX, deltaY) {\n    var currentX = currentPos.x,\n        currentY = currentPos.y;\n    var _a = this.scroll,\n        hasHorizontalScroll = _a.hasHorizontalScroll,\n        hasVerticalScroll = _a.hasVerticalScroll,\n        BScrollMinScrollX = _a.minScrollX,\n        BScrollMaxScrollX = _a.maxScrollX,\n        BScrollMinScrollY = _a.minScrollY,\n        BScrollMaxScrollY = _a.maxScrollY;\n    var _b = this.scroll,\n        x = _b.x,\n        y = _b.y;\n\n    if (hasHorizontalScroll) {\n      var newPosX = between(currentX + deltaX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\n      var roundX = Math.round(newPosX / this.ratioX * this.translateXSign);\n      x = between(roundX, BScrollMaxScrollX, BScrollMinScrollX);\n    }\n\n    if (hasVerticalScroll) {\n      var newPosY = between(currentY + deltaY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\n      var roundY = Math.round(newPosY / this.ratioY * this.translateYSign);\n      y = between(roundY, BScrollMaxScrollY, BScrollMinScrollY);\n    }\n\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  Indicator.prototype.indicatorNotMoved = function (deltaX, deltaY) {\n    var _a = this.currentPos,\n        x = _a.x,\n        y = _a.y;\n    var xNotMoved = x === this.minScrollX && deltaX <= 0 || x === this.maxScrollX && deltaX >= 0;\n    var yNotMoved = y === this.minScrollY && deltaY <= 0 || y === this.maxScrollY && deltaY >= 0;\n    return xNotMoved && yNotMoved;\n  };\n\n  Indicator.prototype.syncBScroll = function (newPos) {\n    var timestamp = getNow();\n    var _a = this.scroll,\n        options = _a.options,\n        scroller = _a.scroller;\n    var probeType = options.probeType,\n        momentumLimitTime = options.momentumLimitTime;\n    scroller.translater.translate(newPos); // dispatch scroll in interval time\n\n    if (timestamp - this.startTime > momentumLimitTime) {\n      this.startTime = timestamp;\n\n      if (probeType === 1\n      /* Throttle */\n      ) {\n        scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\n      }\n    } // dispatch scroll all the time\n\n\n    if (probeType > 1\n    /* Throttle */\n    ) {\n      scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\n    }\n  };\n\n  Indicator.prototype.updatePosition = function (BScrollPos) {\n    var newIndicatorPos = this.getIndicatorPosByRatio(BScrollPos);\n    this.applyTransformProperty(newIndicatorPos);\n    this.currentPos = _assign({}, newIndicatorPos);\n  };\n\n  Indicator.prototype.applyTransformProperty = function (pos) {\n    var translateZ = this.scroll.options.translateZ;\n    var transformProperties = [\"translateX(\" + pos.x + \"px)\", \"translateY(\" + pos.y + \"px)\", \"\" + translateZ];\n    this.indicatorEl.style[style.transform] = transformProperties.join(' ');\n  };\n\n  Indicator.prototype.getIndicatorPosByRatio = function (BScrollPos) {\n    var x = BScrollPos.x,\n        y = BScrollPos.y;\n    var _a = this.scroll,\n        hasHorizontalScroll = _a.hasHorizontalScroll,\n        hasVerticalScroll = _a.hasVerticalScroll;\n\n    var position = _assign({}, this.currentPos);\n\n    if (hasHorizontalScroll) {\n      var roundX = Math.round(this.ratioX * x * this.translateXSign); // maybe maxScrollX is negative\n\n      position.x = between(roundX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\n    }\n\n    if (hasVerticalScroll) {\n      var roundY = Math.round(this.ratioY * y * this.translateYSign); // maybe maxScrollY is negative\n\n      position.y = between(roundY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\n    }\n\n    return position;\n  };\n\n  Indicator.prototype.destroy = function () {\n    if (this.options.interactive !== false) {\n      this.startEventRegister.destroy();\n      this.moveEventRegister.destroy();\n      this.endEventRegister.destroy();\n    }\n\n    this.hooksFn.forEach(function (item) {\n      var hooks = item[0];\n      var hooksName = item[1];\n      var handlerFn = item[2];\n      hooks.off(hooksName, handlerFn);\n    });\n    this.hooksFn.length = 0;\n  };\n\n  return Indicator;\n}();\n\nvar Indicators =\n/** @class */\nfunction () {\n  function Indicators(scroll) {\n    this.scroll = scroll;\n    this.options = [];\n    this.indicators = [];\n    this.handleOptions();\n    this.handleHooks();\n  }\n\n  Indicators.prototype.handleOptions = function () {\n    var UserIndicatorsOptions = this.scroll.options.indicators;\n    assert(Array.isArray(UserIndicatorsOptions), \"'indicators' must be an array.\");\n\n    for (var _i = 0, UserIndicatorsOptions_1 = UserIndicatorsOptions; _i < UserIndicatorsOptions_1.length; _i++) {\n      var indicatorOptions = UserIndicatorsOptions_1[_i];\n      assert(!!indicatorOptions.relationElement, \"'relationElement' must be a HTMLElement.\");\n      this.createIndicators(indicatorOptions);\n    }\n  };\n\n  Indicators.prototype.createIndicators = function (options) {\n    this.indicators.push(new Indicator(this.scroll, options));\n  };\n\n  Indicators.prototype.handleHooks = function () {\n    var _this = this;\n\n    var scrollHooks = this.scroll.hooks;\n    scrollHooks.on(scrollHooks.eventTypes.destroy, function () {\n      for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\n        var indicator = _a[_i];\n        indicator.destroy();\n      }\n\n      _this.indicators = [];\n    });\n  };\n\n  Indicators.pluginName = 'indicators';\n  return Indicators;\n}();\n\nBScroll.use(MouseWheel).use(ObserveDOM).use(PullDown).use(PullUp).use(ScrollBar).use(Slide).use(Wheel).use(Zoom).use(NestedScroll).use(InfinityScroll).use(Movable).use(ObserveImage).use(Indicators);\nexport default BScroll;\nexport { Behavior, CustomOptions, Indicators, InfinityScroll, MouseWheel, Movable, NestedScroll, ObserveDOM as ObserveDom, ObserveImage, PullDown as PullDownRefresh, PullUp as PullUpLoad, ScrollBar, Slide, Wheel, Zoom, createBScroll };","map":{"version":3,"sources":["E:/VSCode/project/Vue/supermall01/node_modules/better-scroll/dist/better-scroll.esm.js"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__spreadArrays","il","r","k","a","j","jl","propertiesConfig$7","sourceKey","key","warn","msg","console","error","assert","condition","Error","inBrowser","window","ua","navigator","userAgent","toLowerCase","isWeChatDevTools","test","isAndroid","indexOf","isIOSBadVersion","regex","matches","exec","parts","split","map","item","parseInt","supportsPassive","EventName","opts","defineProperty","get","addEventListener","getNow","performance","now","timing","navigationStart","Date","extend","target","source","isUndef","undefined","getDistance","x","Math","sqrt","between","min","max","findIndex","ary","fn","index","some","ret","elementStyle","document","createElement","style","vendor","transformNames","_i","transformNames_1","obj","prefixStyle","charAt","toUpperCase","substr","getElement","el","querySelector","addEvent","type","capture","useCapture","passive","removeEvent","removeEventListener","offset","left","top","offsetLeft","offsetTop","offsetParent","offsetToBody","rect","getBoundingClientRect","pageXOffset","pageYOffset","cssVendor","transform","transition","hasPerspective","hasTouch","hasTransition","transitionTimingFunction","transitionDuration","transitionDelay","transformOrigin","transitionEnd","transitionProperty","eventTypeMap","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup","getRect","SVGElement","width","height","offsetWidth","offsetHeight","preventDefaultExceptionFn","exceptions","tagExceptionFn","tap","eventName","ev","createEvent","initEvent","pageX","pageY","dispatchEvent","click","event","eventSource","changedTouches","posSrc","screenX","screenY","clientX","clientY","bubbles","cancelable","ctrlKey","shiftKey","altKey","metaKey","pressedKeysMap","MouseEvent","forwardedTouchEvent","_constructed","dblclick","prepend","firstChild","before","appendChild","parentNode","insertBefore","removeChild","child","hasClass","className","reg","RegExp","HTMLCollectionToArray","slice","getClientSize","clientWidth","clientHeight","ease","swipe","swipeBounce","bounce","DEFAULT_INTERVAL","windowCompat","noop$1","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","callback","setTimeout","interval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","id","clearTimeout","noop","val","sharedPropertyDefinition","enumerable","configurable","set","getProperty","keys","lastKey","setProperty","temp","propertiesProxy","proxyGetter","proxySetter","EventEmitter","names","events","eventTypes","registerType","on","context","hasType","once","_this","magic","args","off","count","splice","trigger","len","eventsCopy","event_1","forEach","destroy","types","isType","JSON","stringify","EventRegister","wrapper","addDOMEvents","removeDOMEvents","handleDOMEvents","eventOperation","name","handleEvent","eventType","handler","CustomOptions","OptionsConstructor","_super","startX","startY","scrollX","scrollY","freeScroll","directionLockThreshold","eventPassthrough","bottom","right","bounceTime","momentum","momentumLimitTime","momentumLimitDistance","swipeTime","swipeBounceTime","deceleration","flickLimitTime","flickLimitDistance","resizePolling","probeType","stopPropagation","preventDefault","preventDefaultException","tagName","tagException","HWCompositing","useTransition","bindToWrapper","bindToTarget","disableMouse","disableTouch","autoBlur","autoEndDistance","outOfBoundaryDampingFactor","specifiedIndexAsContent","quadrant","merge","options","resolveBounce","process","translateZ","bounceOptions","DEFAULT_BOUNCE","NEGATED_BOUNCE","ActionsHandler","hooks","_a","wrapperEvents","targetEvents","shouldRegisterTouch","shouldRegisterMouse","bind","start","move","end","wrapperEventRegister","targetEventRegister","beforeHandler","preventDefaultConditions","setInitiated","initiated","_eventType","button","beforeStart","point","touches","pointX","pointY","deltaX","deltaY","scrollLeft","documentElement","scrollTop","pX","pY","setContent","content","rebindDOMEvents","translaterMetaData","Translater","getComputedPosition","cssStyle","getComputedStyle","matrix","translate","transformStyle","transformFnName","transformFnArgUnit","transformFnArg","beforeTranslate","join","Base","translater","timer","endPoint","setPending","pending","setForceStopped","forceStopped","setCallStop","called","callStopWhenPending","stop","clearTimer","isValidPostion","startPoint","currentPos","prePos","computeDirection","endValue","startValue","delta","direction","directionX","directionY","Transition","startProbe","probe","pos","transitionTime","time","easing","timeFunction","easingFn","isRealtimeProbeType","_reflow","doStop","forceStop","stopFromTransition","callStop","Animation","animate","duration","startTime","destTime","newPoint","stopFromAnimation","createAnimater","element","animaterOptions","Behavior","refresh","dist","setMovingDirection","setDirection","hasScroll","performDampingAlgorithm","movingDirection","dampingFactor","newPos","minScrollPos","maxScrollPos","bounces","momentumInfo","absDist","abs","startPos","wrapperSize","destination","current","lowerMargin","upperMargin","distance","speed","momentumData","rate","round","updateDirection","absStartPos","size","position","isWrapperStatic","wrapperRect","contentRect","contentSize","relativeOffset","computeBoundary","resetState","resetStartPos","beforeComputeBoundary","boundary","scrollable","updatePosition","getCurrentPos","checkInBoundary","adjustPosition","inBoundary","ignoreHasScroll","updateStartPos","updateAbsStartPos","getAbsDist","_b","_c","_d","PassthroughHandlers","DirectionMap","DirectionLockAction","reset","directionLocked","checkMovingDirection","absDistX","absDistY","computeDirectionLock","handleEventPassthrough","adjustDelta","handleMap","applyQuadrantTransformation","ScrollerActions","scrollBehaviorX","scrollBehaviorY","actionsHandler","animater","directionLockAction","enabled","bindActionsHandler","handleStart","transformateDeltaX","transformateDeltaY","transformateDeltaData","coordinateTransformation","handleMove","handleEnd","handleClick","timestamp","fingerMoved","contentMoved","beforeMove","checkMomentum","prevX","newX","prevY","newY","detectMovingDirection","positionChanged","contentNotMoved","scrollStart","dispatchScroll","scroll","endTime","beforeEnd","ensureIntegerPos","scrollEnd","ensuringInteger","minScrollPosX","maxScrollPosX","minScrollPosY","maxScrollPosY","ceil","floor","createActionsHandlerOptions","bsOptions","reduce","prev","cur","createBehaviorOptions","extraProp","bubbling","sourceEvent","targetEvent","isSamePoint","keys_1","MIN_SCROLL_DISTANCE","Scroller","resizeTimeout","actions","resizeHandler","resize","resizeRegister","registerTransitionEnd","init","bindTranslater","bindAnimater","bindActions","togglePointerEvents","transitionEndRegister","prevPos","updatePositions","resetPosition","beforeScrollStart","touchEnd","scrollCancel","checkClick","checkFlick","flick","flickMinMovingDistance","meta","swiper","momentumX","momentumY","scrollTo","preventClick","_dblclick","dblclickTrigged","lastClickTime","delay","children","pointerEvents","node","isBScrollContainer","contentChanged","beforeRefresh","wrapperOffset","scrollBy","extraTransform","minDistanceScroll","scrollToElement","offsetX","offsetY","targetEle","getOffset","getPos","wrapperPos","scrollBehavior","xInBoundary","yInBoundary","reflow","enable","disable","BScrollConstructor","plugins","valid","use","ctor","pluginName","installed","plugin","pluginsMap","applyOrder","scroller","eventBubbling","handleAutoBlur","proxy","applyPlugins","refreshWithoutReset","beforeInitialScrollTo","sort","applyOrderMap","aOrder","bOrder","activeElement","blur","propertiesConfig","eventRegister","createBScroll","bs","BScroll","MouseWheel","wheelEndTimer","wheelMoveTimer","wheelStart","handleBScroll","handleOptions","handleHooks","registerEvent","userOptions","mouseWheel","defaultOptions","invert","easeTime","discreteTime","throttleTime","mouseWheelOpt","hooksFn","registerHooks","wheelHandler","wheelStartHandler","getWheelDelta","wheelMoveHandler","wheelEndDetector","cleanCache","alterOptions","mousewheelStart","deltaCache","cachedDelta","mousewheelMove","getEaseTime","mousewheelEnd","wheelDeltaX","wheelDeltaY","deltaMode","wheelDelta","detail","hasVerticalScroll","hasHorizontalScroll","SAFE_EASETIME","hooksName","handlerFn","ObserveDOM","stopObserver","handleMutationObserver","MutationObserver","timer_1","observer","mutations","mutationObserverHandler","startObserve","checkDOMUpdate","stopObserve","shouldNotRefresh","immediateRefresh","deferredRefresh","mutation","config","attributes","childList","subtree","observe","outsideBoundaries","oldWidth","oldHeight","check","newWidth","newHeight","disconnect","sourcePrefix$6","propertiesMap$6","propertiesConfig$6","PULLING_DOWN_EVENT","ENTER_THRESHOLD_EVENT","LEAVE_THRESHOLD_EVENT","PullDown","pulling","thresholdBoundary","setPulling","status","setThresholdBoundary","pullDownRefresh","watch","threshold","currentMinScrollY","cachedOriginanMinScrollY","finishPullDown","hasMouseWheelPlugin","mouseWheelOptions","SANE_DISCRETE_TIME","SANE_EASE_TIME","watching","checkPullDown","resetStateBeforeScrollStart","checkLocationOfThresholdBoundary","isFetchingStatus","scroll_1","enteredThresholdBoundary","locateInsideThresholdBoundary","leftThresholdBoundary","unwatch","modifyBehaviorYBoundary","stopDistance","openPullDown","closePullDown","autoPullDownRefresh","sourcePrefix$5","propertiesMap$5","propertiesConfig$5","PULL_UP_HOOKS_NAME","PullUp","pullUpLoad","finishPullUp","checkPullUp","movingDirectionY","maxScrollY","openPullUp","closePullUp","autoPullUpLoad","NEGATIVE_VALUE","outOfBoundaryPos","EventHandler","indicator","registerEvents","startEvents","moveEvents","endEvents","startEventRegister","indicatorEl","moveEventRegister","endEventRegister","BScrollIsDisabled","lastPoint","keysMap","touchStart","pointPos","touchMove","Indicator$1","Indicator","getKeysMap","handleFade","fade","opacity","interactive","scrollbarTrackClickable","scrollHooks","translaterHooks","animaterHooks","hasScrollKey","eventHandler","eventHandlerHooks","startHandler","moveHandler","endHandler","bindClick","clickEventRegister","calculateclickOffsetPos","scrollbarTrackOffsetTime","poinKey","domRectKey","domRect","scrollbarTrackOffsetType","clickPointOffset","scrollToWhere","scrollInfo","baseSize","scrollerSize","translateProperty","visible","fadeInTime","fadeOutTime","canScroll","wrapperSizeKey","scrollerSizeKey","maxScrollPosKey","refreshScrollInfo","display","indicatorElSize","minSize","isCustom","maxIndicatorScrollPos","sizeRatio","caculatePosAndSize","refreshStyle","posKey","translatePropertyKey","sizeKey","moved","indicatorNotMoved","syncBScroll","notMoved","minScrollY","maxScrollX","minScrollX","ScrollBar","createIndicators","indicators","scrollbar","customElements","indicatorOptions","scrollDirectionConfigKeys","indicatorDirections","customScrollbarEls","customElement","shift","scrollbarWrapper","createScrollbarElement","scrollbarWrapperEl","scrollbarIndicatorEl","cssText","PagesMatrix","wrapperWidth","wrapperHeight","scrollerHeight","scrollerWidth","pages","buildPagesMatrix","pageLengthOfX","pageLengthOfY","getPageStats","getNearestPageIndex","l","cx","cy","stepX","stepY","BASE_PAGE","SlidePages","slideOptions","slideX","slideY","currentPage","pagesMatrix","checkSlideLoop","getAdjustedCurrentPage","loopX","loopY","setCurrentPage","newPage","getInternalPage","getInitialPage","showFirstPage","firstInitialised","startPageXIndex","startPageYIndex","firstPageX","firstPageY","getExposedPage","page","exposedPage","fixedPage","getExposedPageByPageIndex","pageIndexX","pageIndexY","getWillChangedPage","realPageLen","pageIndex","unshift","getValidPageIndex","lastX","lastY","firstX","firstY","nextPageIndex","getPageIndexByDirection","prevPageIndex","getNearestPage","getPageByDirection","resetLoopPage","wannaLoop","loop","sourcePrefix$4","propertiesMap$4","propertiesConfig$4","samePage","p1","p2","Slide","cachedClonedPageDOM","resetLooping","autoplayTimer","satisfyInitialization","willChangeToPage","createPages","slide","listenFlick","autoplay","handleLoop","prevSlideContent","slideContent","currentSlidePagesLength","resetLoopChangedStatus","removeClonedSlidePage","cloneFirstAndLastSlidePage","initialised","moreToOnePageInLoop","oneToMorePagesInLoop","scrollerHooks","prevContent","pausePlay","modifyCurrentPage","startPlay","refreshHandler","setSlideInlineStyle","modifyScrollMetaHandler","scrollHandler","flickHandler","styleConfigurations","sizeType","styleType","slideWrapper","scrollOptions","length_1","slidePageDOM","goTo","goToPage","getCurrentPage","nearestPage","satisfyThreshold","satisfied","thresholdX","thresholdY","computeThreshold","initPage","preprendDOM","cloneNode","appendDOM","slidePages","prevExposedPageX","prevExposedPageY","currentExposedPageX","currentExposedPageY","pageWillChangeTo","slidePageChanged","changePage","scrollEasing","currentPosX","startPosX","currentPosY","startPosY","scrollMeta","changeToPage","slideWillChange","sourcePrefix$3","propertiesMap$3","propertiesConfig$3","WHEEL_INDEX_CHANGED_EVENT_NAME","CONSTANTS","Wheel","refreshBoundary","setSelectedIndex","selectedIndex","wheel","wheelWrapperClass","wheelItemClass","rotate","adjustTime","wheelDisabledItemClass","findNearestValidWheel","isAdjustingPosition","items","rotateX","wheelTo","itemHeight","checkWheelAllDisabled","validWheel","prevSelectedIndex","getSelectedIndex","restorePosition","isPending","deg","SafeDeg","toFixed","currentIndex","cacheIndex","wheelDisabledItemClassName","wheelItemsAllDisabled","sourcePrefix$2","propertiesMap$2","propertiesConfig$2","TWO_FINGERS","RAW_SCALE","Zoom","scale","prevScale","tryInitialZoomTo","zoomOpt","zoomTo","resolveOrigin","originX","originY","origin","baseScale","_doZoomTo","zoom","initialOrigin","minimalZoomDistance","setTransformOrigin","numberOfFingers","fingersOperation","zoomStart","zoomEnd","resetBoundaries","amounts","useCurrentPos","fromScale","toScale","zooming","startTime_1","endTime_1","scheduler_1","ratio","currentScale","_zoomTo","setScale","getNewPos","resolveFormula","center","firstFinger","secondFinger","startDistance","getFingerDistance","startScale","beforeZoomStart","currentDistance","zoomed","endScale","dampingScale","shouldRebound","pow","scrollBehaviorPairs","behavior","lastScale","shouldInBoundary","BScrollFamily","ancestors","descendants","hooksManager","analyzed","selfScroll","hasAncestors","bscrollFamily","hasDescendants","addAncestor","addDescendant","removeAncestor","removeDescendant","hook","setAnalyzed","flag","purge","sourcePrefix$1","propertiesMap$1","propertiesConfig$1","DEFAUL_GROUP_ID","forceScrollStopHandler","scrolls","enableScrollHander","disableScrollHander","currentScroll","syncTouchstartData","isOutOfBoundary","movingDirectionX","outOfLeftBoundary","outOfRightBoundary","outOfTopBoundary","outOfBottomBoundary","isResettingPosition","resetPositionHandler","calculateDistance","childNode","parent","NestedScroll","groupId","instance","instancesMap","store","getAllNestedScrolls","purgeAllNestedScrolls","nestedScrolls","ns","purgeNestedScroll","nestedScroll","groupIdType","addBScroll","buildBScrollGraph","analyzeBScrollGraph","ensureEventInvokeSequence","deleteScroll","bf1","bf2","wrapper1","wrapper2","contains","beforeScrollStartHandler","ancestorScrolls","descendantScrolls","touchEndHandler","selfActionsHooks","parentScroll","otherAncestorScrolls","isTopScroll","copied","sequencedScroll","PRE_NUM","POST_NUM","IndexCalculator","tombstoneHeight","lastDirection","lastPos","calculate","list","getDirection","calculateIndex","tombstone","ListItem","data","dom","DataManager","fetchFn","onFetchFinish","loadedNum","fetching","hasMore","update","addEmptyData","checkToFetch","add","fetch","newData","currentEnd","getList","Tombstone","cached","initialed","getSize","isTombstone","classList","getOne","tombstoneStyle","recycle","tombstones","tombstones_1","recycleOne","ANIMATION_DURATION_MS","DomManager","renderFn","unusedDom","timers","collectUnusedDom","createDom","cacheHeight","positionDom","startDelta","endPos","tombstoneEles","getStartPos","timerId","i_1","originPos","removeTombstone","querySelectorAll","EXTRA_SCROLL_Y","InfinityScroll","render","createTombstoneFn","createTombstone","indexCalculator","domManager","dataManager","modifyBoundary","infinityOptions","infinity","updateDom","sourcePrefix","propertiesMap","Movable","putAt","resolvePostion","isImageTag","ObserveImage","refreshTimer","observeImage","bindEventsToWrapper","debounceTime","imageLoadEventRegister","load","imageErrorEventRegister","resolveRatioOption","ratioConfig","ratioX","ratioY","handleBubbleAndCancelable","handleDOM","handleInteractive","relationElement","relationElementHandleElementIndex","maxBScrollX","maxBScrollY","indicatorWidth","indicatorHeight","translateXSign","translateYSign","lastPointX","lastPointY","getBScrollPosByRatio","currentX","currentY","BScrollMinScrollX","BScrollMaxScrollX","BScrollMinScrollY","BScrollMaxScrollY","newPosX","roundX","newPosY","roundY","xNotMoved","yNotMoved","BScrollPos","newIndicatorPos","getIndicatorPosByRatio","applyTransformProperty","transformProperties","Indicators","UserIndicatorsOptions","isArray","UserIndicatorsOptions_1","ObserveDom","PullDownRefresh","PullUpLoad"],"mappings":"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","sourcesContent":["/*!\n * better-scroll / better-scroll\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nvar propertiesConfig$7 = [\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.currentPos',\r\n        key: 'x'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.currentPos',\r\n        key: 'y'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.hasScroll',\r\n        key: 'hasHorizontalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.hasScroll',\r\n        key: 'hasVerticalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.contentSize',\r\n        key: 'scrollerWidth'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.contentSize',\r\n        key: 'scrollerHeight'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\r\n        key: 'maxScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\r\n        key: 'maxScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\r\n        key: 'minScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\r\n        key: 'minScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.movingDirection',\r\n        key: 'movingDirectionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.movingDirection',\r\n        key: 'movingDirectionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.direction',\r\n        key: 'directionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.direction',\r\n        key: 'directionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.actions.enabled',\r\n        key: 'enabled'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.pending',\r\n        key: 'pending'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.stop',\r\n        key: 'stop'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollTo',\r\n        key: 'scrollTo'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBy',\r\n        key: 'scrollBy'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollToElement',\r\n        key: 'scrollToElement'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.resetPosition',\r\n        key: 'resetPosition'\r\n    }\r\n];\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\r\nfunction assert(condition, msg) {\r\n    if (!condition) {\r\n        throw new Error('[BScroll] ' + msg);\r\n    }\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\nvar isIOSBadVersion = (function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n})();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nfunction getNow() {\r\n    return window.performance &&\r\n        window.performance.now &&\r\n        window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\r\nfunction isUndef(v) {\r\n    return v === undefined || v === null;\r\n}\r\nfunction getDistance(x, y) {\r\n    return Math.sqrt(x * x + y * y);\r\n}\r\nfunction between(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\r\nfunction findIndex(ary, fn) {\r\n    if (ary.findIndex) {\r\n        return ary.findIndex(fn);\r\n    }\r\n    var index = -1;\r\n    ary.some(function (item, i, ary) {\r\n        var ret = fn(item, i, ary);\r\n        if (ret) {\r\n            index = i;\r\n            return ret;\r\n        }\r\n    });\r\n    return index;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction getElement(el) {\r\n    return (typeof el === 'string'\r\n        ? document.querySelector(el)\r\n        : el);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nfunction offset(el) {\r\n    var left = 0;\r\n    var top = 0;\r\n    while (el) {\r\n        left -= el.offsetLeft;\r\n        top -= el.offsetTop;\r\n        el = el.offsetParent;\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top,\r\n    };\r\n}\r\nfunction offsetToBody(el) {\r\n    var rect = el.getBoundingClientRect();\r\n    return {\r\n        left: -(rect.left + window.pageXOffset),\r\n        top: -(rect.top + window.pageYOffset),\r\n    };\r\n}\r\nvar cssVendor = vendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\n// fix issue #361\r\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\r\nvar hasTransition = inBrowser && transition in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n};\r\nvar eventTypeMap = {\r\n    touchstart: 1,\r\n    touchmove: 1,\r\n    touchend: 1,\r\n    touchcancel: 1,\r\n    mousedown: 2,\r\n    mousemove: 2,\r\n    mouseup: 2,\r\n};\r\nfunction getRect(el) {\r\n    /* istanbul ignore if  */\r\n    if (el instanceof window.SVGElement) {\r\n        var rect = el.getBoundingClientRect();\r\n        return {\r\n            top: rect.top,\r\n            left: rect.left,\r\n            width: rect.width,\r\n            height: rect.height,\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            top: el.offsetTop,\r\n            left: el.offsetLeft,\r\n            width: el.offsetWidth,\r\n            height: el.offsetHeight,\r\n        };\r\n    }\r\n}\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar tagExceptionFn = preventDefaultExceptionFn;\r\nfunction tap(e, eventName) {\r\n    var ev = document.createEvent('Event');\r\n    ev.initEvent(eventName, true, true);\r\n    ev.pageX = e.pageX;\r\n    ev.pageY = e.pageY;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction click(e, event) {\r\n    if (event === void 0) { event = 'click'; }\r\n    var eventSource;\r\n    if (e.type === 'mouseup') {\r\n        eventSource = e;\r\n    }\r\n    else if (e.type === 'touchend' || e.type === 'touchcancel') {\r\n        eventSource = e.changedTouches[0];\r\n    }\r\n    var posSrc = {};\r\n    if (eventSource) {\r\n        posSrc.screenX = eventSource.screenX || 0;\r\n        posSrc.screenY = eventSource.screenY || 0;\r\n        posSrc.clientX = eventSource.clientX || 0;\r\n        posSrc.clientY = eventSource.clientY || 0;\r\n    }\r\n    var ev;\r\n    var bubbles = true;\r\n    var cancelable = true;\r\n    var ctrlKey = e.ctrlKey, shiftKey = e.shiftKey, altKey = e.altKey, metaKey = e.metaKey;\r\n    var pressedKeysMap = {\r\n        ctrlKey: ctrlKey,\r\n        shiftKey: shiftKey,\r\n        altKey: altKey,\r\n        metaKey: metaKey,\r\n    };\r\n    if (typeof MouseEvent !== 'undefined') {\r\n        try {\r\n            ev = new MouseEvent(event, extend(__assign({ bubbles: bubbles,\r\n                cancelable: cancelable }, pressedKeysMap), posSrc));\r\n        }\r\n        catch (e) {\r\n            /* istanbul ignore next */\r\n            createEvent();\r\n        }\r\n    }\r\n    else {\r\n        createEvent();\r\n    }\r\n    function createEvent() {\r\n        ev = document.createEvent('Event');\r\n        ev.initEvent(event, bubbles, cancelable);\r\n        extend(ev, posSrc);\r\n    }\r\n    // forwardedTouchEvent set to true in case of the conflict with fastclick\r\n    ev.forwardedTouchEvent = true;\r\n    ev._constructed = true;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction dblclick(e) {\r\n    click(e, 'dblclick');\r\n}\r\nfunction prepend(el, target) {\r\n    var firstChild = target.firstChild;\r\n    if (firstChild) {\r\n        before(el, firstChild);\r\n    }\r\n    else {\r\n        target.appendChild(el);\r\n    }\r\n}\r\nfunction before(el, target) {\r\n    var parentNode = target.parentNode;\r\n    parentNode.insertBefore(el, target);\r\n}\r\nfunction removeChild(el, child) {\r\n    el.removeChild(child);\r\n}\r\nfunction hasClass(el, className) {\r\n    var reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)');\r\n    return reg.test(el.className);\r\n}\r\nfunction HTMLCollectionToArray(el) {\r\n    return Array.prototype.slice.call(el, 0);\r\n}\r\nfunction getClientSize(el) {\r\n    return {\r\n        width: el.clientWidth,\r\n        height: el.clientHeight,\r\n    };\r\n}\n\nvar ease = {\r\n    // easeOutQuint\r\n    swipe: {\r\n        style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n        fn: function (t) {\r\n            return 1 + --t * t * t * t * t;\r\n        }\r\n    },\r\n    // easeOutQuard\r\n    swipeBounce: {\r\n        style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n        fn: function (t) {\r\n            return t * (2 - t);\r\n        }\r\n    },\r\n    // easeOutQuart\r\n    bounce: {\r\n        style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n        fn: function (t) {\r\n            return 1 - --t * t * t * t;\r\n        }\r\n    }\r\n};\n\nvar DEFAULT_INTERVAL = 1000 / 60;\r\nvar windowCompat = inBrowser && window;\r\n/* istanbul ignore next */\r\nfunction noop$1() { }\r\nvar requestAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.requestAnimationFrame ||\r\n        windowCompat.webkitRequestAnimationFrame ||\r\n        windowCompat.mozRequestAnimationFrame ||\r\n        windowCompat.oRequestAnimationFrame ||\r\n        // if all else fails, use setTimeout\r\n        function (callback) {\r\n            return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\r\n        });\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.cancelAnimationFrame ||\r\n        windowCompat.webkitCancelAnimationFrame ||\r\n        windowCompat.mozCancelAnimationFrame ||\r\n        windowCompat.oCancelAnimationFrame ||\r\n        function (id) {\r\n            window.clearTimeout(id);\r\n        });\r\n})();\n\n/* istanbul ignore next */\r\nvar noop = function (val) { };\r\nvar sharedPropertyDefinition = {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: noop,\r\n    set: noop,\r\n};\r\nvar getProperty = function (obj, key) {\r\n    var keys = key.split('.');\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        obj = obj[keys[i]];\r\n        if (typeof obj !== 'object' || !obj)\r\n            return;\r\n    }\r\n    var lastKey = keys.pop();\r\n    if (typeof obj[lastKey] === 'function') {\r\n        return function () {\r\n            return obj[lastKey].apply(obj, arguments);\r\n        };\r\n    }\r\n    else {\r\n        return obj[lastKey];\r\n    }\r\n};\r\nvar setProperty = function (obj, key, value) {\r\n    var keys = key.split('.');\r\n    var temp;\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        temp = keys[i];\r\n        if (!obj[temp])\r\n            obj[temp] = {};\r\n        obj = obj[temp];\r\n    }\r\n    obj[keys.pop()] = value;\r\n};\r\nfunction propertiesProxy(target, sourceKey, key) {\r\n    sharedPropertyDefinition.get = function proxyGetter() {\r\n        return getProperty(this, sourceKey);\r\n    };\r\n    sharedPropertyDefinition.set = function proxySetter(val) {\r\n        setProperty(this, sourceKey, val);\r\n    };\r\n    Object.defineProperty(target, key, sharedPropertyDefinition);\r\n}\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            var ret = fn.apply(context, args);\r\n            if (ret === true) {\r\n                return ret;\r\n            }\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = __spreadArrays(events);\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar CustomOptions = /** @class */ (function () {\r\n    function CustomOptions() {\r\n    }\r\n    return CustomOptions;\r\n}());\r\nvar OptionsConstructor = /** @class */ (function (_super) {\r\n    __extends(OptionsConstructor, _super);\r\n    function OptionsConstructor() {\r\n        var _this = _super.call(this) || this;\r\n        _this.startX = 0;\r\n        _this.startY = 0;\r\n        _this.scrollX = false;\r\n        _this.scrollY = true;\r\n        _this.freeScroll = false;\r\n        _this.directionLockThreshold = 0;\r\n        _this.eventPassthrough = \"\" /* None */;\r\n        _this.click = false;\r\n        _this.dblclick = false;\r\n        _this.tap = '';\r\n        _this.bounce = {\r\n            top: true,\r\n            bottom: true,\r\n            left: true,\r\n            right: true,\r\n        };\r\n        _this.bounceTime = 800;\r\n        _this.momentum = true;\r\n        _this.momentumLimitTime = 300;\r\n        _this.momentumLimitDistance = 15;\r\n        _this.swipeTime = 2500;\r\n        _this.swipeBounceTime = 500;\r\n        _this.deceleration = 0.0015;\r\n        _this.flickLimitTime = 200;\r\n        _this.flickLimitDistance = 100;\r\n        _this.resizePolling = 60;\r\n        _this.probeType = 0 /* Default */;\r\n        _this.stopPropagation = false;\r\n        _this.preventDefault = true;\r\n        _this.preventDefaultException = {\r\n            tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/,\r\n        };\r\n        _this.tagException = {\r\n            tagName: /^TEXTAREA$/,\r\n        };\r\n        _this.HWCompositing = true;\r\n        _this.useTransition = true;\r\n        _this.bindToWrapper = false;\r\n        _this.bindToTarget = false;\r\n        _this.disableMouse = hasTouch;\r\n        _this.disableTouch = !hasTouch;\r\n        _this.autoBlur = true;\r\n        _this.autoEndDistance = 5;\r\n        _this.outOfBoundaryDampingFactor = 1 / 3;\r\n        _this.specifiedIndexAsContent = 0;\r\n        _this.quadrant = 1 /* First */;\r\n        return _this;\r\n    }\r\n    OptionsConstructor.prototype.merge = function (options) {\r\n        if (!options)\r\n            return this;\r\n        for (var key in options) {\r\n            if (key === 'bounce') {\r\n                this.bounce = this.resolveBounce(options[key]);\r\n                continue;\r\n            }\r\n            this[key] = options[key];\r\n        }\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.process = function () {\r\n        this.translateZ =\r\n            this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\r\n        this.useTransition = this.useTransition && hasTransition;\r\n        this.preventDefault = !this.eventPassthrough && this.preventDefault;\r\n        // If you want eventPassthrough I have to lock one of the axes\r\n        this.scrollX =\r\n            this.eventPassthrough === \"horizontal\" /* Horizontal */\r\n                ? false\r\n                : this.scrollX;\r\n        this.scrollY =\r\n            this.eventPassthrough === \"vertical\" /* Vertical */ ? false : this.scrollY;\r\n        // With eventPassthrough we also need lockDirection mechanism\r\n        this.freeScroll = this.freeScroll && !this.eventPassthrough;\r\n        // force true when freeScroll is true\r\n        this.scrollX = this.freeScroll ? true : this.scrollX;\r\n        this.scrollY = this.freeScroll ? true : this.scrollY;\r\n        this.directionLockThreshold = this.eventPassthrough\r\n            ? 0\r\n            : this.directionLockThreshold;\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\r\n        var DEFAULT_BOUNCE = {\r\n            top: true,\r\n            right: true,\r\n            bottom: true,\r\n            left: true,\r\n        };\r\n        var NEGATED_BOUNCE = {\r\n            top: false,\r\n            right: false,\r\n            bottom: false,\r\n            left: false,\r\n        };\r\n        var ret;\r\n        if (typeof bounceOptions === 'object') {\r\n            ret = extend(DEFAULT_BOUNCE, bounceOptions);\r\n        }\r\n        else {\r\n            ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\r\n        }\r\n        return ret;\r\n    };\r\n    return OptionsConstructor;\r\n}(CustomOptions));\n\nvar ActionsHandler = /** @class */ (function () {\r\n    function ActionsHandler(wrapper, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'start',\r\n            'move',\r\n            'end',\r\n            'click',\r\n        ]);\r\n        this.handleDOMEvents();\r\n    }\r\n    ActionsHandler.prototype.handleDOMEvents = function () {\r\n        var _a = this.options, bindToWrapper = _a.bindToWrapper, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch, click = _a.click;\r\n        var wrapper = this.wrapper;\r\n        var target = bindToWrapper ? wrapper : window;\r\n        var wrapperEvents = [];\r\n        var targetEvents = [];\r\n        var shouldRegisterTouch = !disableTouch;\r\n        var shouldRegisterMouse = !disableMouse;\r\n        if (click) {\r\n            wrapperEvents.push({\r\n                name: 'click',\r\n                handler: this.click.bind(this),\r\n                capture: true,\r\n            });\r\n        }\r\n        if (shouldRegisterTouch) {\r\n            wrapperEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (shouldRegisterMouse) {\r\n            wrapperEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\r\n        this.targetEventRegister = new EventRegister(target, targetEvents);\r\n    };\r\n    ActionsHandler.prototype.beforeHandler = function (e, type) {\r\n        var _a = this.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        var preventDefaultConditions = {\r\n            start: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            end: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            move: function () {\r\n                return preventDefault;\r\n            },\r\n        };\r\n        if (preventDefaultConditions[type]()) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.setInitiated = function (type) {\r\n        if (type === void 0) { type = 0; }\r\n        this.initiated = type;\r\n    };\r\n    ActionsHandler.prototype.start = function (e) {\r\n        var _eventType = eventTypeMap[e.type];\r\n        if (this.initiated && this.initiated !== _eventType) {\r\n            return;\r\n        }\r\n        this.setInitiated(_eventType);\r\n        // if textarea or other html tags in options.tagException is manipulated\r\n        // do not make bs scroll\r\n        if (tagExceptionFn(e.target, this.options.tagException)) {\r\n            this.setInitiated();\r\n            return;\r\n        }\r\n        // only allow mouse left button\r\n        if (_eventType === 2 /* Mouse */ && e.button !== 0 /* Left */)\r\n            return;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'start');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ActionsHandler.prototype.move = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'move');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var deltaX = point.pageX - this.pointX;\r\n        var deltaY = point.pageY - this.pointY;\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.move, {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY,\r\n            e: e,\r\n        })) {\r\n            return;\r\n        }\r\n        // auto end when out of viewport\r\n        var scrollLeft = document.documentElement.scrollLeft ||\r\n            window.pageXOffset ||\r\n            document.body.scrollLeft;\r\n        var scrollTop = document.documentElement.scrollTop ||\r\n            window.pageYOffset ||\r\n            document.body.scrollTop;\r\n        var pX = this.pointX - scrollLeft;\r\n        var pY = this.pointY - scrollTop;\r\n        var autoEndDistance = this.options.autoEndDistance;\r\n        if (pX > document.documentElement.clientWidth - autoEndDistance ||\r\n            pY > document.documentElement.clientHeight - autoEndDistance ||\r\n            pX < autoEndDistance ||\r\n            pY < autoEndDistance) {\r\n            this.end(e);\r\n        }\r\n    };\r\n    ActionsHandler.prototype.end = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.setInitiated();\r\n        this.beforeHandler(e, 'end');\r\n        this.hooks.trigger(this.hooks.eventTypes.end, e);\r\n    };\r\n    ActionsHandler.prototype.click = function (e) {\r\n        this.hooks.trigger(this.hooks.eventTypes.click, e);\r\n    };\r\n    ActionsHandler.prototype.setContent = function (content) {\r\n        if (content !== this.wrapper) {\r\n            this.wrapper = content;\r\n            this.rebindDOMEvents();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.rebindDOMEvents = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.handleDOMEvents();\r\n    };\r\n    ActionsHandler.prototype.destroy = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.hooks.destroy();\r\n    };\r\n    return ActionsHandler;\r\n}());\n\nvar translaterMetaData = {\r\n    x: ['translateX', 'px'],\r\n    y: ['translateY', 'px'],\r\n};\r\nvar Translater = /** @class */ (function () {\r\n    function Translater(content) {\r\n        this.setContent(content);\r\n        this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\r\n    }\r\n    Translater.prototype.getComputedPosition = function () {\r\n        var cssStyle = window.getComputedStyle(this.content, null);\r\n        var matrix = cssStyle[style.transform].split(')')[0].split(', ');\r\n        var x = +(matrix[12] || matrix[4]) || 0;\r\n        var y = +(matrix[13] || matrix[5]) || 0;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    Translater.prototype.translate = function (point) {\r\n        var transformStyle = [];\r\n        Object.keys(point).forEach(function (key) {\r\n            if (!translaterMetaData[key]) {\r\n                return;\r\n            }\r\n            var transformFnName = translaterMetaData[key][0];\r\n            if (transformFnName) {\r\n                var transformFnArgUnit = translaterMetaData[key][1];\r\n                var transformFnArg = point[key];\r\n                transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\r\n            }\r\n        });\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\r\n        this.style[style.transform] = transformStyle.join(' ');\r\n        this.hooks.trigger(this.hooks.eventTypes.translate, point);\r\n    };\r\n    Translater.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n        }\r\n    };\r\n    Translater.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Translater;\r\n}());\n\nvar Base = /** @class */ (function () {\r\n    function Base(content, translater, options) {\r\n        this.translater = translater;\r\n        this.options = options;\r\n        this.timer = 0;\r\n        this.hooks = new EventEmitter([\r\n            'move',\r\n            'end',\r\n            'beforeForceStop',\r\n            'forceStop',\r\n            'callStop',\r\n            'time',\r\n            'timeFunction',\r\n        ]);\r\n        this.setContent(content);\r\n    }\r\n    Base.prototype.translate = function (endPoint) {\r\n        this.translater.translate(endPoint);\r\n    };\r\n    Base.prototype.setPending = function (pending) {\r\n        this.pending = pending;\r\n    };\r\n    Base.prototype.setForceStopped = function (forceStopped) {\r\n        this.forceStopped = forceStopped;\r\n    };\r\n    Base.prototype.setCallStop = function (called) {\r\n        this.callStopWhenPending = called;\r\n    };\r\n    Base.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n            this.stop();\r\n        }\r\n    };\r\n    Base.prototype.clearTimer = function () {\r\n        if (this.timer) {\r\n            cancelAnimationFrame(this.timer);\r\n            this.timer = 0;\r\n        }\r\n    };\r\n    Base.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n        cancelAnimationFrame(this.timer);\r\n    };\r\n    return Base;\r\n}());\n\n// iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\r\n// when bs use transition mode\r\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\r\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\r\n// it is weird\r\n// so we should validate position caculated by 'window.getComputedStyle'\r\nvar isValidPostion = function (startPoint, endPoint, currentPos, prePos) {\r\n    var computeDirection = function (endValue, startValue) {\r\n        var delta = endValue - startValue;\r\n        var direction = delta > 0\r\n            ? -1 /* Negative */\r\n            : delta < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return direction;\r\n    };\r\n    var directionX = computeDirection(endPoint.x, startPoint.x);\r\n    var directionY = computeDirection(endPoint.y, startPoint.y);\r\n    var deltaX = currentPos.x - prePos.x;\r\n    var deltaY = currentPos.y - prePos.y;\r\n    return directionX * deltaX <= 0 && directionY * deltaY <= 0;\r\n};\n\nvar Transition = /** @class */ (function (_super) {\r\n    __extends(Transition, _super);\r\n    function Transition() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Transition.prototype.startProbe = function (startPoint, endPoint) {\r\n        var _this = this;\r\n        var prePos = startPoint;\r\n        var probe = function () {\r\n            var pos = _this.translater.getComputedPosition();\r\n            if (isValidPostion(startPoint, endPoint, pos, prePos)) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // transition ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\r\n                }\r\n            }\r\n            prePos = pos;\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(probe);\r\n            }\r\n        };\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        probe();\r\n    };\r\n    Transition.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.style[style.transitionDuration] = time + 'ms';\r\n        this.hooks.trigger(this.hooks.eventTypes.time, time);\r\n    };\r\n    Transition.prototype.transitionTimingFunction = function (easing) {\r\n        this.style[style.transitionTimingFunction] = easing;\r\n        this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\r\n    };\r\n    Transition.prototype.transitionProperty = function () {\r\n        this.style[style.transitionProperty] = style.transform;\r\n    };\r\n    Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        this.setPending(time > 0);\r\n        this.transitionTimingFunction(easingFn);\r\n        this.transitionProperty();\r\n        this.transitionTime(time);\r\n        this.translate(endPoint);\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        if (time && isRealtimeProbeType) {\r\n            this.startProbe(startPoint, endPoint);\r\n        }\r\n        // if we change content's transformY in a tick\r\n        // such as: 0 -> 50px -> 0\r\n        // transitionend will not be triggered\r\n        // so we forceupdate by reflow\r\n        if (!time) {\r\n            this._reflow = this.content.offsetHeight;\r\n            if (isRealtimeProbeType) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n        }\r\n    };\r\n    Transition.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in transition\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var _a = this.translater.getComputedPosition(), x = _a.x, y = _a.y;\r\n            this.transitionTime();\r\n            this.translate({ x: x, y: y });\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, { x: x, y: y });\r\n        }\r\n        return pending;\r\n    };\r\n    Transition.prototype.stop = function () {\r\n        var stopFromTransition = this.doStop();\r\n        if (stopFromTransition) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Transition;\r\n}(Base));\n\nvar Animation = /** @class */ (function (_super) {\r\n    __extends(Animation, _super);\r\n    function Animation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        // time is 0\r\n        if (!time) {\r\n            this.translate(endPoint);\r\n            if (this.options.probeType === 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n            return;\r\n        }\r\n        this.animate(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\r\n        var _this = this;\r\n        var startTime = getNow();\r\n        var destTime = startTime + duration;\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        var step = function () {\r\n            var now = getNow();\r\n            // js animation end\r\n            if (now >= destTime) {\r\n                _this.translate(endPoint);\r\n                if (isRealtimeProbeType) {\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\r\n                }\r\n                _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                return;\r\n            }\r\n            now = (now - startTime) / duration;\r\n            var easing = easingFn(now);\r\n            var newPoint = {};\r\n            Object.keys(endPoint).forEach(function (key) {\r\n                var startValue = startPoint[key];\r\n                var endValue = endPoint[key];\r\n                newPoint[key] = (endValue - startValue) * easing + startValue;\r\n            });\r\n            _this.translate(newPoint);\r\n            if (isRealtimeProbeType) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\r\n            }\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(step);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // raf ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                }\r\n            }\r\n        };\r\n        this.setPending(true);\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        step();\r\n    };\r\n    Animation.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in requestFrameAnimation\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var pos = this.translater.getComputedPosition();\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\r\n        }\r\n        return pending;\r\n    };\r\n    Animation.prototype.stop = function () {\r\n        var stopFromAnimation = this.doStop();\r\n        if (stopFromAnimation) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Animation;\r\n}(Base));\n\nfunction createAnimater(element, translater, options) {\r\n    var useTransition = options.useTransition;\r\n    var animaterOptions = {};\r\n    Object.defineProperty(animaterOptions, 'probeType', {\r\n        enumerable: true,\r\n        configurable: false,\r\n        get: function () {\r\n            return options.probeType;\r\n        },\r\n    });\r\n    if (useTransition) {\r\n        return new Transition(element, translater, animaterOptions);\r\n    }\r\n    else {\r\n        return new Animation(element, translater, animaterOptions);\r\n    }\r\n}\n\nvar Behavior = /** @class */ (function () {\r\n    function Behavior(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeComputeBoundary',\r\n            'computeBoundary',\r\n            'momentum',\r\n            'end',\r\n            'ignoreHasScroll'\r\n        ]);\r\n        this.refresh(content);\r\n    }\r\n    Behavior.prototype.start = function () {\r\n        this.dist = 0;\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.move = function (delta) {\r\n        delta = this.hasScroll ? delta : 0;\r\n        this.setMovingDirection(delta);\r\n        return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\r\n    };\r\n    Behavior.prototype.setMovingDirection = function (delta) {\r\n        this.movingDirection =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.setDirection = function (delta) {\r\n        this.direction =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\r\n        var newPos = this.currentPos + delta;\r\n        // Slow down or stop if outside of the boundaries\r\n        if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\r\n            if ((newPos > this.minScrollPos && this.options.bounces[0]) ||\r\n                (newPos < this.maxScrollPos && this.options.bounces[1])) {\r\n                newPos = this.currentPos + delta * dampingFactor;\r\n            }\r\n            else {\r\n                newPos =\r\n                    newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\r\n            }\r\n        }\r\n        return newPos;\r\n    };\r\n    Behavior.prototype.end = function (duration) {\r\n        var momentumInfo = {\r\n            duration: 0\r\n        };\r\n        var absDist = Math.abs(this.currentPos - this.startPos);\r\n        // start momentum animation if needed\r\n        if (this.options.momentum &&\r\n            duration < this.options.momentumLimitTime &&\r\n            absDist > this.options.momentumLimitDistance) {\r\n            var wrapperSize = (this.direction === -1 /* Negative */ && this.options.bounces[0]) ||\r\n                (this.direction === 1 /* Positive */ && this.options.bounces[1])\r\n                ? this.wrapperSize\r\n                : 0;\r\n            momentumInfo = this.hasScroll\r\n                ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options)\r\n                : { destination: this.currentPos, duration: 0 };\r\n        }\r\n        else {\r\n            this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\r\n        }\r\n        return momentumInfo;\r\n    };\r\n    Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n        if (options === void 0) { options = this.options; }\r\n        var distance = current - start;\r\n        var speed = Math.abs(distance) / time;\r\n        var deceleration = options.deceleration, swipeBounceTime = options.swipeBounceTime, swipeTime = options.swipeTime;\r\n        var duration = Math.min(swipeTime, (speed * 2) / deceleration);\r\n        var momentumData = {\r\n            destination: current + ((speed * speed) / deceleration) * (distance < 0 ? -1 : 1),\r\n            duration: duration,\r\n            rate: 15\r\n        };\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n        if (momentumData.destination < lowerMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n                : lowerMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        else if (momentumData.destination > upperMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n                : upperMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        momentumData.destination = Math.round(momentumData.destination);\r\n        return momentumData;\r\n    };\r\n    Behavior.prototype.updateDirection = function () {\r\n        var absDist = this.currentPos - this.absStartPos;\r\n        this.setDirection(absDist);\r\n    };\r\n    Behavior.prototype.refresh = function (content) {\r\n        var _a = this.options.rect, size = _a.size, position = _a.position;\r\n        var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static';\r\n        // Force reflow\r\n        var wrapperRect = getRect(this.wrapper);\r\n        // use client is more fair than offset\r\n        this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\r\n        this.setContent(content);\r\n        var contentRect = getRect(this.content);\r\n        this.contentSize = contentRect[size];\r\n        this.relativeOffset = contentRect[position];\r\n        /* istanbul ignore if  */\r\n        if (isWrapperStatic) {\r\n            this.relativeOffset -= wrapperRect[position];\r\n        }\r\n        this.computeBoundary();\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.setContent = function (content) {\r\n        if (content !== this.content) {\r\n            this.content = content;\r\n            this.resetState();\r\n        }\r\n    };\r\n    Behavior.prototype.resetState = function () {\r\n        this.currentPos = 0;\r\n        this.startPos = 0;\r\n        this.dist = 0;\r\n        this.setDirection(0 /* Default */);\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.resetStartPos();\r\n    };\r\n    Behavior.prototype.computeBoundary = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\r\n        var boundary = {\r\n            minScrollPos: 0,\r\n            maxScrollPos: this.wrapperSize - this.contentSize\r\n        };\r\n        if (boundary.maxScrollPos < 0) {\r\n            boundary.maxScrollPos -= this.relativeOffset;\r\n            if (this.options.specifiedIndexAsContent === 0) {\r\n                boundary.minScrollPos = -this.relativeOffset;\r\n            }\r\n        }\r\n        this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\r\n        this.minScrollPos = boundary.minScrollPos;\r\n        this.maxScrollPos = boundary.maxScrollPos;\r\n        this.hasScroll =\r\n            this.options.scrollable && this.maxScrollPos < this.minScrollPos;\r\n        if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\r\n            this.maxScrollPos = this.minScrollPos;\r\n            this.contentSize = this.wrapperSize;\r\n        }\r\n    };\r\n    Behavior.prototype.updatePosition = function (pos) {\r\n        this.currentPos = pos;\r\n    };\r\n    Behavior.prototype.getCurrentPos = function () {\r\n        return this.currentPos;\r\n    };\r\n    Behavior.prototype.checkInBoundary = function () {\r\n        var position = this.adjustPosition(this.currentPos);\r\n        var inBoundary = position === this.getCurrentPos();\r\n        return {\r\n            position: position,\r\n            inBoundary: inBoundary\r\n        };\r\n    };\r\n    // adjust position when out of boundary\r\n    Behavior.prototype.adjustPosition = function (pos) {\r\n        if (!this.hasScroll &&\r\n            !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos > this.minScrollPos) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos < this.maxScrollPos) {\r\n            pos = this.maxScrollPos;\r\n        }\r\n        return pos;\r\n    };\r\n    Behavior.prototype.updateStartPos = function () {\r\n        this.startPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.updateAbsStartPos = function () {\r\n        this.absStartPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.resetStartPos = function () {\r\n        this.updateStartPos();\r\n        this.updateAbsStartPos();\r\n    };\r\n    Behavior.prototype.getAbsDist = function (delta) {\r\n        this.dist += delta;\r\n        return Math.abs(this.dist);\r\n    };\r\n    Behavior.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Behavior;\r\n}());\n\nvar _a, _b, _c, _d;\r\nvar PassthroughHandlers = (_a = {},\r\n    _a[\"yes\" /* Yes */] = function (e) {\r\n        return true;\r\n    },\r\n    _a[\"no\" /* No */] = function (e) {\r\n        e.preventDefault();\r\n        return false;\r\n    },\r\n    _a);\r\nvar DirectionMap = (_b = {},\r\n    _b[\"horizontal\" /* Horizontal */] = (_c = {},\r\n        _c[\"yes\" /* Yes */] = \"horizontal\" /* Horizontal */,\r\n        _c[\"no\" /* No */] = \"vertical\" /* Vertical */,\r\n        _c),\r\n    _b[\"vertical\" /* Vertical */] = (_d = {},\r\n        _d[\"yes\" /* Yes */] = \"vertical\" /* Vertical */,\r\n        _d[\"no\" /* No */] = \"horizontal\" /* Horizontal */,\r\n        _d),\r\n    _b);\r\nvar DirectionLockAction = /** @class */ (function () {\r\n    function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\r\n        this.directionLockThreshold = directionLockThreshold;\r\n        this.freeScroll = freeScroll;\r\n        this.eventPassthrough = eventPassthrough;\r\n        this.reset();\r\n    }\r\n    DirectionLockAction.prototype.reset = function () {\r\n        this.directionLocked = \"\" /* Default */;\r\n    };\r\n    DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\r\n        this.computeDirectionLock(absDistX, absDistY);\r\n        return this.handleEventPassthrough(e);\r\n    };\r\n    DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\r\n        if (this.directionLocked === \"horizontal\" /* Horizontal */) {\r\n            deltaY = 0;\r\n        }\r\n        else if (this.directionLocked === \"vertical\" /* Vertical */) {\r\n            deltaX = 0;\r\n        }\r\n        return {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY\r\n        };\r\n    };\r\n    DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\r\n        // If you are scrolling in one direction, lock it\r\n        if (this.directionLocked === \"\" /* Default */ && !this.freeScroll) {\r\n            if (absDistX > absDistY + this.directionLockThreshold) {\r\n                this.directionLocked = \"horizontal\" /* Horizontal */; // lock horizontally\r\n            }\r\n            else if (absDistY >= absDistX + this.directionLockThreshold) {\r\n                this.directionLocked = \"vertical\" /* Vertical */; // lock vertically\r\n            }\r\n            else {\r\n                this.directionLocked = \"none\" /* None */; // no lock\r\n            }\r\n        }\r\n    };\r\n    DirectionLockAction.prototype.handleEventPassthrough = function (e) {\r\n        var handleMap = DirectionMap[this.directionLocked];\r\n        if (handleMap) {\r\n            if (this.eventPassthrough === handleMap[\"yes\" /* Yes */]) {\r\n                return PassthroughHandlers[\"yes\" /* Yes */](e);\r\n            }\r\n            else if (this.eventPassthrough === handleMap[\"no\" /* No */]) {\r\n                return PassthroughHandlers[\"no\" /* No */](e);\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return DirectionLockAction;\r\n}());\n\nvar applyQuadrantTransformation = function (deltaX, deltaY, quadrant) {\r\n    if (quadrant === 2 /* Second */) {\r\n        return [deltaY, -deltaX];\r\n    }\r\n    else if (quadrant === 3 /* Third */) {\r\n        return [-deltaX, -deltaY];\r\n    }\r\n    else if (quadrant === 4 /* Forth */) {\r\n        return [-deltaY, deltaX];\r\n    }\r\n    else {\r\n        return [deltaX, deltaY];\r\n    }\r\n};\r\nvar ScrollerActions = /** @class */ (function () {\r\n    function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\r\n        this.hooks = new EventEmitter([\r\n            'start',\r\n            'beforeMove',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'end',\r\n            'scrollEnd',\r\n            'contentNotMoved',\r\n            'detectMovingDirection',\r\n            'coordinateTransformation',\r\n        ]);\r\n        this.scrollBehaviorX = scrollBehaviorX;\r\n        this.scrollBehaviorY = scrollBehaviorY;\r\n        this.actionsHandler = actionsHandler;\r\n        this.animater = animater;\r\n        this.options = options;\r\n        this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\r\n        this.enabled = true;\r\n        this.bindActionsHandler();\r\n    }\r\n    ScrollerActions.prototype.bindActionsHandler = function () {\r\n        var _this = this;\r\n        // [mouse|touch]start event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleStart(e);\r\n        });\r\n        // [mouse|touch]move event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\r\n            var deltaX = _a.deltaX, deltaY = _a.deltaY, e = _a.e;\r\n            if (!_this.enabled)\r\n                return true;\r\n            var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant), transformateDeltaX = _b[0], transformateDeltaY = _b[1];\r\n            var transformateDeltaData = {\r\n                deltaX: transformateDeltaX,\r\n                deltaY: transformateDeltaY,\r\n            };\r\n            _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\r\n            return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\r\n        });\r\n        // [mouse|touch]end event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleEnd(e);\r\n        });\r\n        // click\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\r\n            // handle native click event\r\n            if (_this.enabled && !e._constructed) {\r\n                _this.handleClick(e);\r\n            }\r\n        });\r\n    };\r\n    ScrollerActions.prototype.handleStart = function (e) {\r\n        var timestamp = getNow();\r\n        this.fingerMoved = false;\r\n        this.contentMoved = false;\r\n        this.startTime = timestamp;\r\n        this.directionLockAction.reset();\r\n        this.scrollBehaviorX.start();\r\n        this.scrollBehaviorY.start();\r\n        // force stopping last transition or animation\r\n        this.animater.doStop();\r\n        this.scrollBehaviorX.resetStartPos();\r\n        this.scrollBehaviorY.resetStartPos();\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\r\n            return;\r\n        }\r\n        var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\r\n        var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\r\n        var timestamp = getNow();\r\n        // We need to move at least momentumLimitDistance pixels\r\n        // for the scrolling to initiate\r\n        if (this.checkMomentum(absDistX, absDistY, timestamp)) {\r\n            return true;\r\n        }\r\n        if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\r\n            this.actionsHandler.setInitiated();\r\n            return true;\r\n        }\r\n        var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\r\n        var prevX = this.scrollBehaviorX.getCurrentPos();\r\n        var newX = this.scrollBehaviorX.move(delta.deltaX);\r\n        var prevY = this.scrollBehaviorY.getCurrentPos();\r\n        var newY = this.scrollBehaviorY.move(delta.deltaY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\r\n            return;\r\n        }\r\n        if (!this.fingerMoved) {\r\n            this.fingerMoved = true;\r\n        }\r\n        var positionChanged = newX !== prevX || newY !== prevY;\r\n        if (!this.contentMoved && !positionChanged) {\r\n            this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\r\n        }\r\n        if (!this.contentMoved && positionChanged) {\r\n            this.contentMoved = true;\r\n            this.hooks.trigger(this.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.contentMoved && positionChanged) {\r\n            this.animater.translate({\r\n                x: newX,\r\n                y: newY,\r\n            });\r\n            this.dispatchScroll(timestamp);\r\n        }\r\n    };\r\n    ScrollerActions.prototype.dispatchScroll = function (timestamp) {\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > this.options.momentumLimitTime) {\r\n            // refresh time and starting position to initiate a momentum\r\n            this.startTime = timestamp;\r\n            this.scrollBehaviorX.updateStartPos();\r\n            this.scrollBehaviorY.updateStartPos();\r\n            if (this.options.probeType === 1 /* Throttle */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (this.options.probeType > 1 /* Throttle */) {\r\n            this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n        }\r\n    };\r\n    ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\r\n        return (timestamp - this.endTime > this.options.momentumLimitTime &&\r\n            absDistY < this.options.momentumLimitDistance &&\r\n            absDistX < this.options.momentumLimitDistance);\r\n    };\r\n    ScrollerActions.prototype.handleEnd = function (e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\r\n            return;\r\n        }\r\n        var currentPos = this.getCurrentPos();\r\n        this.scrollBehaviorX.updateDirection();\r\n        this.scrollBehaviorY.updateDirection();\r\n        if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\r\n            return true;\r\n        }\r\n        currentPos = this.ensureIntegerPos(currentPos);\r\n        this.animater.translate(currentPos);\r\n        this.endTime = getNow();\r\n        var duration = this.endTime - this.startTime;\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\r\n    };\r\n    ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\r\n        this.ensuringInteger = true;\r\n        var x = currentPos.x, y = currentPos.y;\r\n        var _a = this.scrollBehaviorX, minScrollPosX = _a.minScrollPos, maxScrollPosX = _a.maxScrollPos;\r\n        var _b = this.scrollBehaviorY, minScrollPosY = _b.minScrollPos, maxScrollPosY = _b.maxScrollPos;\r\n        x = x > 0 ? Math.ceil(x) : Math.floor(x);\r\n        y = y > 0 ? Math.ceil(y) : Math.floor(y);\r\n        x = between(x, maxScrollPosX, minScrollPosX);\r\n        y = between(y, maxScrollPosY, minScrollPosY);\r\n        return { x: x, y: y };\r\n    };\r\n    ScrollerActions.prototype.handleClick = function (e) {\r\n        if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ScrollerActions.prototype.getCurrentPos = function () {\r\n        return {\r\n            x: this.scrollBehaviorX.getCurrentPos(),\r\n            y: this.scrollBehaviorY.getCurrentPos(),\r\n        };\r\n    };\r\n    ScrollerActions.prototype.refresh = function () {\r\n        this.endTime = 0;\r\n    };\r\n    ScrollerActions.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return ScrollerActions;\r\n}());\n\nfunction createActionsHandlerOptions(bsOptions) {\r\n    var options = [\r\n        'click',\r\n        'bindToWrapper',\r\n        'disableMouse',\r\n        'disableTouch',\r\n        'preventDefault',\r\n        'stopPropagation',\r\n        'tagException',\r\n        'preventDefaultException',\r\n        'autoEndDistance',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    return options;\r\n}\r\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\r\n    var options = [\r\n        'momentum',\r\n        'momentumLimitTime',\r\n        'momentumLimitDistance',\r\n        'deceleration',\r\n        'swipeBounceTime',\r\n        'swipeTime',\r\n        'outOfBoundaryDampingFactor',\r\n        'specifiedIndexAsContent',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    // add extra property\r\n    options.scrollable = !!bsOptions[extraProp];\r\n    options.bounces = bounces;\r\n    options.rect = rect;\r\n    return options;\r\n}\n\nfunction bubbling(source, target, events) {\r\n    events.forEach(function (event) {\r\n        var sourceEvent;\r\n        var targetEvent;\r\n        if (typeof event === 'string') {\r\n            sourceEvent = targetEvent = event;\r\n        }\r\n        else {\r\n            sourceEvent = event.source;\r\n            targetEvent = event.target;\r\n        }\r\n        source.on(sourceEvent, function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return target.trigger.apply(target, __spreadArrays([targetEvent], args));\r\n        });\r\n    });\r\n}\n\nfunction isSamePoint(startPoint, endPoint) {\r\n    // keys of startPoint and endPoint should be equal\r\n    var keys = Object.keys(startPoint);\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var key = keys_1[_i];\r\n        if (startPoint[key] !== endPoint[key])\r\n            return false;\r\n    }\r\n    return true;\r\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\r\nvar Scroller = /** @class */ (function () {\r\n    function Scroller(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.content = content;\r\n        this.resizeTimeout = 0;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'beforeMove',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'scrollEnd',\r\n            'resize',\r\n            'touchEnd',\r\n            'end',\r\n            'flick',\r\n            'scrollCancel',\r\n            'momentum',\r\n            'scrollTo',\r\n            'minDistanceScroll',\r\n            'scrollToElement',\r\n            'beforeRefresh',\r\n        ]);\r\n        this.options = options;\r\n        var _a = this.options.bounce, left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n        // direction X\r\n        this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\r\n            size: 'width',\r\n            position: 'left',\r\n        }));\r\n        // direction Y\r\n        this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\r\n            size: 'height',\r\n            position: 'top',\r\n        }));\r\n        this.translater = new Translater(this.content);\r\n        this.animater = createAnimater(this.content, this.translater, this.options);\r\n        this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\r\n        this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\r\n        var resizeHandler = this.resize.bind(this);\r\n        this.resizeRegister = new EventRegister(window, [\r\n            {\r\n                name: 'orientationchange',\r\n                handler: resizeHandler,\r\n            },\r\n            {\r\n                name: 'resize',\r\n                handler: resizeHandler,\r\n            },\r\n        ]);\r\n        this.registerTransitionEnd();\r\n        this.init();\r\n    }\r\n    Scroller.prototype.init = function () {\r\n        var _this = this;\r\n        this.bindTranslater();\r\n        this.bindAnimater();\r\n        this.bindActions();\r\n        // enable pointer events when scrolling ends\r\n        this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\r\n            _this.togglePointerEvents(true);\r\n        });\r\n    };\r\n    Scroller.prototype.registerTransitionEnd = function () {\r\n        this.transitionEndRegister = new EventRegister(this.content, [\r\n            {\r\n                name: style.transitionEnd,\r\n                handler: this.transitionEnd.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindTranslater = function () {\r\n        var _this = this;\r\n        var hooks = this.translater.hooks;\r\n        hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\r\n            if (_this.options.translateZ) {\r\n                transformStyle.push(_this.options.translateZ);\r\n            }\r\n        });\r\n        // disable pointer events when scrolling\r\n        hooks.on(hooks.eventTypes.translate, function (pos) {\r\n            var prevPos = _this.getCurrentPos();\r\n            _this.updatePositions(pos);\r\n            // scrollEnd will dispatch when scroll is force stopping in touchstart handler\r\n            // so in touchend handler, don't toggle pointer-events\r\n            if (_this.actions.ensuringInteger === true) {\r\n                _this.actions.ensuringInteger = false;\r\n                return;\r\n            }\r\n            // a valid translate\r\n            if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\r\n                _this.togglePointerEvents(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.bindAnimater = function () {\r\n        var _this = this;\r\n        // reset position\r\n        this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\r\n            if (!_this.resetPosition(_this.options.bounceTime)) {\r\n                _this.animater.setPending(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n        });\r\n        bubbling(this.animater.hooks, this.hooks, [\r\n            {\r\n                source: this.animater.hooks.eventTypes.move,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: this.animater.hooks.eventTypes.forceStop,\r\n                target: this.hooks.eventTypes.scrollEnd,\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindActions = function () {\r\n        var _this = this;\r\n        var actions = this.actions;\r\n        bubbling(actions.hooks, this.hooks, [\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeScrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeMove,\r\n                target: this.hooks.eventTypes.beforeMove,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scrollStart,\r\n                target: this.hooks.eventTypes.scrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scroll,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeEnd,\r\n                target: this.hooks.eventTypes.beforeEnd,\r\n            },\r\n        ]);\r\n        actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\r\n            if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\r\n                return true;\r\n            }\r\n            // check if it is a click operation\r\n            if (!actions.fingerMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\r\n                if (_this.checkClick(e)) {\r\n                    return true;\r\n                }\r\n            }\r\n            // reset if we are outside of the boundaries\r\n            if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\r\n                _this.animater.setForceStopped(false);\r\n                return true;\r\n            }\r\n        });\r\n        actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\r\n            var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\r\n            var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\r\n            if (_this.checkFlick(duration, deltaX, deltaY)) {\r\n                _this.animater.setForceStopped(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.flick);\r\n                return;\r\n            }\r\n            if (_this.momentum(pos, duration)) {\r\n                _this.animater.setForceStopped(false);\r\n                return;\r\n            }\r\n            if (actions.contentMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n            if (_this.animater.forceStopped) {\r\n                _this.animater.setForceStopped(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\r\n        var flickMinMovingDistance = 1; // distinguish flick from click\r\n        if (this.hooks.events.flick.length > 1 &&\r\n            duration < this.options.flickLimitTime &&\r\n            deltaX < this.options.flickLimitDistance &&\r\n            deltaY < this.options.flickLimitDistance &&\r\n            (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.momentum = function (pos, duration) {\r\n        var meta = {\r\n            time: 0,\r\n            easing: ease.swiper,\r\n            newX: pos.x,\r\n            newY: pos.y,\r\n        };\r\n        // start momentum animation if needed\r\n        var momentumX = this.scrollBehaviorX.end(duration);\r\n        var momentumY = this.scrollBehaviorY.end(duration);\r\n        meta.newX = isUndef(momentumX.destination)\r\n            ? meta.newX\r\n            : momentumX.destination;\r\n        meta.newY = isUndef(momentumY.destination)\r\n            ? meta.newY\r\n            : momentumY.destination;\r\n        meta.time = Math.max(momentumX.duration, momentumY.duration);\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this);\r\n        // when x or y changed, do momentum animation now!\r\n        if (meta.newX !== pos.x || meta.newY !== pos.y) {\r\n            // change easing function when scroller goes out of the boundaries\r\n            if (meta.newX > this.scrollBehaviorX.minScrollPos ||\r\n                meta.newX < this.scrollBehaviorX.maxScrollPos ||\r\n                meta.newY > this.scrollBehaviorY.minScrollPos ||\r\n                meta.newY < this.scrollBehaviorY.maxScrollPos) {\r\n                meta.easing = ease.swipeBounce;\r\n            }\r\n            this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.checkClick = function (e) {\r\n        var cancelable = {\r\n            preventClick: this.animater.forceStopped,\r\n        };\r\n        // we scrolled less than momentumLimitDistance pixels\r\n        if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\r\n            this.animater.setForceStopped(false);\r\n            return true;\r\n        }\r\n        if (!cancelable.preventClick) {\r\n            var _dblclick = this.options.dblclick;\r\n            var dblclickTrigged = false;\r\n            if (_dblclick && this.lastClickTime) {\r\n                var _a = _dblclick.delay, delay = _a === void 0 ? 300 : _a;\r\n                if (getNow() - this.lastClickTime < delay) {\r\n                    dblclickTrigged = true;\r\n                    dblclick(e);\r\n                }\r\n            }\r\n            if (this.options.tap) {\r\n                tap(e, this.options.tap);\r\n            }\r\n            if (this.options.click &&\r\n                !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n                click(e);\r\n            }\r\n            this.lastClickTime = dblclickTrigged ? null : getNow();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Scroller.prototype.resize = function () {\r\n        var _this = this;\r\n        if (!this.actions.enabled) {\r\n            return;\r\n        }\r\n        // fix a scroll problem under Android condition\r\n        /* istanbul ignore if  */\r\n        if (isAndroid) {\r\n            this.wrapper.scrollTop = 0;\r\n        }\r\n        clearTimeout(this.resizeTimeout);\r\n        this.resizeTimeout = window.setTimeout(function () {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.resize);\r\n        }, this.options.resizePolling);\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.transitionEnd = function (e) {\r\n        if (e.target !== this.content || !this.animater.pending) {\r\n            return;\r\n        }\r\n        var animater = this.animater;\r\n        animater.transitionTime();\r\n        if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\r\n            this.animater.setPending(false);\r\n            if (this.options.probeType !== 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\r\n            }\r\n        }\r\n    };\r\n    Scroller.prototype.togglePointerEvents = function (enabled) {\r\n        if (enabled === void 0) { enabled = true; }\r\n        var el = this.content.children.length\r\n            ? this.content.children\r\n            : [this.content];\r\n        var pointerEvents = enabled ? 'auto' : 'none';\r\n        for (var i = 0; i < el.length; i++) {\r\n            var node = el[i];\r\n            // ignore BetterScroll instance's wrapper DOM\r\n            /* istanbul ignore if  */\r\n            if (node.isBScrollContainer) {\r\n                continue;\r\n            }\r\n            node.style.pointerEvents = pointerEvents;\r\n        }\r\n    };\r\n    Scroller.prototype.refresh = function (content) {\r\n        var contentChanged = this.setContent(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\r\n        this.scrollBehaviorX.refresh(content);\r\n        this.scrollBehaviorY.refresh(content);\r\n        if (contentChanged) {\r\n            this.translater.setContent(content);\r\n            this.animater.setContent(content);\r\n            this.transitionEndRegister.destroy();\r\n            this.registerTransitionEnd();\r\n            if (this.options.bindToTarget) {\r\n                this.actionsHandler.setContent(content);\r\n            }\r\n        }\r\n        this.actions.refresh();\r\n        this.wrapperOffset = offset(this.wrapper);\r\n    };\r\n    Scroller.prototype.setContent = function (content) {\r\n        var contentChanged = content !== this.content;\r\n        if (contentChanged) {\r\n            this.content = content;\r\n        }\r\n        return contentChanged;\r\n    };\r\n    Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        var _a = this.getCurrentPos(), x = _a.x, y = _a.y;\r\n        easing = !easing ? ease.bounce : easing;\r\n        deltaX += x;\r\n        deltaY += y;\r\n        this.scrollTo(deltaX, deltaY, time, easing);\r\n    };\r\n    Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        if (extraTransform === void 0) { extraTransform = {\r\n            start: {},\r\n            end: {},\r\n        }; }\r\n        var easingFn = this.options.useTransition ? easing.style : easing.fn;\r\n        var currentPos = this.getCurrentPos();\r\n        var startPoint = __assign({ x: currentPos.x, y: currentPos.y }, extraTransform.start);\r\n        var endPoint = __assign({ x: x,\r\n            y: y }, extraTransform.end);\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint);\r\n        // it is an useless move\r\n        if (isSamePoint(startPoint, endPoint))\r\n            return;\r\n        var deltaX = Math.abs(endPoint.x - startPoint.x);\r\n        var deltaY = Math.abs(endPoint.y - startPoint.y);\r\n        // considering of browser compatibility for decimal transform value\r\n        // force translating immediately\r\n        if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\r\n            time = 0;\r\n            this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\r\n        }\r\n        this.animater.move(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\r\n        var targetEle = getElement(el);\r\n        var pos = offset(targetEle);\r\n        var getOffset = function (offset, size, wrapperSize) {\r\n            if (typeof offset === 'number') {\r\n                return offset;\r\n            }\r\n            // if offsetX/Y are true we center the element to the screen\r\n            return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\r\n        };\r\n        offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\r\n        offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\r\n        var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\r\n            pos -= wrapperPos;\r\n            pos = scrollBehavior.adjustPosition(pos - offset);\r\n            return pos;\r\n        };\r\n        pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\r\n        pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\r\n            return;\r\n        }\r\n        this.scrollTo(pos.left, pos.top, time, easing);\r\n    };\r\n    Scroller.prototype.resetPosition = function (time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        var _a = this.scrollBehaviorX.checkInBoundary(), x = _a.position, xInBoundary = _a.inBoundary;\r\n        var _b = this.scrollBehaviorY.checkInBoundary(), y = _b.position, yInBoundary = _b.inBoundary;\r\n        if (xInBoundary && yInBoundary) {\r\n            return false;\r\n        }\r\n        /* istanbul ignore if  */\r\n        if (isIOSBadVersion) {\r\n            // fix ios 13.4 bouncing\r\n            // see it in issues 982\r\n            this.reflow();\r\n        }\r\n        // out of boundary\r\n        this.scrollTo(x, y, time, easing);\r\n        return true;\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.reflow = function () {\r\n        this._reflow = this.content.offsetHeight;\r\n    };\r\n    Scroller.prototype.updatePositions = function (pos) {\r\n        this.scrollBehaviorX.updatePosition(pos.x);\r\n        this.scrollBehaviorY.updatePosition(pos.y);\r\n    };\r\n    Scroller.prototype.getCurrentPos = function () {\r\n        return this.actions.getCurrentPos();\r\n    };\r\n    Scroller.prototype.enable = function () {\r\n        this.actions.enabled = true;\r\n    };\r\n    Scroller.prototype.disable = function () {\r\n        cancelAnimationFrame(this.animater.timer);\r\n        this.actions.enabled = false;\r\n    };\r\n    Scroller.prototype.destroy = function () {\r\n        var _this = this;\r\n        var keys = [\r\n            'resizeRegister',\r\n            'transitionEndRegister',\r\n            'actionsHandler',\r\n            'actions',\r\n            'hooks',\r\n            'animater',\r\n            'translater',\r\n            'scrollBehaviorX',\r\n            'scrollBehaviorY',\r\n        ];\r\n        keys.forEach(function (key) { return _this[key].destroy(); });\r\n    };\r\n    return Scroller;\r\n}());\n\nvar BScrollConstructor = /** @class */ (function (_super) {\r\n    __extends(BScrollConstructor, _super);\r\n    function BScrollConstructor(el, options) {\r\n        var _this = _super.call(this, [\r\n            'refresh',\r\n            'contentChanged',\r\n            'enable',\r\n            'disable',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'scrollEnd',\r\n            'scrollCancel',\r\n            'touchEnd',\r\n            'flick',\r\n            'destroy'\r\n        ]) || this;\r\n        var wrapper = getElement(el);\r\n        if (!wrapper) {\r\n            warn('Can not resolve the wrapper DOM.');\r\n            return _this;\r\n        }\r\n        _this.plugins = {};\r\n        _this.options = new OptionsConstructor().merge(options).process();\r\n        if (!_this.setContent(wrapper).valid) {\r\n            return _this;\r\n        }\r\n        _this.hooks = new EventEmitter([\r\n            'refresh',\r\n            'enable',\r\n            'disable',\r\n            'destroy',\r\n            'beforeInitialScrollTo',\r\n            'contentChanged'\r\n        ]);\r\n        _this.init(wrapper);\r\n        return _this;\r\n    }\r\n    BScrollConstructor.use = function (ctor) {\r\n        var name = ctor.pluginName;\r\n        var installed = BScrollConstructor.plugins.some(function (plugin) { return ctor === plugin.ctor; });\r\n        if (installed)\r\n            return BScrollConstructor;\r\n        if (isUndef(name)) {\r\n            warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\r\n            return BScrollConstructor;\r\n        }\r\n        BScrollConstructor.pluginsMap[name] = true;\r\n        BScrollConstructor.plugins.push({\r\n            name: name,\r\n            applyOrder: ctor.applyOrder,\r\n            ctor: ctor\r\n        });\r\n        return BScrollConstructor;\r\n    };\r\n    BScrollConstructor.prototype.setContent = function (wrapper) {\r\n        var contentChanged = false;\r\n        var valid = true;\r\n        var content = wrapper.children[this.options.specifiedIndexAsContent];\r\n        if (!content) {\r\n            warn('The wrapper need at least one child element to be content element to scroll.');\r\n            valid = false;\r\n        }\r\n        else {\r\n            contentChanged = this.content !== content;\r\n            if (contentChanged) {\r\n                this.content = content;\r\n            }\r\n        }\r\n        return {\r\n            valid: valid,\r\n            contentChanged: contentChanged\r\n        };\r\n    };\r\n    BScrollConstructor.prototype.init = function (wrapper) {\r\n        var _this = this;\r\n        this.wrapper = wrapper;\r\n        // mark wrapper to recognize bs instance by DOM attribute\r\n        wrapper.isBScrollContainer = true;\r\n        this.scroller = new Scroller(wrapper, this.content, this.options);\r\n        this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\r\n            _this.refresh();\r\n        });\r\n        this.eventBubbling();\r\n        this.handleAutoBlur();\r\n        this.enable();\r\n        this.proxy(propertiesConfig$7);\r\n        this.applyPlugins();\r\n        // maybe boundary has changed, should refresh\r\n        this.refreshWithoutReset(this.content);\r\n        var _a = this.options, startX = _a.startX, startY = _a.startY;\r\n        var position = {\r\n            x: startX,\r\n            y: startY\r\n        };\r\n        // maybe plugins want to control scroll position\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\r\n            return;\r\n        }\r\n        this.scroller.scrollTo(position.x, position.y);\r\n    };\r\n    BScrollConstructor.prototype.applyPlugins = function () {\r\n        var _this = this;\r\n        var options = this.options;\r\n        BScrollConstructor.plugins\r\n            .sort(function (a, b) {\r\n            var _a;\r\n            var applyOrderMap = (_a = {},\r\n                _a[\"pre\" /* Pre */] = -1,\r\n                _a[\"post\" /* Post */] = 1,\r\n                _a);\r\n            var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\r\n            var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\r\n            return aOrder - bOrder;\r\n        })\r\n            .forEach(function (item) {\r\n            var ctor = item.ctor;\r\n            if (options[item.name] && typeof ctor === 'function') {\r\n                _this.plugins[item.name] = new ctor(_this);\r\n            }\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.handleAutoBlur = function () {\r\n        /* istanbul ignore if  */\r\n        if (this.options.autoBlur) {\r\n            this.on(this.eventTypes.beforeScrollStart, function () {\r\n                var activeElement = document.activeElement;\r\n                if (activeElement &&\r\n                    (activeElement.tagName === 'INPUT' ||\r\n                        activeElement.tagName === 'TEXTAREA')) {\r\n                    activeElement.blur();\r\n                }\r\n            });\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.eventBubbling = function () {\r\n        bubbling(this.scroller.hooks, this, [\r\n            this.eventTypes.beforeScrollStart,\r\n            this.eventTypes.scrollStart,\r\n            this.eventTypes.scroll,\r\n            this.eventTypes.scrollEnd,\r\n            this.eventTypes.scrollCancel,\r\n            this.eventTypes.touchEnd,\r\n            this.eventTypes.flick\r\n        ]);\r\n    };\r\n    BScrollConstructor.prototype.refreshWithoutReset = function (content) {\r\n        this.scroller.refresh(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.refresh, content);\r\n        this.trigger(this.eventTypes.refresh, content);\r\n    };\r\n    BScrollConstructor.prototype.proxy = function (propertiesConfig) {\r\n        var _this = this;\r\n        propertiesConfig.forEach(function (_a) {\r\n            var key = _a.key, sourceKey = _a.sourceKey;\r\n            propertiesProxy(_this, sourceKey, key);\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.refresh = function () {\r\n        var _a = this.setContent(this.wrapper), contentChanged = _a.contentChanged, valid = _a.valid;\r\n        if (valid) {\r\n            var content = this.content;\r\n            this.refreshWithoutReset(content);\r\n            if (contentChanged) {\r\n                this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\r\n                this.trigger(this.eventTypes.contentChanged, content);\r\n            }\r\n            this.scroller.resetPosition();\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.enable = function () {\r\n        this.scroller.enable();\r\n        this.hooks.trigger(this.hooks.eventTypes.enable);\r\n        this.trigger(this.eventTypes.enable);\r\n    };\r\n    BScrollConstructor.prototype.disable = function () {\r\n        this.scroller.disable();\r\n        this.hooks.trigger(this.hooks.eventTypes.disable);\r\n        this.trigger(this.eventTypes.disable);\r\n    };\r\n    BScrollConstructor.prototype.destroy = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.destroy);\r\n        this.trigger(this.eventTypes.destroy);\r\n        this.scroller.destroy();\r\n    };\r\n    BScrollConstructor.prototype.eventRegister = function (names) {\r\n        this.registerType(names);\r\n    };\r\n    BScrollConstructor.plugins = [];\r\n    BScrollConstructor.pluginsMap = {};\r\n    return BScrollConstructor;\r\n}(EventEmitter));\r\nfunction createBScroll(el, options) {\r\n    var bs = new BScrollConstructor(el, options);\r\n    return bs;\r\n}\r\ncreateBScroll.use = BScrollConstructor.use;\r\ncreateBScroll.plugins = BScrollConstructor.plugins;\r\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\r\nvar BScroll = createBScroll;\n\nvar MouseWheel = /** @class */ (function () {\r\n    function MouseWheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.wheelEndTimer = 0;\r\n        this.wheelMoveTimer = 0;\r\n        this.wheelStart = false;\r\n        this.init();\r\n    }\r\n    MouseWheel.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.registerEvent();\r\n    };\r\n    MouseWheel.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([\r\n            'alterOptions',\r\n            'mousewheelStart',\r\n            'mousewheelMove',\r\n            'mousewheelEnd',\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.mouseWheel === true\r\n            ? {}\r\n            : this.scroll.options.mouseWheel);\r\n        var defaultOptions = {\r\n            speed: 20,\r\n            invert: false,\r\n            easeTime: 300,\r\n            discreteTime: 400,\r\n            throttleTime: 0,\r\n            dampingFactor: 0.1,\r\n        };\r\n        this.mouseWheelOpt = extend(defaultOptions, userOptions);\r\n    };\r\n    MouseWheel.prototype.handleHooks = function () {\r\n        this.hooksFn = [];\r\n        this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\r\n    };\r\n    MouseWheel.prototype.registerEvent = function () {\r\n        this.eventRegister = new EventRegister(this.scroll.scroller.wrapper, [\r\n            {\r\n                name: 'wheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'mousewheel',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n            {\r\n                name: 'DOMMouseScroll',\r\n                handler: this.wheelHandler.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    MouseWheel.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    MouseWheel.prototype.wheelHandler = function (e) {\r\n        if (!this.scroll.enabled) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e);\r\n        // start\r\n        if (!this.wheelStart) {\r\n            this.wheelStartHandler(e);\r\n            this.wheelStart = true;\r\n        }\r\n        // move\r\n        var delta = this.getWheelDelta(e);\r\n        this.wheelMoveHandler(delta);\r\n        // end\r\n        this.wheelEndDetector(delta);\r\n    };\r\n    MouseWheel.prototype.wheelStartHandler = function (e) {\r\n        this.cleanCache();\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        scrollBehaviorX.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorY.setMovingDirection(0 /* Default */);\r\n        scrollBehaviorX.setDirection(0 /* Default */);\r\n        scrollBehaviorY.setDirection(0 /* Default */);\r\n        this.scroll.trigger(this.scroll.eventTypes.alterOptions, this.mouseWheelOpt);\r\n        this.scroll.trigger(this.scroll.eventTypes.mousewheelStart);\r\n    };\r\n    MouseWheel.prototype.cleanCache = function () {\r\n        this.deltaCache = [];\r\n    };\r\n    MouseWheel.prototype.wheelMoveHandler = function (delta) {\r\n        var _this = this;\r\n        var _a = this.mouseWheelOpt, throttleTime = _a.throttleTime, dampingFactor = _a.dampingFactor;\r\n        if (throttleTime && this.wheelMoveTimer) {\r\n            this.deltaCache.push(delta);\r\n        }\r\n        else {\r\n            var cachedDelta = this.deltaCache.reduce(function (prev, current) {\r\n                return {\r\n                    x: prev.x + current.x,\r\n                    y: prev.y + current.y,\r\n                };\r\n            }, { x: 0, y: 0 });\r\n            this.cleanCache();\r\n            var _b = this.scroll.scroller, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n            scrollBehaviorX.setMovingDirection(-delta.directionX);\r\n            scrollBehaviorY.setMovingDirection(-delta.directionY);\r\n            scrollBehaviorX.setDirection(delta.x);\r\n            scrollBehaviorY.setDirection(delta.y);\r\n            // when out of boundary, perform a damping scroll\r\n            var newX = scrollBehaviorX.performDampingAlgorithm(Math.round(delta.x) + cachedDelta.x, dampingFactor);\r\n            var newY = scrollBehaviorY.performDampingAlgorithm(Math.round(delta.y) + cachedDelta.x, dampingFactor);\r\n            if (!this.scroll.trigger(this.scroll.eventTypes.mousewheelMove, {\r\n                x: newX,\r\n                y: newY,\r\n            })) {\r\n                var easeTime = this.getEaseTime();\r\n                if (newX !== this.scroll.x || newY !== this.scroll.y) {\r\n                    this.scroll.scrollTo(newX, newY, easeTime);\r\n                }\r\n            }\r\n            if (throttleTime) {\r\n                this.wheelMoveTimer = window.setTimeout(function () {\r\n                    _this.wheelMoveTimer = 0;\r\n                }, throttleTime);\r\n            }\r\n        }\r\n    };\r\n    MouseWheel.prototype.wheelEndDetector = function (delta) {\r\n        var _this = this;\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        this.wheelEndTimer = window.setTimeout(function () {\r\n            _this.wheelStart = false;\r\n            window.clearTimeout(_this.wheelMoveTimer);\r\n            _this.wheelMoveTimer = 0;\r\n            _this.scroll.trigger(_this.scroll.eventTypes.mousewheelEnd, delta);\r\n        }, this.mouseWheelOpt.discreteTime);\r\n    };\r\n    MouseWheel.prototype.getWheelDelta = function (e) {\r\n        var _a = this.mouseWheelOpt, speed = _a.speed, invert = _a.invert;\r\n        var wheelDeltaX = 0;\r\n        var wheelDeltaY = 0;\r\n        var direction = invert ? -1 /* Negative */ : 1 /* Positive */;\r\n        switch (true) {\r\n            case 'deltaX' in e:\r\n                if (e.deltaMode === 1) {\r\n                    wheelDeltaX = -e.deltaX * speed;\r\n                    wheelDeltaY = -e.deltaY * speed;\r\n                }\r\n                else {\r\n                    wheelDeltaX = -e.deltaX;\r\n                    wheelDeltaY = -e.deltaY;\r\n                }\r\n                break;\r\n            case 'wheelDeltaX' in e:\r\n                wheelDeltaX = (e.wheelDeltaX / 120) * speed;\r\n                wheelDeltaY = (e.wheelDeltaY / 120) * speed;\r\n                break;\r\n            case 'wheelDelta' in e:\r\n                wheelDeltaX = wheelDeltaY = (e.wheelDelta / 120) * speed;\r\n                break;\r\n            case 'detail' in e:\r\n                wheelDeltaX = wheelDeltaY = (-e.detail / 3) * speed;\r\n                break;\r\n        }\r\n        wheelDeltaX *= direction;\r\n        wheelDeltaY *= direction;\r\n        if (!this.scroll.hasVerticalScroll) {\r\n            if (Math.abs(wheelDeltaY) > Math.abs(wheelDeltaX)) {\r\n                wheelDeltaX = wheelDeltaY;\r\n            }\r\n            wheelDeltaY = 0;\r\n        }\r\n        if (!this.scroll.hasHorizontalScroll) {\r\n            wheelDeltaX = 0;\r\n        }\r\n        var directionX = wheelDeltaX > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaX < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        var directionY = wheelDeltaY > 0\r\n            ? -1 /* Negative */\r\n            : wheelDeltaY < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return {\r\n            x: wheelDeltaX,\r\n            y: wheelDeltaY,\r\n            directionX: directionX,\r\n            directionY: directionY,\r\n        };\r\n    };\r\n    MouseWheel.prototype.beforeHandler = function (e) {\r\n        var _a = this.scroll.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        if (preventDefault &&\r\n            !preventDefaultExceptionFn(e.target, preventDefaultException)) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    MouseWheel.prototype.getEaseTime = function () {\r\n        var SAFE_EASETIME = 100;\r\n        var easeTime = this.mouseWheelOpt.easeTime;\r\n        // scrollEnd event will be triggered in every calling of scrollTo when easeTime is too small\r\n        // easeTime needs to be greater than 100\r\n        if (easeTime < SAFE_EASETIME) {\r\n            warn(\"easeTime should be greater than 100.\" +\r\n                \"If mouseWheel easeTime is too small,\" +\r\n                \"scrollEnd will be triggered many times.\");\r\n        }\r\n        return Math.max(easeTime, SAFE_EASETIME);\r\n    };\r\n    MouseWheel.prototype.destroy = function () {\r\n        this.eventRegister.destroy();\r\n        window.clearTimeout(this.wheelEndTimer);\r\n        window.clearTimeout(this.wheelMoveTimer);\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n    };\r\n    MouseWheel.pluginName = 'mouseWheel';\r\n    MouseWheel.applyOrder = \"pre\" /* Pre */;\r\n    return MouseWheel;\r\n}());\n\nvar ObserveDOM = /** @class */ (function () {\r\n    function ObserveDOM(scroll) {\r\n        this.scroll = scroll;\r\n        this.stopObserver = false;\r\n        this.init();\r\n    }\r\n    ObserveDOM.prototype.init = function () {\r\n        this.handleMutationObserver();\r\n        this.handleHooks();\r\n    };\r\n    ObserveDOM.prototype.handleMutationObserver = function () {\r\n        var _this = this;\r\n        if (typeof MutationObserver !== 'undefined') {\r\n            var timer_1 = 0;\r\n            this.observer = new MutationObserver(function (mutations) {\r\n                _this.mutationObserverHandler(mutations, timer_1);\r\n            });\r\n            this.startObserve(this.observer);\r\n        }\r\n        else {\r\n            this.checkDOMUpdate();\r\n        }\r\n    };\r\n    ObserveDOM.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\r\n            _this.stopObserve();\r\n            // launch a new mutationObserver\r\n            _this.handleMutationObserver();\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.enable, function () {\r\n            if (_this.stopObserver) {\r\n                _this.handleMutationObserver();\r\n            }\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.disable, function () {\r\n            _this.stopObserve();\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\r\n            _this.destroy();\r\n        });\r\n    };\r\n    ObserveDOM.prototype.mutationObserverHandler = function (mutations, timer) {\r\n        var _this = this;\r\n        if (this.shouldNotRefresh()) {\r\n            return;\r\n        }\r\n        var immediateRefresh = false;\r\n        var deferredRefresh = false;\r\n        for (var i = 0; i < mutations.length; i++) {\r\n            var mutation = mutations[i];\r\n            if (mutation.type !== 'attributes') {\r\n                immediateRefresh = true;\r\n                break;\r\n            }\r\n            else {\r\n                if (mutation.target !== this.scroll.scroller.content) {\r\n                    deferredRefresh = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (immediateRefresh) {\r\n            this.scroll.refresh();\r\n        }\r\n        else if (deferredRefresh) {\r\n            // attributes changes too often\r\n            clearTimeout(timer);\r\n            timer = window.setTimeout(function () {\r\n                if (!_this.shouldNotRefresh()) {\r\n                    _this.scroll.refresh();\r\n                }\r\n            }, 60);\r\n        }\r\n    };\r\n    ObserveDOM.prototype.startObserve = function (observer) {\r\n        var config = {\r\n            attributes: true,\r\n            childList: true,\r\n            subtree: true,\r\n        };\r\n        observer.observe(this.scroll.scroller.content, config);\r\n    };\r\n    ObserveDOM.prototype.shouldNotRefresh = function () {\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        var outsideBoundaries = scrollBehaviorX.currentPos > scrollBehaviorX.minScrollPos ||\r\n            scrollBehaviorX.currentPos < scrollBehaviorX.maxScrollPos ||\r\n            scrollBehaviorY.currentPos > scrollBehaviorY.minScrollPos ||\r\n            scrollBehaviorY.currentPos < scrollBehaviorY.maxScrollPos;\r\n        return scroller.animater.pending || outsideBoundaries;\r\n    };\r\n    ObserveDOM.prototype.checkDOMUpdate = function () {\r\n        var _this = this;\r\n        var content = this.scroll.scroller.content;\r\n        var contentRect = getRect(content);\r\n        var oldWidth = contentRect.width;\r\n        var oldHeight = contentRect.height;\r\n        var check = function () {\r\n            if (_this.stopObserver) {\r\n                return;\r\n            }\r\n            contentRect = getRect(content);\r\n            var newWidth = contentRect.width;\r\n            var newHeight = contentRect.height;\r\n            if (oldWidth !== newWidth || oldHeight !== newHeight) {\r\n                _this.scroll.refresh();\r\n            }\r\n            oldWidth = newWidth;\r\n            oldHeight = newHeight;\r\n            next();\r\n        };\r\n        var next = function () {\r\n            setTimeout(function () {\r\n                check();\r\n            }, 1000);\r\n        };\r\n        next();\r\n    };\r\n    ObserveDOM.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    ObserveDOM.prototype.stopObserve = function () {\r\n        this.stopObserver = true;\r\n        if (this.observer) {\r\n            this.observer.disconnect();\r\n        }\r\n    };\r\n    ObserveDOM.prototype.destroy = function () {\r\n        this.stopObserve();\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    ObserveDOM.pluginName = 'observeDOM';\r\n    return ObserveDOM;\r\n}());\n\nvar sourcePrefix$6 = 'plugins.pullDownRefresh';\r\nvar propertiesMap$6 = [\r\n    {\r\n        key: 'finishPullDown',\r\n        name: 'finishPullDown'\r\n    },\r\n    {\r\n        key: 'openPullDown',\r\n        name: 'openPullDown'\r\n    },\r\n    {\r\n        key: 'closePullDown',\r\n        name: 'closePullDown'\r\n    },\r\n    {\r\n        key: 'autoPullDownRefresh',\r\n        name: 'autoPullDownRefresh'\r\n    }\r\n];\r\nvar propertiesConfig$6 = propertiesMap$6.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$6 + \".\" + item.name\r\n    };\r\n});\n\nvar PULLING_DOWN_EVENT = 'pullingDown';\r\nvar ENTER_THRESHOLD_EVENT = 'enterThreshold';\r\nvar LEAVE_THRESHOLD_EVENT = 'leaveThreshold';\r\nvar PullDown = /** @class */ (function () {\r\n    function PullDown(scroll) {\r\n        this.scroll = scroll;\r\n        this.pulling = 0 /* DEFAULT */;\r\n        this.thresholdBoundary = 0 /* DEFAULT */;\r\n        this.init();\r\n    }\r\n    PullDown.prototype.setPulling = function (status) {\r\n        this.pulling = status;\r\n    };\r\n    PullDown.prototype.setThresholdBoundary = function (boundary) {\r\n        this.thresholdBoundary = boundary;\r\n    };\r\n    PullDown.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions(this.scroll.options.pullDownRefresh);\r\n        this.handleHooks();\r\n        this.watch();\r\n    };\r\n    PullDown.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([\r\n            PULLING_DOWN_EVENT,\r\n            ENTER_THRESHOLD_EVENT,\r\n            LEAVE_THRESHOLD_EVENT,\r\n        ]);\r\n        this.scroll.proxy(propertiesConfig$6);\r\n    };\r\n    PullDown.prototype.handleOptions = function (userOptions) {\r\n        if (userOptions === void 0) { userOptions = {}; }\r\n        userOptions = (userOptions === true ? {} : userOptions);\r\n        var defaultOptions = {\r\n            threshold: 90,\r\n            stop: 40,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n        this.scroll.options.probeType = 3 /* Realtime */;\r\n    };\r\n    PullDown.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.currentMinScrollY = this.cachedOriginanMinScrollY =\r\n            scrollBehaviorY.minScrollPos;\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\r\n            _this.finishPullDown();\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            // content is smaller than wrapper\r\n            if (boundary.maxScrollPos > 0) {\r\n                // allow scrolling when content is not full of wrapper\r\n                boundary.maxScrollPos = -1;\r\n            }\r\n            boundary.minScrollPos = _this.currentMinScrollY;\r\n        });\r\n        // integrate with mousewheel\r\n        if (this.hasMouseWheelPlugin()) {\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.alterOptions, function (mouseWheelOptions) {\r\n                var SANE_DISCRETE_TIME = 300;\r\n                var SANE_EASE_TIME = 350;\r\n                mouseWheelOptions.discreteTime = SANE_DISCRETE_TIME;\r\n                // easeTime > discreteTime ensure goInto checkPullDown function\r\n                mouseWheelOptions.easeTime = SANE_EASE_TIME;\r\n            });\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function () {\r\n                // mouseWheel need trigger checkPullDown manually\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.end);\r\n            });\r\n        }\r\n    };\r\n    PullDown.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    PullDown.prototype.hasMouseWheelPlugin = function () {\r\n        return !!this.scroll.eventTypes.alterOptions;\r\n    };\r\n    PullDown.prototype.watch = function () {\r\n        var scroller = this.scroll.scroller;\r\n        this.watching = true;\r\n        this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.end, this.checkPullDown);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\r\n        if (this.hasMouseWheelPlugin()) {\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\r\n        }\r\n    };\r\n    PullDown.prototype.resetStateBeforeScrollStart = function () {\r\n        // current fetching pulldownRefresh has ended\r\n        if (!this.isFetchingStatus()) {\r\n            this.setPulling(1 /* MOVING */);\r\n            this.setThresholdBoundary(0 /* DEFAULT */);\r\n        }\r\n    };\r\n    PullDown.prototype.checkLocationOfThresholdBoundary = function () {\r\n        // pulldownRefresh is in the phase of Moving\r\n        if (this.pulling === 1 /* MOVING */) {\r\n            var scroll_1 = this.scroll;\r\n            // enter threshold boundary\r\n            var enteredThresholdBoundary = this.thresholdBoundary !== 1 /* INSIDE */ &&\r\n                this.locateInsideThresholdBoundary();\r\n            // leave threshold boundary\r\n            var leftThresholdBoundary = this.thresholdBoundary !== 2 /* OUTSIDE */ &&\r\n                !this.locateInsideThresholdBoundary();\r\n            if (enteredThresholdBoundary) {\r\n                this.setThresholdBoundary(1 /* INSIDE */);\r\n                scroll_1.trigger(ENTER_THRESHOLD_EVENT);\r\n            }\r\n            if (leftThresholdBoundary) {\r\n                this.setThresholdBoundary(2 /* OUTSIDE */);\r\n                scroll_1.trigger(LEAVE_THRESHOLD_EVENT);\r\n            }\r\n        }\r\n    };\r\n    PullDown.prototype.locateInsideThresholdBoundary = function () {\r\n        return this.scroll.y <= this.options.threshold;\r\n    };\r\n    PullDown.prototype.unwatch = function () {\r\n        var scroll = this.scroll;\r\n        var scroller = scroll.scroller;\r\n        this.watching = false;\r\n        scroller.hooks.off(scroller.hooks.eventTypes.end, this.checkPullDown);\r\n        scroll.off(scroll.eventTypes.scrollStart, this.resetStateBeforeScrollStart);\r\n        scroll.off(scroll.eventTypes.scroll, this.checkLocationOfThresholdBoundary);\r\n        if (this.hasMouseWheelPlugin()) {\r\n            scroll.off(scroll.eventTypes.mousewheelStart, this.resetStateBeforeScrollStart);\r\n        }\r\n    };\r\n    PullDown.prototype.checkPullDown = function () {\r\n        var _a = this.options, threshold = _a.threshold, stop = _a.stop;\r\n        // check if a real pull down action\r\n        if (this.scroll.y < threshold) {\r\n            return false;\r\n        }\r\n        if (this.pulling === 1 /* MOVING */) {\r\n            this.modifyBehaviorYBoundary(stop);\r\n            this.setPulling(2 /* FETCHING */);\r\n            this.scroll.trigger(PULLING_DOWN_EVENT);\r\n        }\r\n        this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\r\n        return this.isFetchingStatus();\r\n    };\r\n    PullDown.prototype.isFetchingStatus = function () {\r\n        return this.pulling === 2 /* FETCHING */;\r\n    };\r\n    PullDown.prototype.modifyBehaviorYBoundary = function (stopDistance) {\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        // manually modify minScrollPos for a hang animation\r\n        // to prevent from resetPosition\r\n        this.cachedOriginanMinScrollY = scrollBehaviorY.minScrollPos;\r\n        this.currentMinScrollY = stopDistance;\r\n        scrollBehaviorY.computeBoundary();\r\n    };\r\n    PullDown.prototype.finishPullDown = function () {\r\n        if (this.isFetchingStatus()) {\r\n            var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n            // restore minScrollY since the hang animation has ended\r\n            this.currentMinScrollY = this.cachedOriginanMinScrollY;\r\n            scrollBehaviorY.computeBoundary();\r\n            this.setPulling(0 /* DEFAULT */);\r\n            this.scroll.resetPosition(this.scroll.options.bounceTime, ease.bounce);\r\n        }\r\n    };\r\n    // allow 'true' type is compat for beta version implements\r\n    PullDown.prototype.openPullDown = function (config) {\r\n        if (config === void 0) { config = {}; }\r\n        this.handleOptions(config);\r\n        if (!this.watching) {\r\n            this.watch();\r\n        }\r\n    };\r\n    PullDown.prototype.closePullDown = function () {\r\n        this.unwatch();\r\n    };\r\n    PullDown.prototype.autoPullDownRefresh = function () {\r\n        var _a = this.options, threshold = _a.threshold, stop = _a.stop;\r\n        if (this.isFetchingStatus() || !this.watching) {\r\n            return;\r\n        }\r\n        this.modifyBehaviorYBoundary(stop);\r\n        this.scroll.trigger(this.scroll.eventTypes.scrollStart);\r\n        this.scroll.scrollTo(this.scroll.x, threshold);\r\n        this.setPulling(2 /* FETCHING */);\r\n        this.scroll.trigger(PULLING_DOWN_EVENT);\r\n        this.scroll.scrollTo(this.scroll.x, stop, this.scroll.options.bounceTime, ease.bounce);\r\n    };\r\n    PullDown.pluginName = 'pullDownRefresh';\r\n    return PullDown;\r\n}());\n\nvar sourcePrefix$5 = 'plugins.pullUpLoad';\r\nvar propertiesMap$5 = [\r\n    {\r\n        key: 'finishPullUp',\r\n        name: 'finishPullUp'\r\n    },\r\n    {\r\n        key: 'openPullUp',\r\n        name: 'openPullUp'\r\n    },\r\n    {\r\n        key: 'closePullUp',\r\n        name: 'closePullUp'\r\n    },\r\n    {\r\n        key: 'autoPullUpLoad',\r\n        name: 'autoPullUpLoad'\r\n    }\r\n];\r\nvar propertiesConfig$5 = propertiesMap$5.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$5 + \".\" + item.name\r\n    };\r\n});\n\nvar PULL_UP_HOOKS_NAME = 'pullingUp';\r\nvar PullUp = /** @class */ (function () {\r\n    function PullUp(scroll) {\r\n        this.scroll = scroll;\r\n        this.pulling = false;\r\n        this.watching = false;\r\n        this.init();\r\n    }\r\n    PullUp.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions(this.scroll.options.pullUpLoad);\r\n        this.handleHooks();\r\n        this.watch();\r\n    };\r\n    PullUp.prototype.handleBScroll = function () {\r\n        this.scroll.registerType([PULL_UP_HOOKS_NAME]);\r\n        this.scroll.proxy(propertiesConfig$5);\r\n    };\r\n    PullUp.prototype.handleOptions = function (userOptions) {\r\n        if (userOptions === void 0) { userOptions = {}; }\r\n        userOptions = (userOptions === true ? {} : userOptions);\r\n        var defaultOptions = {\r\n            threshold: 0,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n        this.scroll.options.probeType = 3 /* Realtime */;\r\n    };\r\n    PullUp.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.contentChanged, function () {\r\n            _this.finishPullUp();\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            // content is smaller than wrapper\r\n            if (boundary.maxScrollPos > 0) {\r\n                // allow scrolling when content is not full of wrapper\r\n                boundary.maxScrollPos = -1;\r\n            }\r\n        });\r\n    };\r\n    PullUp.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    PullUp.prototype.watch = function () {\r\n        if (this.watching) {\r\n            return;\r\n        }\r\n        this.watching = true;\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scroll, this.checkPullUp);\r\n    };\r\n    PullUp.prototype.unwatch = function () {\r\n        this.watching = false;\r\n        this.scroll.off(this.scroll.eventTypes.scroll, this.checkPullUp);\r\n    };\r\n    PullUp.prototype.checkPullUp = function (pos) {\r\n        var _this = this;\r\n        var threshold = this.options.threshold;\r\n        if (this.scroll.movingDirectionY === 1 /* Positive */ &&\r\n            pos.y <= this.scroll.maxScrollY + threshold) {\r\n            this.pulling = true;\r\n            // must reset pulling after scrollEnd\r\n            this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\r\n                _this.pulling = false;\r\n            });\r\n            this.unwatch();\r\n            this.scroll.trigger(PULL_UP_HOOKS_NAME);\r\n        }\r\n    };\r\n    PullUp.prototype.finishPullUp = function () {\r\n        var _this = this;\r\n        // reset Direction, fix #936\r\n        this.scroll.scroller.scrollBehaviorY.setMovingDirection(0 /* Default */);\r\n        if (this.pulling) {\r\n            this.scroll.once(this.scroll.eventTypes.scrollEnd, function () {\r\n                _this.watch();\r\n            });\r\n        }\r\n        else {\r\n            this.watch();\r\n        }\r\n    };\r\n    // allow 'true' type is compat for beta version implements\r\n    PullUp.prototype.openPullUp = function (config) {\r\n        if (config === void 0) { config = {}; }\r\n        this.handleOptions(config);\r\n        this.watch();\r\n    };\r\n    PullUp.prototype.closePullUp = function () {\r\n        this.unwatch();\r\n    };\r\n    PullUp.prototype.autoPullUpLoad = function () {\r\n        var threshold = this.options.threshold;\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        if (this.pulling || !this.watching) {\r\n            return;\r\n        }\r\n        // simulate a pullUp action\r\n        var NEGATIVE_VALUE = -1;\r\n        var outOfBoundaryPos = scrollBehaviorY.maxScrollPos + threshold + NEGATIVE_VALUE;\r\n        this.scroll.scroller.scrollBehaviorY.setMovingDirection(NEGATIVE_VALUE);\r\n        this.scroll.scrollTo(this.scroll.x, outOfBoundaryPos, this.scroll.options.bounceTime);\r\n    };\r\n    PullUp.pluginName = 'pullUpLoad';\r\n    return PullUp;\r\n}());\n\nvar EventHandler = /** @class */ (function () {\r\n    function EventHandler(indicator, options) {\r\n        this.indicator = indicator;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter(['touchStart', 'touchMove', 'touchEnd']);\r\n        this.registerEvents();\r\n    }\r\n    EventHandler.prototype.registerEvents = function () {\r\n        var _a = this.options, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch;\r\n        var startEvents = [];\r\n        var moveEvents = [];\r\n        var endEvents = [];\r\n        if (!disableMouse) {\r\n            startEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (!disableTouch) {\r\n            startEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.startEventRegister = new EventRegister(this.indicator.indicatorEl, startEvents);\r\n        this.moveEventRegister = new EventRegister(window, moveEvents);\r\n        this.endEventRegister = new EventRegister(window, endEvents);\r\n    };\r\n    EventHandler.prototype.BScrollIsDisabled = function () {\r\n        return !this.indicator.scroll.enabled;\r\n    };\r\n    EventHandler.prototype.start = function (e) {\r\n        if (this.BScrollIsDisabled()) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.initiated = true;\r\n        this.lastPoint = point[this.indicator.keysMap.point];\r\n        this.hooks.trigger(this.hooks.eventTypes.touchStart);\r\n    };\r\n    EventHandler.prototype.move = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var pointPos = point[this.indicator.keysMap.point];\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        var delta = pointPos - this.lastPoint;\r\n        this.lastPoint = pointPos;\r\n        this.hooks.trigger(this.hooks.eventTypes.touchMove, delta);\r\n    };\r\n    EventHandler.prototype.end = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        this.initiated = false;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.hooks.trigger(this.hooks.eventTypes.touchEnd);\r\n    };\r\n    EventHandler.prototype.destroy = function () {\r\n        this.startEventRegister.destroy();\r\n        this.moveEventRegister.destroy();\r\n        this.endEventRegister.destroy();\r\n    };\r\n    return EventHandler;\r\n}());\n\nvar Indicator$1 = /** @class */ (function () {\r\n    function Indicator(scroll, options) {\r\n        this.scroll = scroll;\r\n        this.options = options;\r\n        this.hooksFn = [];\r\n        this.wrapper = options.wrapper;\r\n        this.direction = options.direction;\r\n        this.indicatorEl = this.wrapper.children[0];\r\n        this.keysMap = this.getKeysMap();\r\n        this.handleFade();\r\n        this.handleHooks();\r\n    }\r\n    Indicator.prototype.handleFade = function () {\r\n        if (this.options.fade) {\r\n            this.wrapper.style.opacity = '0';\r\n        }\r\n    };\r\n    Indicator.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var _a = this.options, fade = _a.fade, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable;\r\n        var scroll = this.scroll;\r\n        var scrollHooks = scroll.hooks;\r\n        var translaterHooks = scroll.scroller.translater.hooks;\r\n        var animaterHooks = scroll.scroller.animater.hooks;\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\r\n        this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\r\n            var hasScrollKey = _this.keysMap.hasScroll;\r\n            if (_this.scroll[hasScrollKey]) {\r\n                _this.updatePosition(pos);\r\n            }\r\n        });\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\r\n        if (fade) {\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollEnd, function () {\r\n                _this.fade();\r\n            });\r\n            this.registerHooks(scroll, scroll.eventTypes.scrollStart, function () {\r\n                _this.fade(true);\r\n            });\r\n            // for mousewheel event\r\n            if (scroll.eventTypes.mousewheelStart &&\r\n                scroll.eventTypes.mousewheelEnd) {\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelStart, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelMove, function () {\r\n                    _this.fade(true);\r\n                });\r\n                this.registerHooks(scroll, scroll.eventTypes.mousewheelEnd, function () {\r\n                    _this.fade();\r\n                });\r\n            }\r\n        }\r\n        if (interactive) {\r\n            var _b = this.scroll.options, disableMouse = _b.disableMouse, disableTouch = _b.disableTouch;\r\n            this.eventHandler = new EventHandler(this, {\r\n                disableMouse: disableMouse,\r\n                disableTouch: disableTouch,\r\n            });\r\n            var eventHandlerHooks = this.eventHandler.hooks;\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchStart, this.startHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchMove, this.moveHandler);\r\n            this.registerHooks(eventHandlerHooks, eventHandlerHooks.eventTypes.touchEnd, this.endHandler);\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.bindClick();\r\n        }\r\n    };\r\n    Indicator.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Indicator.prototype.bindClick = function () {\r\n        var wrapper = this.wrapper;\r\n        this.clickEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'click',\r\n                handler: this.handleClick.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Indicator.prototype.handleClick = function (e) {\r\n        var newPos = this.calculateclickOffsetPos(e);\r\n        var _a = this.scroll, x = _a.x, y = _a.y;\r\n        x = this.direction === \"horizontal\" /* Horizontal */ ? newPos : x;\r\n        y = this.direction === \"vertical\" /* Vertical */ ? newPos : y;\r\n        this.scroll.scrollTo(x, y, this.options.scrollbarTrackOffsetTime);\r\n    };\r\n    Indicator.prototype.calculateclickOffsetPos = function (e) {\r\n        var _a = this.keysMap, poinKey = _a.point, domRectKey = _a.domRect;\r\n        var scrollbarTrackOffsetType = this.options.scrollbarTrackOffsetType;\r\n        var clickPointOffset = e[poinKey] - this.wrapperRect[domRectKey];\r\n        var scrollToWhere = clickPointOffset < this.currentPos ? -1 /* Up */ : 1 /* Down */;\r\n        var delta = 0;\r\n        var currentPos = this.currentPos;\r\n        if (scrollbarTrackOffsetType === \"step\" /* Step */) {\r\n            delta = this.scrollInfo.baseSize * scrollToWhere;\r\n        }\r\n        else {\r\n            delta = 0;\r\n            currentPos = clickPointOffset;\r\n        }\r\n        return this.newPos(currentPos, delta, this.scrollInfo);\r\n    };\r\n    Indicator.prototype.getKeysMap = function () {\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            return {\r\n                hasScroll: 'hasVerticalScroll',\r\n                size: 'height',\r\n                wrapperSize: 'clientHeight',\r\n                scrollerSize: 'scrollerHeight',\r\n                maxScrollPos: 'maxScrollY',\r\n                pos: 'y',\r\n                point: 'pageY',\r\n                translateProperty: 'translateY',\r\n                domRect: 'top',\r\n            };\r\n        }\r\n        return {\r\n            hasScroll: 'hasHorizontalScroll',\r\n            size: 'width',\r\n            wrapperSize: 'clientWidth',\r\n            scrollerSize: 'scrollerWidth',\r\n            maxScrollPos: 'maxScrollX',\r\n            pos: 'x',\r\n            point: 'pageX',\r\n            translateProperty: 'translateX',\r\n            domRect: 'left',\r\n        };\r\n    };\r\n    Indicator.prototype.fade = function (visible) {\r\n        var _a = this.options, fadeInTime = _a.fadeInTime, fadeOutTime = _a.fadeOutTime;\r\n        var time = visible ? fadeInTime : fadeOutTime;\r\n        var wrapper = this.wrapper;\r\n        wrapper.style[style.transitionDuration] = time + 'ms';\r\n        wrapper.style.opacity = visible ? '1' : '0';\r\n    };\r\n    Indicator.prototype.refresh = function () {\r\n        var hasScrollKey = this.keysMap.hasScroll;\r\n        var scroll = this.scroll;\r\n        var x = scroll.x, y = scroll.y;\r\n        this.wrapperRect = this.wrapper.getBoundingClientRect();\r\n        if (this.canScroll(scroll[hasScrollKey])) {\r\n            var _a = this.keysMap, wrapperSizeKey = _a.wrapperSize, scrollerSizeKey = _a.scrollerSize, maxScrollPosKey = _a.maxScrollPos;\r\n            this.scrollInfo = this.refreshScrollInfo(this.wrapper[wrapperSizeKey], scroll[scrollerSizeKey], scroll[maxScrollPosKey], this.indicatorEl[wrapperSizeKey]);\r\n            this.updatePosition({\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.indicatorEl.style[style.transitionDuration] = time + 'ms';\r\n    };\r\n    Indicator.prototype.transitionTimingFunction = function (easing) {\r\n        this.indicatorEl.style[style.transitionTimingFunction] = easing;\r\n    };\r\n    Indicator.prototype.canScroll = function (hasScroll) {\r\n        this.wrapper.style.display = hasScroll ? 'block' : 'none';\r\n        return hasScroll;\r\n    };\r\n    Indicator.prototype.refreshScrollInfo = function (wrapperSize, scrollerSize, maxScrollPos, indicatorElSize) {\r\n        var baseSize = Math.max(Math.round((wrapperSize * wrapperSize) / (scrollerSize || wrapperSize || 1)), this.options.minSize);\r\n        if (this.options.isCustom) {\r\n            baseSize = indicatorElSize;\r\n        }\r\n        var maxIndicatorScrollPos = wrapperSize - baseSize;\r\n        // sizeRatio is negative\r\n        var sizeRatio = maxIndicatorScrollPos / maxScrollPos;\r\n        return {\r\n            baseSize: baseSize,\r\n            maxScrollPos: maxIndicatorScrollPos,\r\n            minScrollPos: 0,\r\n            sizeRatio: sizeRatio,\r\n        };\r\n    };\r\n    Indicator.prototype.updatePosition = function (point) {\r\n        var _a = this.caculatePosAndSize(point, this.scrollInfo), pos = _a.pos, size = _a.size;\r\n        this.refreshStyle(size, pos);\r\n        this.currentPos = pos;\r\n    };\r\n    Indicator.prototype.caculatePosAndSize = function (point, scrollInfo) {\r\n        var posKey = this.keysMap.pos;\r\n        var sizeRatio = scrollInfo.sizeRatio, baseSize = scrollInfo.baseSize, maxScrollPos = scrollInfo.maxScrollPos, minScrollPos = scrollInfo.minScrollPos;\r\n        var minSize = this.options.minSize;\r\n        var pos = Math.round(sizeRatio * point[posKey]);\r\n        var size;\r\n        // when out of boundary, slow down size reduction\r\n        if (pos < minScrollPos) {\r\n            size = Math.max(baseSize + pos * 3, minSize);\r\n            pos = minScrollPos;\r\n        }\r\n        else if (pos > maxScrollPos) {\r\n            size = Math.max(baseSize - (pos - maxScrollPos) * 3, minSize);\r\n            pos = maxScrollPos + baseSize - size;\r\n        }\r\n        else {\r\n            size = baseSize;\r\n        }\r\n        return {\r\n            pos: pos,\r\n            size: size,\r\n        };\r\n    };\r\n    Indicator.prototype.refreshStyle = function (size, pos) {\r\n        var _a = this.keysMap, translatePropertyKey = _a.translateProperty, sizeKey = _a.size;\r\n        var translateZ = this.scroll.options.translateZ;\r\n        this.indicatorEl.style[sizeKey] = size + \"px\";\r\n        this.indicatorEl.style[style.transform] = translatePropertyKey + \"(\" + pos + \"px)\" + translateZ;\r\n    };\r\n    Indicator.prototype.startHandler = function () {\r\n        this.moved = false;\r\n        this.startTime = getNow();\r\n        this.transitionTime();\r\n        this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\r\n    };\r\n    Indicator.prototype.moveHandler = function (delta) {\r\n        if (!this.moved && !this.indicatorNotMoved(delta)) {\r\n            this.moved = true;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.moved) {\r\n            var newPos = this.newPos(this.currentPos, delta, this.scrollInfo);\r\n            this.syncBScroll(newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.endHandler = function () {\r\n        if (this.moved) {\r\n            var _a = this.scroll, x = _a.x, y = _a.y;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.indicatorNotMoved = function (delta) {\r\n        var currentPos = this.currentPos;\r\n        var _a = this.scrollInfo, maxScrollPos = _a.maxScrollPos, minScrollPos = _a.minScrollPos;\r\n        var notMoved = (currentPos === minScrollPos && delta <= 0) ||\r\n            (currentPos === maxScrollPos && delta >= 0);\r\n        return notMoved;\r\n    };\r\n    Indicator.prototype.syncBScroll = function (newPos) {\r\n        var timestamp = getNow();\r\n        var _a = this.scroll, x = _a.x, y = _a.y, options = _a.options, scroller = _a.scroller, maxScrollY = _a.maxScrollY, minScrollY = _a.minScrollY, maxScrollX = _a.maxScrollX, minScrollX = _a.minScrollX;\r\n        var probeType = options.probeType, momentumLimitTime = options.momentumLimitTime;\r\n        var position = { x: x, y: y };\r\n        if (this.direction === \"vertical\" /* Vertical */) {\r\n            position.y = between(newPos, maxScrollY, minScrollY);\r\n        }\r\n        else {\r\n            position.x = between(newPos, maxScrollX, minScrollX);\r\n        }\r\n        scroller.translater.translate(position);\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > momentumLimitTime) {\r\n            this.startTime = timestamp;\r\n            if (probeType === 1 /* Throttle */) {\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (probeType > 1 /* Throttle */) {\r\n            scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, position);\r\n        }\r\n    };\r\n    Indicator.prototype.newPos = function (currentPos, delta, scrollInfo) {\r\n        var maxScrollPos = scrollInfo.maxScrollPos, sizeRatio = scrollInfo.sizeRatio, minScrollPos = scrollInfo.minScrollPos;\r\n        var newPos = currentPos + delta;\r\n        newPos = between(newPos, minScrollPos, maxScrollPos);\r\n        return Math.round(newPos / sizeRatio);\r\n    };\r\n    Indicator.prototype.destroy = function () {\r\n        var _a = this.options, interactive = _a.interactive, scrollbarTrackClickable = _a.scrollbarTrackClickable, isCustom = _a.isCustom;\r\n        if (interactive) {\r\n            this.eventHandler.destroy();\r\n        }\r\n        if (scrollbarTrackClickable) {\r\n            this.clickEventRegister.destroy();\r\n        }\r\n        if (!isCustom) {\r\n            this.wrapper.parentNode.removeChild(this.wrapper);\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    return Indicator;\r\n}());\n\nvar ScrollBar = /** @class */ (function () {\r\n    function ScrollBar(scroll) {\r\n        this.scroll = scroll;\r\n        this.handleOptions();\r\n        this.createIndicators();\r\n        this.handleHooks();\r\n    }\r\n    ScrollBar.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        scroll.hooks.on(scroll.hooks.eventTypes.destroy, function () {\r\n            for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\r\n                var indicator = _a[_i];\r\n                indicator.destroy();\r\n            }\r\n        });\r\n    };\r\n    ScrollBar.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.scrollbar === true\r\n            ? {}\r\n            : this.scroll.options.scrollbar);\r\n        var defaultOptions = {\r\n            fade: true,\r\n            fadeInTime: 250,\r\n            fadeOutTime: 500,\r\n            interactive: false,\r\n            customElements: [],\r\n            minSize: 8,\r\n            scrollbarTrackClickable: false,\r\n            scrollbarTrackOffsetType: \"step\" /* Step */,\r\n            scrollbarTrackOffsetTime: 300,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    ScrollBar.prototype.createIndicators = function () {\r\n        var indicatorOptions;\r\n        var scroll = this.scroll;\r\n        var indicators = [];\r\n        var scrollDirectionConfigKeys = ['scrollX', 'scrollY'];\r\n        var indicatorDirections = [\r\n            \"horizontal\" /* Horizontal */,\r\n            \"vertical\" /* Vertical */,\r\n        ];\r\n        var customScrollbarEls = this.options.customElements;\r\n        for (var i = 0; i < scrollDirectionConfigKeys.length; i++) {\r\n            var key = scrollDirectionConfigKeys[i];\r\n            // wanna scroll in specified direction\r\n            if (scroll.options[key]) {\r\n                var customElement = customScrollbarEls.shift();\r\n                var direction = indicatorDirections[i];\r\n                var isCustom = false;\r\n                var scrollbarWrapper = customElement\r\n                    ? customElement\r\n                    : this.createScrollbarElement(direction);\r\n                // internal scrollbar\r\n                if (scrollbarWrapper !== customElement) {\r\n                    scroll.wrapper.appendChild(scrollbarWrapper);\r\n                }\r\n                else {\r\n                    // custom scrollbar passed by users\r\n                    isCustom = true;\r\n                }\r\n                indicatorOptions = __assign(__assign({ wrapper: scrollbarWrapper, direction: direction }, this.options), { isCustom: isCustom });\r\n                indicators.push(new Indicator$1(scroll, indicatorOptions));\r\n            }\r\n        }\r\n        this.indicators = indicators;\r\n    };\r\n    ScrollBar.prototype.createScrollbarElement = function (direction, scrollbarTrackClickable) {\r\n        if (scrollbarTrackClickable === void 0) { scrollbarTrackClickable = this.options.scrollbarTrackClickable; }\r\n        var scrollbarWrapperEl = document.createElement('div');\r\n        var scrollbarIndicatorEl = document.createElement('div');\r\n        scrollbarWrapperEl.style.cssText =\r\n            'position:absolute;z-index:9999;overflow:hidden;';\r\n        scrollbarIndicatorEl.style.cssText =\r\n            'box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;';\r\n        scrollbarIndicatorEl.className = 'bscroll-indicator';\r\n        if (direction === \"horizontal\" /* Horizontal */) {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'height:7px;left:2px;right:2px;bottom:0;';\r\n            scrollbarIndicatorEl.style.height = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-horizontal-scrollbar';\r\n        }\r\n        else {\r\n            scrollbarWrapperEl.style.cssText +=\r\n                'width:7px;bottom:2px;top:2px;right:1px;';\r\n            scrollbarIndicatorEl.style.width = '100%';\r\n            scrollbarWrapperEl.className = 'bscroll-vertical-scrollbar';\r\n        }\r\n        if (!scrollbarTrackClickable) {\r\n            scrollbarWrapperEl.style.cssText += 'pointer-events:none;';\r\n        }\r\n        scrollbarWrapperEl.appendChild(scrollbarIndicatorEl);\r\n        return scrollbarWrapperEl;\r\n    };\r\n    ScrollBar.pluginName = 'scrollbar';\r\n    return ScrollBar;\r\n}());\n\nvar PagesMatrix = /** @class */ (function () {\r\n    function PagesMatrix(scroll) {\r\n        this.scroll = scroll;\r\n        this.init();\r\n    }\r\n    PagesMatrix.prototype.init = function () {\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.wrapperWidth = scrollBehaviorX.wrapperSize;\r\n        this.wrapperHeight = scrollBehaviorY.wrapperSize;\r\n        this.scrollerHeight = scrollBehaviorY.contentSize;\r\n        this.scrollerWidth = scrollBehaviorX.contentSize;\r\n        this.pages = this.buildPagesMatrix(this.wrapperWidth, this.wrapperHeight);\r\n        this.pageLengthOfX = this.pages ? this.pages.length : 0;\r\n        this.pageLengthOfY = this.pages && this.pages[0] ? this.pages[0].length : 0;\r\n    };\r\n    PagesMatrix.prototype.getPageStats = function (pageX, pageY) {\r\n        return this.pages[pageX][pageY];\r\n    };\r\n    PagesMatrix.prototype.getNearestPageIndex = function (x, y) {\r\n        var pageX = 0;\r\n        var pageY = 0;\r\n        var l = this.pages.length;\r\n        for (; pageX < l - 1; pageX++) {\r\n            if (x >= this.pages[pageX][0].cx) {\r\n                break;\r\n            }\r\n        }\r\n        l = this.pages[pageX].length;\r\n        for (; pageY < l - 1; pageY++) {\r\n            if (y >= this.pages[0][pageY].cy) {\r\n                break;\r\n            }\r\n        }\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n        };\r\n    };\r\n    // (n x 1) matrix for horizontal scroll or\r\n    // (1 * n) matrix for vertical scroll\r\n    PagesMatrix.prototype.buildPagesMatrix = function (stepX, stepY) {\r\n        var pages = [];\r\n        var x = 0;\r\n        var y;\r\n        var cx;\r\n        var cy;\r\n        var i = 0;\r\n        var l;\r\n        var maxScrollPosX = this.scroll.scroller.scrollBehaviorX.maxScrollPos;\r\n        var maxScrollPosY = this.scroll.scroller.scrollBehaviorY.maxScrollPos;\r\n        cx = Math.round(stepX / 2);\r\n        cy = Math.round(stepY / 2);\r\n        while (x > -this.scrollerWidth) {\r\n            pages[i] = [];\r\n            l = 0;\r\n            y = 0;\r\n            while (y > -this.scrollerHeight) {\r\n                pages[i][l] = {\r\n                    x: Math.max(x, maxScrollPosX),\r\n                    y: Math.max(y, maxScrollPosY),\r\n                    width: stepX,\r\n                    height: stepY,\r\n                    cx: x - cx,\r\n                    cy: y - cy,\r\n                };\r\n                y -= stepY;\r\n                l++;\r\n            }\r\n            x -= stepX;\r\n            i++;\r\n        }\r\n        return pages;\r\n    };\r\n    return PagesMatrix;\r\n}());\n\nvar BASE_PAGE = {\r\n    pageX: 0,\r\n    pageY: 0,\r\n    x: 0,\r\n    y: 0,\r\n};\n\nvar SlidePages = /** @class */ (function () {\r\n    function SlidePages(scroll, slideOptions) {\r\n        this.scroll = scroll;\r\n        this.slideOptions = slideOptions;\r\n        this.slideX = false;\r\n        this.slideY = false;\r\n        this.currentPage = extend({}, BASE_PAGE);\r\n    }\r\n    SlidePages.prototype.refresh = function () {\r\n        this.pagesMatrix = new PagesMatrix(this.scroll);\r\n        this.checkSlideLoop();\r\n        this.currentPage = this.getAdjustedCurrentPage();\r\n    };\r\n    SlidePages.prototype.getAdjustedCurrentPage = function () {\r\n        var _a = this.currentPage, pageX = _a.pageX, pageY = _a.pageY;\r\n        // page index should be handled\r\n        // because page counts may reduce\r\n        pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 1);\r\n        pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 1);\r\n        // loop scene should also be respected\r\n        // because clonedNode will cause pageLength increasing\r\n        if (this.loopX) {\r\n            pageX = Math.min(pageX, this.pagesMatrix.pageLengthOfX - 2);\r\n        }\r\n        if (this.loopY) {\r\n            pageY = Math.min(pageY, this.pagesMatrix.pageLengthOfY - 2);\r\n        }\r\n        var _b = this.pagesMatrix.getPageStats(pageX, pageY), x = _b.x, y = _b.y;\r\n        return { pageX: pageX, pageY: pageY, x: x, y: y };\r\n    };\r\n    SlidePages.prototype.setCurrentPage = function (newPage) {\r\n        this.currentPage = newPage;\r\n    };\r\n    SlidePages.prototype.getInternalPage = function (pageX, pageY) {\r\n        if (pageX >= this.pagesMatrix.pageLengthOfX) {\r\n            pageX = this.pagesMatrix.pageLengthOfX - 1;\r\n        }\r\n        else if (pageX < 0) {\r\n            pageX = 0;\r\n        }\r\n        if (pageY >= this.pagesMatrix.pageLengthOfY) {\r\n            pageY = this.pagesMatrix.pageLengthOfY - 1;\r\n        }\r\n        else if (pageY < 0) {\r\n            pageY = 0;\r\n        }\r\n        var _a = this.pagesMatrix.getPageStats(pageX, pageY), x = _a.x, y = _a.y;\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.getInitialPage = function (showFirstPage, firstInitialised) {\r\n        if (showFirstPage === void 0) { showFirstPage = false; }\r\n        if (firstInitialised === void 0) { firstInitialised = false; }\r\n        var _a = this.slideOptions, startPageXIndex = _a.startPageXIndex, startPageYIndex = _a.startPageYIndex;\r\n        var firstPageX = this.loopX ? 1 : 0;\r\n        var firstPageY = this.loopY ? 1 : 0;\r\n        var pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\r\n        var pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\r\n        if (firstInitialised) {\r\n            pageX = this.loopX ? startPageXIndex + 1 : startPageXIndex;\r\n            pageY = this.loopY ? startPageYIndex + 1 : startPageYIndex;\r\n        }\r\n        else {\r\n            pageX = showFirstPage ? firstPageX : this.currentPage.pageX;\r\n            pageY = showFirstPage ? firstPageY : this.currentPage.pageY;\r\n        }\r\n        var _b = this.pagesMatrix.getPageStats(pageX, pageY), x = _b.x, y = _b.y;\r\n        return {\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.getExposedPage = function (page) {\r\n        var exposedPage = extend({}, page);\r\n        // only pageX or pageY need fix\r\n        if (this.loopX) {\r\n            exposedPage.pageX = this.fixedPage(exposedPage.pageX, this.pagesMatrix.pageLengthOfX - 2);\r\n        }\r\n        if (this.loopY) {\r\n            exposedPage.pageY = this.fixedPage(exposedPage.pageY, this.pagesMatrix.pageLengthOfY - 2);\r\n        }\r\n        return exposedPage;\r\n    };\r\n    SlidePages.prototype.getExposedPageByPageIndex = function (pageIndexX, pageIndexY) {\r\n        var page = {\r\n            pageX: pageIndexX,\r\n            pageY: pageIndexY,\r\n        };\r\n        if (this.loopX) {\r\n            page.pageX = pageIndexX + 1;\r\n        }\r\n        if (this.loopY) {\r\n            page.pageY = pageIndexY + 1;\r\n        }\r\n        var _a = this.pagesMatrix.getPageStats(page.pageX, page.pageY), x = _a.x, y = _a.y;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n            pageX: pageIndexX,\r\n            pageY: pageIndexY,\r\n        };\r\n    };\r\n    SlidePages.prototype.getWillChangedPage = function (page) {\r\n        page = extend({}, page);\r\n        // Page need fix\r\n        if (this.loopX) {\r\n            page.pageX = this.fixedPage(page.pageX, this.pagesMatrix.pageLengthOfX - 2);\r\n            page.x = this.pagesMatrix.getPageStats(page.pageX + 1, 0).x;\r\n        }\r\n        if (this.loopY) {\r\n            page.pageY = this.fixedPage(page.pageY, this.pagesMatrix.pageLengthOfY - 2);\r\n            page.y = this.pagesMatrix.getPageStats(0, page.pageY + 1).y;\r\n        }\r\n        return page;\r\n    };\r\n    SlidePages.prototype.fixedPage = function (page, realPageLen) {\r\n        var pageIndex = [];\r\n        for (var i = 0; i < realPageLen; i++) {\r\n            pageIndex.push(i);\r\n        }\r\n        pageIndex.unshift(realPageLen - 1);\r\n        pageIndex.push(0);\r\n        return pageIndex[page];\r\n    };\r\n    SlidePages.prototype.getPageStats = function () {\r\n        return this.pagesMatrix.getPageStats(this.currentPage.pageX, this.currentPage.pageY);\r\n    };\r\n    SlidePages.prototype.getValidPageIndex = function (x, y) {\r\n        var lastX = this.pagesMatrix.pageLengthOfX - 1;\r\n        var lastY = this.pagesMatrix.pageLengthOfY - 1;\r\n        var firstX = 0;\r\n        var firstY = 0;\r\n        if (this.loopX) {\r\n            x += 1;\r\n            firstX = firstX + 1;\r\n            lastX = lastX - 1;\r\n        }\r\n        if (this.loopY) {\r\n            y += 1;\r\n            firstY = firstY + 1;\r\n            lastY = lastY - 1;\r\n        }\r\n        x = between(x, firstX, lastX);\r\n        y = between(y, firstY, lastY);\r\n        return {\r\n            pageX: x,\r\n            pageY: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.nextPageIndex = function () {\r\n        return this.getPageIndexByDirection(\"positive\" /* Positive */);\r\n    };\r\n    SlidePages.prototype.prevPageIndex = function () {\r\n        return this.getPageIndexByDirection(\"negative\" /* Negative */);\r\n    };\r\n    SlidePages.prototype.getNearestPage = function (x, y) {\r\n        var pageIndex = this.pagesMatrix.getNearestPageIndex(x, y);\r\n        var pageX = pageIndex.pageX, pageY = pageIndex.pageY;\r\n        var newX = this.pagesMatrix.getPageStats(pageX, 0).x;\r\n        var newY = this.pagesMatrix.getPageStats(0, pageY).y;\r\n        return {\r\n            x: newX,\r\n            y: newY,\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n        };\r\n    };\r\n    SlidePages.prototype.getPageByDirection = function (page, directionX, directionY) {\r\n        var pageX = page.pageX, pageY = page.pageY;\r\n        if (pageX === this.currentPage.pageX) {\r\n            pageX = between(pageX + directionX, 0, this.pagesMatrix.pageLengthOfX - 1);\r\n        }\r\n        if (pageY === this.currentPage.pageY) {\r\n            pageY = between(pageY + directionY, 0, this.pagesMatrix.pageLengthOfY - 1);\r\n        }\r\n        var x = this.pagesMatrix.getPageStats(pageX, 0).x;\r\n        var y = this.pagesMatrix.getPageStats(0, pageY).y;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n            pageX: pageX,\r\n            pageY: pageY,\r\n        };\r\n    };\r\n    SlidePages.prototype.resetLoopPage = function () {\r\n        if (this.loopX) {\r\n            if (this.currentPage.pageX === 0) {\r\n                return {\r\n                    pageX: this.pagesMatrix.pageLengthOfX - 2,\r\n                    pageY: this.currentPage.pageY,\r\n                };\r\n            }\r\n            if (this.currentPage.pageX === this.pagesMatrix.pageLengthOfX - 1) {\r\n                return {\r\n                    pageX: 1,\r\n                    pageY: this.currentPage.pageY,\r\n                };\r\n            }\r\n        }\r\n        if (this.loopY) {\r\n            if (this.currentPage.pageY === 0) {\r\n                return {\r\n                    pageX: this.currentPage.pageX,\r\n                    pageY: this.pagesMatrix.pageLengthOfY - 2,\r\n                };\r\n            }\r\n            if (this.currentPage.pageY === this.pagesMatrix.pageLengthOfY - 1) {\r\n                return {\r\n                    pageX: this.currentPage.pageX,\r\n                    pageY: 1,\r\n                };\r\n            }\r\n        }\r\n    };\r\n    SlidePages.prototype.getPageIndexByDirection = function (direction) {\r\n        var x = this.currentPage.pageX;\r\n        var y = this.currentPage.pageY;\r\n        if (this.slideX) {\r\n            x = direction === \"negative\" /* Negative */ ? x - 1 : x + 1;\r\n        }\r\n        if (this.slideY) {\r\n            y = direction === \"negative\" /* Negative */ ? y - 1 : y + 1;\r\n        }\r\n        return {\r\n            pageX: x,\r\n            pageY: y,\r\n        };\r\n    };\r\n    SlidePages.prototype.checkSlideLoop = function () {\r\n        this.wannaLoop = this.slideOptions.loop;\r\n        if (this.pagesMatrix.pageLengthOfX > 1) {\r\n            this.slideX = true;\r\n        }\r\n        else {\r\n            this.slideX = false;\r\n        }\r\n        if (this.pagesMatrix.pages[0] && this.pagesMatrix.pageLengthOfY > 1) {\r\n            this.slideY = true;\r\n        }\r\n        else {\r\n            this.slideY = false;\r\n        }\r\n        this.loopX = this.wannaLoop && this.slideX;\r\n        this.loopY = this.wannaLoop && this.slideY;\r\n        if (this.slideX && this.slideY) {\r\n            warn('slide does not support two direction at the same time.');\r\n        }\r\n    };\r\n    return SlidePages;\r\n}());\n\nvar sourcePrefix$4 = 'plugins.slide';\r\nvar propertiesMap$4 = [\r\n    {\r\n        key: 'next',\r\n        name: 'next',\r\n    },\r\n    {\r\n        key: 'prev',\r\n        name: 'prev',\r\n    },\r\n    {\r\n        key: 'goToPage',\r\n        name: 'goToPage',\r\n    },\r\n    {\r\n        key: 'getCurrentPage',\r\n        name: 'getCurrentPage',\r\n    },\r\n    {\r\n        key: 'startPlay',\r\n        name: 'startPlay',\r\n    },\r\n    {\r\n        key: 'pausePlay',\r\n        name: 'pausePlay',\r\n    },\r\n];\r\nvar propertiesConfig$4 = propertiesMap$4.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$4 + \".\" + item.name,\r\n    };\r\n});\n\nvar samePage = function (p1, p2) {\r\n    return p1.pageX === p2.pageX && p1.pageY === p2.pageY;\r\n};\r\nvar Slide = /** @class */ (function () {\r\n    function Slide(scroll) {\r\n        this.scroll = scroll;\r\n        this.cachedClonedPageDOM = [];\r\n        this.resetLooping = false;\r\n        this.autoplayTimer = 0;\r\n        if (!this.satisfyInitialization()) {\r\n            return;\r\n        }\r\n        this.init();\r\n    }\r\n    Slide.prototype.satisfyInitialization = function () {\r\n        if (this.scroll.scroller.content.children.length <= 0) {\r\n            warn(\"slide need at least one slide page to be initialised.\" +\r\n                \"please check your DOM layout.\");\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    Slide.prototype.init = function () {\r\n        this.willChangeToPage = extend({}, BASE_PAGE);\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.createPages();\r\n    };\r\n    Slide.prototype.createPages = function () {\r\n        this.pages = new SlidePages(this.scroll, this.options);\r\n    };\r\n    Slide.prototype.handleBScroll = function () {\r\n        this.scroll.registerType(['slideWillChange', 'slidePageChanged']);\r\n        this.scroll.proxy(propertiesConfig$4);\r\n    };\r\n    Slide.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.slide === true\r\n            ? {}\r\n            : this.scroll.options.slide);\r\n        var defaultOptions = {\r\n            loop: true,\r\n            threshold: 0.1,\r\n            speed: 400,\r\n            easing: ease.bounce,\r\n            listenFlick: true,\r\n            autoplay: true,\r\n            interval: 3000,\r\n            startPageXIndex: 0,\r\n            startPageYIndex: 0,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    Slide.prototype.handleLoop = function (prevSlideContent) {\r\n        var loop = this.options.loop;\r\n        var slideContent = this.scroll.scroller.content;\r\n        var currentSlidePagesLength = slideContent.children.length;\r\n        // only should respect loop scene\r\n        if (loop) {\r\n            if (slideContent !== prevSlideContent) {\r\n                this.resetLoopChangedStatus();\r\n                this.removeClonedSlidePage(prevSlideContent);\r\n                currentSlidePagesLength > 1 &&\r\n                    this.cloneFirstAndLastSlidePage(slideContent);\r\n            }\r\n            else {\r\n                // many pages reduce to one page\r\n                if (currentSlidePagesLength === 3 && this.initialised) {\r\n                    this.removeClonedSlidePage(slideContent);\r\n                    this.moreToOnePageInLoop = true;\r\n                    this.oneToMorePagesInLoop = false;\r\n                }\r\n                else if (currentSlidePagesLength > 1) {\r\n                    // one page increases to many page\r\n                    if (this.initialised && this.cachedClonedPageDOM.length === 0) {\r\n                        this.oneToMorePagesInLoop = true;\r\n                        this.moreToOnePageInLoop = false;\r\n                    }\r\n                    else {\r\n                        this.removeClonedSlidePage(slideContent);\r\n                        this.resetLoopChangedStatus();\r\n                    }\r\n                    this.cloneFirstAndLastSlidePage(slideContent);\r\n                }\r\n                else {\r\n                    this.resetLoopChangedStatus();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Slide.prototype.resetLoopChangedStatus = function () {\r\n        this.moreToOnePageInLoop = false;\r\n        this.oneToMorePagesInLoop = false;\r\n    };\r\n    Slide.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scrollHooks = this.scroll.hooks;\r\n        var scrollerHooks = this.scroll.scroller.hooks;\r\n        var listenFlick = this.options.listenFlick;\r\n        this.prevContent = this.scroll.scroller.content;\r\n        this.hooksFn = [];\r\n        // scroll\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.beforeScrollStart, this.pausePlay);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.modifyCurrentPage);\r\n        this.registerHooks(this.scroll, this.scroll.eventTypes.scrollEnd, this.startPlay);\r\n        // for mousewheel event\r\n        if (this.scroll.eventTypes.mousewheelMove) {\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelMove, function () {\r\n                // prevent default action of mousewheelMove\r\n                return true;\r\n            });\r\n            this.registerHooks(this.scroll, this.scroll.eventTypes.mousewheelEnd, function (delta) {\r\n                if (delta.directionX === 1 /* Positive */ ||\r\n                    delta.directionY === 1 /* Positive */) {\r\n                    _this.next();\r\n                }\r\n                if (delta.directionX === -1 /* Negative */ ||\r\n                    delta.directionY === -1 /* Negative */) {\r\n                    _this.prev();\r\n                }\r\n            });\r\n        }\r\n        // scrollHooks\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refreshHandler);\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.destroy, this.destroy);\r\n        // scroller\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.beforeRefresh, function () {\r\n            _this.handleLoop(_this.prevContent);\r\n            _this.setSlideInlineStyle();\r\n        });\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.momentum, this.modifyScrollMetaHandler);\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.scroll, this.scrollHandler);\r\n        // a click operation will clearTimer, so restart a new one\r\n        this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.checkClick, this.startPlay);\r\n        if (listenFlick) {\r\n            this.registerHooks(scrollerHooks, scrollerHooks.eventTypes.flick, this.flickHandler);\r\n        }\r\n    };\r\n    Slide.prototype.startPlay = function () {\r\n        var _this = this;\r\n        var _a = this.options, interval = _a.interval, autoplay = _a.autoplay;\r\n        if (autoplay) {\r\n            clearTimeout(this.autoplayTimer);\r\n            this.autoplayTimer = window.setTimeout(function () {\r\n                _this.next();\r\n            }, interval);\r\n        }\r\n    };\r\n    Slide.prototype.pausePlay = function () {\r\n        if (this.options.autoplay) {\r\n            clearTimeout(this.autoplayTimer);\r\n        }\r\n    };\r\n    Slide.prototype.setSlideInlineStyle = function () {\r\n        var styleConfigurations = [\r\n            {\r\n                direction: 'scrollX',\r\n                sizeType: 'offsetWidth',\r\n                styleType: 'width',\r\n            },\r\n            {\r\n                direction: 'scrollY',\r\n                sizeType: 'offsetHeight',\r\n                styleType: 'height',\r\n            },\r\n        ];\r\n        var _a = this.scroll.scroller, slideContent = _a.content, slideWrapper = _a.wrapper;\r\n        var scrollOptions = this.scroll.options;\r\n        styleConfigurations.forEach(function (_a) {\r\n            var direction = _a.direction, sizeType = _a.sizeType, styleType = _a.styleType;\r\n            // wanna scroll in this direction\r\n            if (scrollOptions[direction]) {\r\n                var size = slideWrapper[sizeType];\r\n                var children = slideContent.children;\r\n                var length_1 = children.length;\r\n                for (var i = 0; i < length_1; i++) {\r\n                    var slidePageDOM = children[i];\r\n                    slidePageDOM.style[styleType] = size + 'px';\r\n                }\r\n                slideContent.style[styleType] = size * length_1 + 'px';\r\n            }\r\n        });\r\n    };\r\n    Slide.prototype.next = function (time, easing) {\r\n        var _a = this.pages.nextPageIndex(), pageX = _a.pageX, pageY = _a.pageY;\r\n        this.goTo(pageX, pageY, time, easing);\r\n    };\r\n    Slide.prototype.prev = function (time, easing) {\r\n        var _a = this.pages.prevPageIndex(), pageX = _a.pageX, pageY = _a.pageY;\r\n        this.goTo(pageX, pageY, time, easing);\r\n    };\r\n    Slide.prototype.goToPage = function (pageX, pageY, time, easing) {\r\n        var pageIndex = this.pages.getValidPageIndex(pageX, pageY);\r\n        this.goTo(pageIndex.pageX, pageIndex.pageY, time, easing);\r\n    };\r\n    Slide.prototype.getCurrentPage = function () {\r\n        return this.exposedPage || this.pages.getInitialPage(false, true);\r\n    };\r\n    Slide.prototype.setCurrentPage = function (page) {\r\n        this.pages.setCurrentPage(page);\r\n        this.exposedPage = this.pages.getExposedPage(page);\r\n    };\r\n    Slide.prototype.nearestPage = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var maxScrollPosX = scrollBehaviorX.maxScrollPos, minScrollPosX = scrollBehaviorX.minScrollPos;\r\n        var maxScrollPosY = scrollBehaviorY.maxScrollPos, minScrollPosY = scrollBehaviorY.minScrollPos;\r\n        return this.pages.getNearestPage(between(x, maxScrollPosX, minScrollPosX), between(y, maxScrollPosY, minScrollPosY));\r\n    };\r\n    Slide.prototype.satisfyThreshold = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var satisfied = true;\r\n        if (Math.abs(x - scrollBehaviorX.absStartPos) <= this.thresholdX &&\r\n            Math.abs(y - scrollBehaviorY.absStartPos) <= this.thresholdY) {\r\n            satisfied = false;\r\n        }\r\n        return satisfied;\r\n    };\r\n    Slide.prototype.refreshHandler = function (content) {\r\n        var _this = this;\r\n        if (!this.satisfyInitialization()) {\r\n            return;\r\n        }\r\n        this.pages.refresh();\r\n        this.computeThreshold();\r\n        var contentChanged = (this.contentChanged = this.prevContent !== content);\r\n        if (contentChanged) {\r\n            this.prevContent = content;\r\n        }\r\n        var initPage = this.pages.getInitialPage(this.oneToMorePagesInLoop || this.moreToOnePageInLoop, contentChanged || !this.initialised);\r\n        if (this.initialised) {\r\n            this.goTo(initPage.pageX, initPage.pageY, 0);\r\n        }\r\n        else {\r\n            this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\r\n                _this.initialised = true;\r\n                position.x = initPage.x;\r\n                position.y = initPage.y;\r\n            });\r\n        }\r\n        this.startPlay();\r\n    };\r\n    Slide.prototype.computeThreshold = function () {\r\n        var threshold = this.options.threshold;\r\n        // Integer\r\n        if (threshold % 1 === 0) {\r\n            this.thresholdX = threshold;\r\n            this.thresholdY = threshold;\r\n        }\r\n        else {\r\n            // decimal\r\n            var _a = this.pages.getPageStats(), width = _a.width, height = _a.height;\r\n            this.thresholdX = Math.round(width * threshold);\r\n            this.thresholdY = Math.round(height * threshold);\r\n        }\r\n    };\r\n    Slide.prototype.cloneFirstAndLastSlidePage = function (slideContent) {\r\n        var children = slideContent.children;\r\n        var preprendDOM = children[children.length - 1].cloneNode(true);\r\n        var appendDOM = children[0].cloneNode(true);\r\n        prepend(preprendDOM, slideContent);\r\n        slideContent.appendChild(appendDOM);\r\n        this.cachedClonedPageDOM = [preprendDOM, appendDOM];\r\n    };\r\n    Slide.prototype.removeClonedSlidePage = function (slideContent) {\r\n        // maybe slideContent has removed from DOM Tree\r\n        var slidePages = (slideContent && slideContent.children) || [];\r\n        if (slidePages.length) {\r\n            this.cachedClonedPageDOM.forEach(function (el) {\r\n                removeChild(slideContent, el);\r\n            });\r\n        }\r\n        this.cachedClonedPageDOM = [];\r\n    };\r\n    Slide.prototype.modifyCurrentPage = function (point) {\r\n        var _a = this.getCurrentPage(), prevExposedPageX = _a.pageX, prevExposedPageY = _a.pageY;\r\n        var newPage = this.nearestPage(point.x, point.y);\r\n        this.setCurrentPage(newPage);\r\n        /* istanbul ignore if */\r\n        if (this.contentChanged) {\r\n            this.contentChanged = false;\r\n            return true;\r\n        }\r\n        var _b = this.getCurrentPage(), currentExposedPageX = _b.pageX, currentExposedPageY = _b.pageY;\r\n        this.pageWillChangeTo(newPage);\r\n        // loop is true, and one page becomes many pages when call bs.refresh\r\n        if (this.oneToMorePagesInLoop) {\r\n            this.oneToMorePagesInLoop = false;\r\n            return true;\r\n        }\r\n        // loop is true, and many page becomes one page when call bs.refresh\r\n        // if prevPage > 0, dispatch slidePageChanged and scrollEnd events\r\n        /* istanbul ignore if */\r\n        if (this.moreToOnePageInLoop &&\r\n            prevExposedPageX === 0 &&\r\n            prevExposedPageY === 0) {\r\n            this.moreToOnePageInLoop = false;\r\n            return true;\r\n        }\r\n        if (prevExposedPageX !== currentExposedPageX ||\r\n            prevExposedPageY !== currentExposedPageY) {\r\n            // only trust pageX & pageY when loop is true\r\n            var page = this.pages.getExposedPageByPageIndex(currentExposedPageX, currentExposedPageY);\r\n            this.scroll.trigger(this.scroll.eventTypes.slidePageChanged, page);\r\n        }\r\n        // triggered by resetLoop\r\n        if (this.resetLooping) {\r\n            this.resetLooping = false;\r\n            return;\r\n        }\r\n        var changePage = this.pages.resetLoopPage();\r\n        if (changePage) {\r\n            this.resetLooping = true;\r\n            this.goTo(changePage.pageX, changePage.pageY, 0);\r\n            // stop user's scrollEnd\r\n            // since it is a seamless scroll\r\n            return true;\r\n        }\r\n    };\r\n    Slide.prototype.goTo = function (pageX, pageY, time, easing) {\r\n        var newPage = this.pages.getInternalPage(pageX, pageY);\r\n        var scrollEasing = easing || this.options.easing || ease.bounce;\r\n        var x = newPage.x, y = newPage.y;\r\n        var deltaX = x - this.scroll.scroller.scrollBehaviorX.currentPos;\r\n        var deltaY = y - this.scroll.scroller.scrollBehaviorY.currentPos;\r\n        /* istanbul ignore if */\r\n        if (!deltaX && !deltaY) {\r\n            this.scroll.scroller.togglePointerEvents(true);\r\n            return;\r\n        }\r\n        time = time === undefined ? this.getEaseTime(deltaX, deltaY) : time;\r\n        this.scroll.scroller.scrollTo(x, y, time, scrollEasing);\r\n    };\r\n    Slide.prototype.flickHandler = function () {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var currentPosX = scrollBehaviorX.currentPos, startPosX = scrollBehaviorX.startPos, directionX = scrollBehaviorX.direction;\r\n        var currentPosY = scrollBehaviorY.currentPos, startPosY = scrollBehaviorY.startPos, directionY = scrollBehaviorY.direction;\r\n        var _b = this.pages.currentPage, pageX = _b.pageX, pageY = _b.pageY;\r\n        var time = this.getEaseTime(currentPosX - startPosX, currentPosY - startPosY);\r\n        this.goTo(pageX + directionX, pageY + directionY, time);\r\n    };\r\n    Slide.prototype.getEaseTime = function (deltaX, deltaY) {\r\n        return (this.options.speed ||\r\n            Math.max(Math.max(Math.min(Math.abs(deltaX), 1000), Math.min(Math.abs(deltaY), 1000)), 300));\r\n    };\r\n    Slide.prototype.modifyScrollMetaHandler = function (scrollMeta) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY, animater = _a.animater;\r\n        var newX = scrollMeta.newX;\r\n        var newY = scrollMeta.newY;\r\n        var newPage = this.satisfyThreshold(newX, newY) || animater.forceStopped\r\n            ? this.pages.getPageByDirection(this.nearestPage(newX, newY), scrollBehaviorX.direction, scrollBehaviorY.direction)\r\n            : this.pages.currentPage;\r\n        scrollMeta.time = this.getEaseTime(scrollMeta.newX - newPage.x, scrollMeta.newY - newPage.y);\r\n        scrollMeta.newX = newPage.x;\r\n        scrollMeta.newY = newPage.y;\r\n        scrollMeta.easing = this.options.easing || ease.bounce;\r\n    };\r\n    Slide.prototype.scrollHandler = function (_a) {\r\n        var x = _a.x, y = _a.y;\r\n        if (this.satisfyThreshold(x, y)) {\r\n            var newPage = this.nearestPage(x, y);\r\n            this.pageWillChangeTo(newPage);\r\n        }\r\n    };\r\n    Slide.prototype.pageWillChangeTo = function (newPage) {\r\n        var changeToPage = this.pages.getWillChangedPage(newPage);\r\n        if (!samePage(this.willChangeToPage, changeToPage)) {\r\n            this.willChangeToPage = changeToPage;\r\n            this.scroll.trigger(this.scroll.eventTypes.slideWillChange, this.willChangeToPage);\r\n        }\r\n    };\r\n    Slide.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Slide.prototype.destroy = function () {\r\n        var slideContent = this.scroll.scroller.content;\r\n        var _a = this.options, loop = _a.loop, autoplay = _a.autoplay;\r\n        if (loop) {\r\n            this.removeClonedSlidePage(slideContent);\r\n        }\r\n        if (autoplay) {\r\n            clearTimeout(this.autoplayTimer);\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            if (hooks.eventTypes[hooksName]) {\r\n                hooks.off(hooksName, handlerFn);\r\n            }\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Slide.pluginName = 'slide';\r\n    return Slide;\r\n}());\n\nvar sourcePrefix$3 = 'plugins.wheel';\r\nvar propertiesMap$3 = [\r\n    {\r\n        key: 'wheelTo',\r\n        name: 'wheelTo',\r\n    },\r\n    {\r\n        key: 'getSelectedIndex',\r\n        name: 'getSelectedIndex',\r\n    },\r\n    {\r\n        key: 'restorePosition',\r\n        name: 'restorePosition',\r\n    },\r\n];\r\nvar propertiesConfig$3 = propertiesMap$3.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$3 + \".\" + item.name,\r\n    };\r\n});\n\nvar WHEEL_INDEX_CHANGED_EVENT_NAME = 'wheelIndexChanged';\r\nvar CONSTANTS = {\r\n    rate: 4\r\n};\r\nvar Wheel = /** @class */ (function () {\r\n    function Wheel(scroll) {\r\n        this.scroll = scroll;\r\n        this.init();\r\n    }\r\n    Wheel.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        // init boundary for Wheel\r\n        this.refreshBoundary();\r\n        this.setSelectedIndex(this.options.selectedIndex);\r\n    };\r\n    Wheel.prototype.handleBScroll = function () {\r\n        this.scroll.proxy(propertiesConfig$3);\r\n        this.scroll.registerType([WHEEL_INDEX_CHANGED_EVENT_NAME]);\r\n    };\r\n    Wheel.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.wheel === true\r\n            ? {}\r\n            : this.scroll.options.wheel);\r\n        var defaultOptions = {\r\n            wheelWrapperClass: 'wheel-scroll',\r\n            wheelItemClass: 'wheel-item',\r\n            rotate: 25,\r\n            adjustTime: 400,\r\n            selectedIndex: 0,\r\n            wheelDisabledItemClass: 'wheel-disabled-item'\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    Wheel.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        var scroller = this.scroll.scroller;\r\n        var actionsHandler = scroller.actionsHandler, scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY, animater = scroller.animater;\r\n        var prevContent = scroller.content;\r\n        // BScroll\r\n        scroll.on(scroll.eventTypes.scrollEnd, function (position) {\r\n            var index = _this.findNearestValidWheel(position.y).index;\r\n            if (scroller.animater.forceStopped && !_this.isAdjustingPosition) {\r\n                _this.target = _this.items[index];\r\n                // since stopped from an animation.\r\n                // prevent user's scrollEnd callback triggered twice\r\n                return true;\r\n            }\r\n            else {\r\n                _this.setSelectedIndex(index);\r\n                if (_this.isAdjustingPosition) {\r\n                    _this.isAdjustingPosition = false;\r\n                }\r\n            }\r\n        });\r\n        // BScroll.hooks\r\n        this.scroll.hooks.on(this.scroll.hooks.eventTypes.refresh, function (content) {\r\n            if (content !== prevContent) {\r\n                prevContent = content;\r\n                _this.setSelectedIndex(_this.options.selectedIndex, true);\r\n            }\r\n            // rotate all wheel-items\r\n            // because position may not change\r\n            _this.rotateX(_this.scroll.y);\r\n            // check we are stop at a disable item or not\r\n            _this.wheelTo(_this.selectedIndex, 0);\r\n        });\r\n        this.scroll.hooks.on(this.scroll.hooks.eventTypes.beforeInitialScrollTo, function (position) {\r\n            // selectedIndex has higher priority than bs.options.startY\r\n            position.x = 0;\r\n            position.y = -(_this.selectedIndex * _this.itemHeight);\r\n        });\r\n        // Scroller\r\n        scroller.hooks.on(scroller.hooks.eventTypes.checkClick, function () {\r\n            var index = HTMLCollectionToArray(_this.items).indexOf(_this.target);\r\n            if (index === -1)\r\n                return true;\r\n            _this.wheelTo(index, _this.options.adjustTime, ease.swipe);\r\n            return true;\r\n        });\r\n        scroller.hooks.on(scroller.hooks.eventTypes.scrollTo, function (endPoint) {\r\n            endPoint.y = _this.findNearestValidWheel(endPoint.y).y;\r\n        });\r\n        // when content is scrolling\r\n        // click wheel-item DOM repeatedly and crazily will cause scrollEnd not triggered\r\n        // so reset forceStopped\r\n        scroller.hooks.on(scroller.hooks.eventTypes.minDistanceScroll, function () {\r\n            var animater = scroller.animater;\r\n            if (animater.forceStopped === true) {\r\n                animater.forceStopped = false;\r\n            }\r\n        });\r\n        scroller.hooks.on(scroller.hooks.eventTypes.scrollToElement, function (el, pos) {\r\n            if (!hasClass(el, _this.options.wheelItemClass)) {\r\n                return true;\r\n            }\r\n            else {\r\n                pos.top = _this.findNearestValidWheel(pos.top).y;\r\n            }\r\n        });\r\n        // ActionsHandler\r\n        actionsHandler.hooks.on(actionsHandler.hooks.eventTypes.beforeStart, function (e) {\r\n            _this.target = e.target;\r\n        });\r\n        // ScrollBehaviorX\r\n        // Wheel has no x direction now\r\n        scrollBehaviorX.hooks.on(scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            boundary.maxScrollPos = 0;\r\n            boundary.minScrollPos = 0;\r\n        });\r\n        // ScrollBehaviorY\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            _this.items = _this.scroll.scroller.content.children;\r\n            _this.checkWheelAllDisabled();\r\n            _this.itemHeight =\r\n                _this.items.length > 0\r\n                    ? scrollBehaviorY.contentSize / _this.items.length\r\n                    : 0;\r\n            boundary.maxScrollPos = -_this.itemHeight * (_this.items.length - 1);\r\n            boundary.minScrollPos = 0;\r\n        });\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.momentum, function (momentumInfo) {\r\n            momentumInfo.rate = CONSTANTS.rate;\r\n            momentumInfo.destination = _this.findNearestValidWheel(momentumInfo.destination).y;\r\n        });\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.end, function (momentumInfo) {\r\n            var validWheel = _this.findNearestValidWheel(scrollBehaviorY.currentPos);\r\n            momentumInfo.destination = validWheel.y;\r\n            momentumInfo.duration = _this.options.adjustTime;\r\n        });\r\n        // Animater\r\n        animater.hooks.on(animater.hooks.eventTypes.time, function (time) {\r\n            _this.transitionDuration(time);\r\n        });\r\n        animater.hooks.on(animater.hooks.eventTypes.timeFunction, function (easing) {\r\n            _this.timeFunction(easing);\r\n        });\r\n        // bs.stop() to make wheel stop at a correct position when pending\r\n        animater.hooks.on(animater.hooks.eventTypes.callStop, function () {\r\n            var index = _this.findNearestValidWheel(_this.scroll.y).index;\r\n            _this.isAdjustingPosition = true;\r\n            _this.wheelTo(index, 0);\r\n        });\r\n        // Translater\r\n        animater.translater.hooks.on(animater.translater.hooks.eventTypes.translate, function (endPoint) {\r\n            _this.rotateX(endPoint.y);\r\n        });\r\n    };\r\n    Wheel.prototype.refreshBoundary = function () {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY, content = _a.content;\r\n        scrollBehaviorX.refresh(content);\r\n        scrollBehaviorY.refresh(content);\r\n    };\r\n    Wheel.prototype.setSelectedIndex = function (index, contentChanged) {\r\n        if (contentChanged === void 0) { contentChanged = false; }\r\n        var prevSelectedIndex = this.selectedIndex;\r\n        this.selectedIndex = index;\r\n        // if content DOM changed, should not trigger event\r\n        if (prevSelectedIndex !== index && !contentChanged) {\r\n            this.scroll.trigger(WHEEL_INDEX_CHANGED_EVENT_NAME, index);\r\n        }\r\n    };\r\n    Wheel.prototype.getSelectedIndex = function () {\r\n        return this.selectedIndex;\r\n    };\r\n    Wheel.prototype.wheelTo = function (index, time, ease) {\r\n        if (index === void 0) { index = 0; }\r\n        if (time === void 0) { time = 0; }\r\n        var y = -index * this.itemHeight;\r\n        this.scroll.scrollTo(0, y, time, ease);\r\n    };\r\n    Wheel.prototype.restorePosition = function () {\r\n        // bs is scrolling\r\n        var isPending = this.scroll.pending;\r\n        if (isPending) {\r\n            var selectedIndex = this.getSelectedIndex();\r\n            this.scroll.scroller.animater.clearTimer();\r\n            this.wheelTo(selectedIndex, 0);\r\n        }\r\n    };\r\n    Wheel.prototype.transitionDuration = function (time) {\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            this.items[i].style[style.transitionDuration] =\r\n                time + 'ms';\r\n        }\r\n    };\r\n    Wheel.prototype.timeFunction = function (easing) {\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            this.items[i].style[style.transitionTimingFunction] = easing;\r\n        }\r\n    };\r\n    Wheel.prototype.rotateX = function (y) {\r\n        var _a = this.options.rotate, rotate = _a === void 0 ? 25 : _a;\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            var deg = rotate * (y / this.itemHeight + i);\r\n            // Too small value is invalid in some phones, issue 1026\r\n            var SafeDeg = deg.toFixed(3);\r\n            this.items[i].style[style.transform] = \"rotateX(\" + SafeDeg + \"deg)\";\r\n        }\r\n    };\r\n    Wheel.prototype.findNearestValidWheel = function (y) {\r\n        y = y > 0 ? 0 : y < this.scroll.maxScrollY ? this.scroll.maxScrollY : y;\r\n        var currentIndex = Math.abs(Math.round(-y / this.itemHeight));\r\n        var cacheIndex = currentIndex;\r\n        var items = this.items;\r\n        var wheelDisabledItemClassName = this.options\r\n            .wheelDisabledItemClass;\r\n        // implement web native select element\r\n        // first, check whether there is a enable item whose index is smaller than currentIndex\r\n        // then, check whether there is a enable item whose index is bigger than currentIndex\r\n        // otherwise, there are all disabled items, just keep currentIndex unchange\r\n        while (currentIndex >= 0) {\r\n            if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\r\n                break;\r\n            }\r\n            currentIndex--;\r\n        }\r\n        if (currentIndex < 0) {\r\n            currentIndex = cacheIndex;\r\n            while (currentIndex <= items.length - 1) {\r\n                if (!hasClass(items[currentIndex], wheelDisabledItemClassName)) {\r\n                    break;\r\n                }\r\n                currentIndex++;\r\n            }\r\n        }\r\n        // keep it unchange when all the items are disabled\r\n        if (currentIndex === items.length) {\r\n            currentIndex = cacheIndex;\r\n        }\r\n        // when all the items are disabled, selectedIndex should always be -1\r\n        return {\r\n            index: this.wheelItemsAllDisabled ? -1 : currentIndex,\r\n            y: -currentIndex * this.itemHeight\r\n        };\r\n    };\r\n    Wheel.prototype.checkWheelAllDisabled = function () {\r\n        var wheelDisabledItemClassName = this.options.wheelDisabledItemClass;\r\n        var items = this.items;\r\n        this.wheelItemsAllDisabled = true;\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (!hasClass(items[i], wheelDisabledItemClassName)) {\r\n                this.wheelItemsAllDisabled = false;\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    Wheel.pluginName = 'wheel';\r\n    return Wheel;\r\n}());\n\nvar sourcePrefix$2 = 'plugins.zoom';\r\nvar propertiesMap$2 = [\r\n    {\r\n        key: 'zoomTo',\r\n        name: 'zoomTo'\r\n    }\r\n];\r\nvar propertiesConfig$2 = propertiesMap$2.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$2 + \".\" + item.name\r\n    };\r\n});\n\nvar TWO_FINGERS = 2;\r\nvar RAW_SCALE = 1;\r\nvar Zoom = /** @class */ (function () {\r\n    function Zoom(scroll) {\r\n        this.scroll = scroll;\r\n        this.scale = RAW_SCALE;\r\n        this.prevScale = 1;\r\n        this.init();\r\n    }\r\n    Zoom.prototype.init = function () {\r\n        this.handleBScroll();\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n        this.tryInitialZoomTo(this.zoomOpt);\r\n    };\r\n    Zoom.prototype.zoomTo = function (scale, x, y, bounceTime) {\r\n        var _a = this.resolveOrigin(x, y), originX = _a.originX, originY = _a.originY;\r\n        var origin = {\r\n            x: originX,\r\n            y: originY,\r\n            baseScale: this.scale,\r\n        };\r\n        this._doZoomTo(scale, origin, bounceTime, true);\r\n    };\r\n    Zoom.prototype.handleBScroll = function () {\r\n        this.scroll.proxy(propertiesConfig$2);\r\n        this.scroll.registerType([\r\n            'beforeZoomStart',\r\n            'zoomStart',\r\n            'zooming',\r\n            'zoomEnd',\r\n        ]);\r\n    };\r\n    Zoom.prototype.handleOptions = function () {\r\n        var userOptions = (this.scroll.options.zoom === true\r\n            ? {}\r\n            : this.scroll.options.zoom);\r\n        var defaultOptions = {\r\n            start: 1,\r\n            min: 1,\r\n            max: 4,\r\n            initialOrigin: [0, 0],\r\n            minimalZoomDistance: 5,\r\n            bounceTime: 800,\r\n        };\r\n        this.zoomOpt = extend(defaultOptions, userOptions);\r\n    };\r\n    Zoom.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        var scroller = this.scroll.scroller;\r\n        this.wrapper = this.scroll.scroller.wrapper;\r\n        this.setTransformOrigin(this.scroll.scroller.content);\r\n        var scrollBehaviorX = scroller.scrollBehaviorX;\r\n        var scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.hooksFn = [];\r\n        // BScroll\r\n        this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.contentChanged, function (content) {\r\n            _this.setTransformOrigin(content);\r\n            _this.scale = RAW_SCALE;\r\n            _this.tryInitialZoomTo(_this.zoomOpt);\r\n        });\r\n        this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.beforeInitialScrollTo, function () {\r\n            // if perform a zoom action, we should prevent initial scroll when initialised\r\n            if (_this.zoomOpt.start !== RAW_SCALE) {\r\n                return true;\r\n            }\r\n        });\r\n        // enlarge boundary\r\n        this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.beforeComputeBoundary, function () {\r\n            // content may change, don't cache it's size\r\n            var contentSize = getRect(_this.scroll.scroller.content);\r\n            scrollBehaviorX.contentSize = Math.floor(contentSize.width * _this.scale);\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.beforeComputeBoundary, function () {\r\n            // content may change, don't cache it's size\r\n            var contentSize = getRect(_this.scroll.scroller.content);\r\n            scrollBehaviorY.contentSize = Math.floor(contentSize.height * _this.scale);\r\n        });\r\n        // touch event\r\n        this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.start, function (e) {\r\n            var numberOfFingers = (e.touches && e.touches.length) || 0;\r\n            _this.fingersOperation(numberOfFingers);\r\n            if (numberOfFingers === TWO_FINGERS) {\r\n                _this.zoomStart(e);\r\n            }\r\n        });\r\n        this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeMove, function (e) {\r\n            var numberOfFingers = (e.touches && e.touches.length) || 0;\r\n            _this.fingersOperation(numberOfFingers);\r\n            if (numberOfFingers === TWO_FINGERS) {\r\n                _this.zoom(e);\r\n                return true;\r\n            }\r\n        });\r\n        this.registerHooks(scroller.actions.hooks, scroller.actions.hooks.eventTypes.beforeEnd, function (e) {\r\n            var numberOfFingers = _this.fingersOperation();\r\n            if (numberOfFingers === TWO_FINGERS) {\r\n                _this.zoomEnd();\r\n                return true;\r\n            }\r\n        });\r\n        this.registerHooks(scroller.translater.hooks, scroller.translater.hooks.eventTypes.beforeTranslate, function (transformStyle, point) {\r\n            var scale = point.scale ? point.scale : _this.prevScale;\r\n            _this.prevScale = scale;\r\n            transformStyle.push(\"scale(\" + scale + \")\");\r\n        });\r\n        this.registerHooks(scroller.hooks, scroller.hooks.eventTypes.scrollEnd, function () {\r\n            if (_this.fingersOperation() === TWO_FINGERS) {\r\n                _this.scroll.trigger(_this.scroll.eventTypes.zoomEnd, {\r\n                    scale: _this.scale,\r\n                });\r\n            }\r\n        });\r\n        this.registerHooks(this.scroll.hooks, 'destroy', this.destroy);\r\n    };\r\n    Zoom.prototype.setTransformOrigin = function (content) {\r\n        content.style[style.transformOrigin] = '0 0';\r\n    };\r\n    Zoom.prototype.tryInitialZoomTo = function (options) {\r\n        var start = options.start, initialOrigin = options.initialOrigin;\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        if (start !== RAW_SCALE) {\r\n            // Movable plugin may wanna modify minScrollPos or maxScrollPos\r\n            // so we force Movable to caculate them\r\n            this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\r\n            this.zoomTo(start, initialOrigin[0], initialOrigin[1], 0);\r\n        }\r\n    };\r\n    // getter or setter operation\r\n    Zoom.prototype.fingersOperation = function (amounts) {\r\n        if (typeof amounts === 'number') {\r\n            this.numberOfFingers = amounts;\r\n        }\r\n        else {\r\n            return this.numberOfFingers;\r\n        }\r\n    };\r\n    Zoom.prototype._doZoomTo = function (scale, origin, time, useCurrentPos) {\r\n        var _this = this;\r\n        if (time === void 0) { time = this.zoomOpt.bounceTime; }\r\n        if (useCurrentPos === void 0) { useCurrentPos = false; }\r\n        var _a = this.zoomOpt, min = _a.min, max = _a.max;\r\n        var fromScale = this.scale;\r\n        var toScale = between(scale, min, max);\r\n        (function () {\r\n            if (time === 0) {\r\n                _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\r\n                    scale: toScale,\r\n                });\r\n                return;\r\n            }\r\n            if (time > 0) {\r\n                var timer_1;\r\n                var startTime_1 = getNow();\r\n                var endTime_1 = startTime_1 + time;\r\n                var scheduler_1 = function () {\r\n                    var now = getNow();\r\n                    if (now >= endTime_1) {\r\n                        _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\r\n                            scale: toScale,\r\n                        });\r\n                        cancelAnimationFrame(timer_1);\r\n                        return;\r\n                    }\r\n                    var ratio = ease.bounce.fn((now - startTime_1) / time);\r\n                    var currentScale = ratio * (toScale - fromScale) + fromScale;\r\n                    _this.scroll.trigger(_this.scroll.eventTypes.zooming, {\r\n                        scale: currentScale,\r\n                    });\r\n                    timer_1 = requestAnimationFrame(scheduler_1);\r\n                };\r\n                // start scheduler job\r\n                scheduler_1();\r\n            }\r\n        })();\r\n        // suppose you are zooming by two fingers\r\n        this.fingersOperation(2);\r\n        this._zoomTo(toScale, fromScale, origin, time, useCurrentPos);\r\n    };\r\n    Zoom.prototype._zoomTo = function (toScale, fromScale, origin, time, useCurrentPos) {\r\n        if (useCurrentPos === void 0) { useCurrentPos = false; }\r\n        var ratio = toScale / origin.baseScale;\r\n        this.setScale(toScale);\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\r\n        // position is restrained in boundary\r\n        var newX = this.getNewPos(origin.x, ratio, scrollBehaviorX, true, useCurrentPos);\r\n        var newY = this.getNewPos(origin.y, ratio, scrollBehaviorY, true, useCurrentPos);\r\n        if (scrollBehaviorX.currentPos !== Math.round(newX) ||\r\n            scrollBehaviorY.currentPos !== Math.round(newY) ||\r\n            toScale !== fromScale) {\r\n            scroller.scrollTo(newX, newY, time, ease.bounce, {\r\n                start: {\r\n                    scale: fromScale,\r\n                },\r\n                end: {\r\n                    scale: toScale,\r\n                },\r\n            });\r\n        }\r\n    };\r\n    Zoom.prototype.resolveOrigin = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var resolveFormula = {\r\n            left: function () {\r\n                return 0;\r\n            },\r\n            top: function () {\r\n                return 0;\r\n            },\r\n            right: function () {\r\n                return scrollBehaviorX.contentSize;\r\n            },\r\n            bottom: function () {\r\n                return scrollBehaviorY.contentSize;\r\n            },\r\n            center: function (index) {\r\n                var baseSize = index === 0\r\n                    ? scrollBehaviorX.contentSize\r\n                    : scrollBehaviorY.contentSize;\r\n                return baseSize / 2;\r\n            },\r\n        };\r\n        return {\r\n            originX: typeof x === 'number' ? x : resolveFormula[x](0),\r\n            originY: typeof y === 'number' ? y : resolveFormula[y](1),\r\n        };\r\n    };\r\n    Zoom.prototype.zoomStart = function (e) {\r\n        var firstFinger = e.touches[0];\r\n        var secondFinger = e.touches[1];\r\n        this.startDistance = this.getFingerDistance(e);\r\n        this.startScale = this.scale;\r\n        var _a = offsetToBody(this.wrapper), left = _a.left, top = _a.top;\r\n        this.origin = {\r\n            x: Math.abs(firstFinger.pageX + secondFinger.pageX) / 2 +\r\n                left -\r\n                this.scroll.x,\r\n            y: Math.abs(firstFinger.pageY + secondFinger.pageY) / 2 +\r\n                top -\r\n                this.scroll.y,\r\n            baseScale: this.startScale,\r\n        };\r\n        this.scroll.trigger(this.scroll.eventTypes.beforeZoomStart);\r\n    };\r\n    Zoom.prototype.zoom = function (e) {\r\n        var currentDistance = this.getFingerDistance(e);\r\n        // at least minimalZoomDistance pixels for the zoom to initiate\r\n        if (!this.zoomed &&\r\n            Math.abs(currentDistance - this.startDistance) <\r\n                this.zoomOpt.minimalZoomDistance) {\r\n            return;\r\n        }\r\n        // when out of boundary , perform a damping algorithm\r\n        var endScale = this.dampingScale((currentDistance / this.startDistance) * this.startScale);\r\n        var ratio = endScale / this.startScale;\r\n        this.setScale(endScale);\r\n        if (!this.zoomed) {\r\n            this.zoomed = true;\r\n            this.scroll.trigger(this.scroll.eventTypes.zoomStart);\r\n        }\r\n        var scroller = this.scroll.scroller;\r\n        var scrollBehaviorX = scroller.scrollBehaviorX, scrollBehaviorY = scroller.scrollBehaviorY;\r\n        var x = this.getNewPos(this.origin.x, ratio, scrollBehaviorX, false, false);\r\n        var y = this.getNewPos(this.origin.y, ratio, scrollBehaviorY, false, false);\r\n        this.scroll.trigger(this.scroll.eventTypes.zooming, {\r\n            scale: this.scale,\r\n        });\r\n        scroller.translater.translate({ x: x, y: y, scale: endScale });\r\n    };\r\n    Zoom.prototype.zoomEnd = function () {\r\n        if (!this.zoomed)\r\n            return;\r\n        // if out of boundary, do rebound!\r\n        if (this.shouldRebound()) {\r\n            this._doZoomTo(this.scale, this.origin, this.zoomOpt.bounceTime);\r\n            return;\r\n        }\r\n        this.scroll.trigger(this.scroll.eventTypes.zoomEnd, { scale: this.scale });\r\n    };\r\n    Zoom.prototype.getFingerDistance = function (e) {\r\n        var firstFinger = e.touches[0];\r\n        var secondFinger = e.touches[1];\r\n        var deltaX = Math.abs(firstFinger.pageX - secondFinger.pageX);\r\n        var deltaY = Math.abs(firstFinger.pageY - secondFinger.pageY);\r\n        return getDistance(deltaX, deltaY);\r\n    };\r\n    Zoom.prototype.shouldRebound = function () {\r\n        var _a = this.zoomOpt, min = _a.min, max = _a.max;\r\n        var currentScale = this.scale;\r\n        // scale exceeded!\r\n        if (currentScale !== between(currentScale, min, max)) {\r\n            return true;\r\n        }\r\n        var _b = this.scroll.scroller, scrollBehaviorX = _b.scrollBehaviorX, scrollBehaviorY = _b.scrollBehaviorY;\r\n        // enlarge boundaries manually when zoom is end\r\n        this.resetBoundaries([scrollBehaviorX, scrollBehaviorY]);\r\n        var xInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\r\n        var yInBoundary = scrollBehaviorX.checkInBoundary().inBoundary;\r\n        return !(xInBoundary && yInBoundary);\r\n    };\r\n    Zoom.prototype.dampingScale = function (scale) {\r\n        var _a = this.zoomOpt, min = _a.min, max = _a.max;\r\n        if (scale < min) {\r\n            scale = 0.5 * min * Math.pow(2.0, scale / min);\r\n        }\r\n        else if (scale > max) {\r\n            scale = 2.0 * max * Math.pow(0.5, max / scale);\r\n        }\r\n        return scale;\r\n    };\r\n    Zoom.prototype.setScale = function (scale) {\r\n        this.scale = scale;\r\n    };\r\n    Zoom.prototype.resetBoundaries = function (scrollBehaviorPairs) {\r\n        scrollBehaviorPairs.forEach(function (behavior) { return behavior.computeBoundary(); });\r\n    };\r\n    Zoom.prototype.getNewPos = function (origin, lastScale, scrollBehavior, shouldInBoundary, useCurrentPos) {\r\n        if (useCurrentPos === void 0) { useCurrentPos = false; }\r\n        var newPos = origin -\r\n            origin * lastScale +\r\n            (useCurrentPos ? scrollBehavior.currentPos : scrollBehavior.startPos);\r\n        if (shouldInBoundary) {\r\n            newPos = between(newPos, scrollBehavior.maxScrollPos, scrollBehavior.minScrollPos);\r\n        }\r\n        // maxScrollPos or minScrollPos maybe a negative or positive digital\r\n        return newPos > 0 ? Math.floor(newPos) : Math.ceil(newPos);\r\n    };\r\n    Zoom.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Zoom.prototype.destroy = function () {\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Zoom.pluginName = 'zoom';\r\n    return Zoom;\r\n}());\n\nvar BScrollFamily = /** @class */ (function () {\r\n    function BScrollFamily(scroll) {\r\n        this.ancestors = [];\r\n        this.descendants = [];\r\n        this.hooksManager = [];\r\n        this.analyzed = false;\r\n        this.selfScroll = scroll;\r\n    }\r\n    BScrollFamily.create = function (scroll) {\r\n        return new BScrollFamily(scroll);\r\n    };\r\n    BScrollFamily.prototype.hasAncestors = function (bscrollFamily) {\r\n        var index = findIndex(this.ancestors, function (_a) {\r\n            var item = _a[0];\r\n            return item === bscrollFamily;\r\n        });\r\n        return index > -1;\r\n    };\r\n    BScrollFamily.prototype.hasDescendants = function (bscrollFamily) {\r\n        var index = findIndex(this.descendants, function (_a) {\r\n            var item = _a[0];\r\n            return item === bscrollFamily;\r\n        });\r\n        return index > -1;\r\n    };\r\n    BScrollFamily.prototype.addAncestor = function (bscrollFamily, distance) {\r\n        var ancestors = this.ancestors;\r\n        ancestors.push([bscrollFamily, distance]);\r\n        // by ascend\r\n        ancestors.sort(function (a, b) {\r\n            return a[1] - b[1];\r\n        });\r\n    };\r\n    BScrollFamily.prototype.addDescendant = function (bscrollFamily, distance) {\r\n        var descendants = this.descendants;\r\n        descendants.push([bscrollFamily, distance]);\r\n        // by ascend\r\n        descendants.sort(function (a, b) {\r\n            return a[1] - b[1];\r\n        });\r\n    };\r\n    BScrollFamily.prototype.removeAncestor = function (bscrollFamily) {\r\n        var ancestors = this.ancestors;\r\n        if (ancestors.length) {\r\n            var index = findIndex(this.ancestors, function (_a) {\r\n                var item = _a[0];\r\n                return item === bscrollFamily;\r\n            });\r\n            if (index > -1) {\r\n                return ancestors.splice(index, 1);\r\n            }\r\n        }\r\n    };\r\n    BScrollFamily.prototype.removeDescendant = function (bscrollFamily) {\r\n        var descendants = this.descendants;\r\n        if (descendants.length) {\r\n            var index = findIndex(this.descendants, function (_a) {\r\n                var item = _a[0];\r\n                return item === bscrollFamily;\r\n            });\r\n            if (index > -1) {\r\n                return descendants.splice(index, 1);\r\n            }\r\n        }\r\n    };\r\n    BScrollFamily.prototype.registerHooks = function (hook, eventType, handler) {\r\n        hook.on(eventType, handler);\r\n        this.hooksManager.push([hook, eventType, handler]);\r\n    };\r\n    BScrollFamily.prototype.setAnalyzed = function (flag) {\r\n        if (flag === void 0) { flag = false; }\r\n        this.analyzed = flag;\r\n    };\r\n    BScrollFamily.prototype.purge = function () {\r\n        var _this = this;\r\n        // remove self from graph\r\n        this.ancestors.forEach(function (_a) {\r\n            var bscrollFamily = _a[0];\r\n            bscrollFamily.removeDescendant(_this);\r\n        });\r\n        this.descendants.forEach(function (_a) {\r\n            var bscrollFamily = _a[0];\r\n            bscrollFamily.removeAncestor(_this);\r\n        });\r\n        // remove all hook handlers\r\n        this.hooksManager.forEach(function (_a) {\r\n            var hooks = _a[0], eventType = _a[1], handler = _a[2];\r\n            hooks.off(eventType, handler);\r\n        });\r\n        this.hooksManager = [];\r\n    };\r\n    return BScrollFamily;\r\n}());\n\nvar sourcePrefix$1 = 'plugins.nestedScroll';\r\nvar propertiesMap$1 = [\r\n    {\r\n        key: 'purgeNestedScroll',\r\n        name: 'purgeNestedScroll',\r\n    },\r\n];\r\nvar propertiesConfig$1 = propertiesMap$1.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix$1 + \".\" + item.name,\r\n    };\r\n});\n\nvar DEFAUL_GROUP_ID = 'INTERNAL_NESTED_SCROLL';\r\nvar forceScrollStopHandler = function (scrolls) {\r\n    scrolls.forEach(function (scroll) {\r\n        if (scroll.pending) {\r\n            scroll.stop();\r\n            scroll.resetPosition();\r\n        }\r\n    });\r\n};\r\nvar enableScrollHander = function (scrolls) {\r\n    scrolls.forEach(function (scroll) {\r\n        scroll.enable();\r\n    });\r\n};\r\nvar disableScrollHander = function (scrolls, currentScroll) {\r\n    scrolls.forEach(function (scroll) {\r\n        if (scroll.hasHorizontalScroll === currentScroll.hasHorizontalScroll ||\r\n            scroll.hasVerticalScroll === currentScroll.hasVerticalScroll) {\r\n            scroll.disable();\r\n        }\r\n    });\r\n};\r\nvar syncTouchstartData = function (scrolls) {\r\n    scrolls.forEach(function (scroll) {\r\n        var _a = scroll.scroller, actions = _a.actions, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        // prevent click triggering many times\r\n        actions.fingerMoved = true;\r\n        actions.contentMoved = false;\r\n        actions.directionLockAction.reset();\r\n        scrollBehaviorX.start();\r\n        scrollBehaviorY.start();\r\n        scrollBehaviorX.resetStartPos();\r\n        scrollBehaviorY.resetStartPos();\r\n        actions.startTime = +new Date();\r\n    });\r\n};\r\nvar isOutOfBoundary = function (scroll) {\r\n    var hasHorizontalScroll = scroll.hasHorizontalScroll, hasVerticalScroll = scroll.hasVerticalScroll, x = scroll.x, y = scroll.y, minScrollX = scroll.minScrollX, maxScrollX = scroll.maxScrollX, minScrollY = scroll.minScrollY, maxScrollY = scroll.maxScrollY, movingDirectionX = scroll.movingDirectionX, movingDirectionY = scroll.movingDirectionY;\r\n    var ret = false;\r\n    var outOfLeftBoundary = x >= minScrollX && movingDirectionX === -1 /* Negative */;\r\n    var outOfRightBoundary = x <= maxScrollX && movingDirectionX === 1 /* Positive */;\r\n    var outOfTopBoundary = y >= minScrollY && movingDirectionY === -1 /* Negative */;\r\n    var outOfBottomBoundary = y <= maxScrollY && movingDirectionY === 1 /* Positive */;\r\n    if (hasVerticalScroll) {\r\n        ret = outOfTopBoundary || outOfBottomBoundary;\r\n    }\r\n    else if (hasHorizontalScroll) {\r\n        ret = outOfLeftBoundary || outOfRightBoundary;\r\n    }\r\n    return ret;\r\n};\r\nvar isResettingPosition = function (scroll) {\r\n    var hasHorizontalScroll = scroll.hasHorizontalScroll, hasVerticalScroll = scroll.hasVerticalScroll, x = scroll.x, y = scroll.y, minScrollX = scroll.minScrollX, maxScrollX = scroll.maxScrollX, minScrollY = scroll.minScrollY, maxScrollY = scroll.maxScrollY;\r\n    var ret = false;\r\n    var outOfLeftBoundary = x > minScrollX;\r\n    var outOfRightBoundary = x < maxScrollX;\r\n    var outOfTopBoundary = y > minScrollY;\r\n    var outOfBottomBoundary = y < maxScrollY;\r\n    if (hasVerticalScroll) {\r\n        ret = outOfTopBoundary || outOfBottomBoundary;\r\n    }\r\n    else if (hasHorizontalScroll) {\r\n        ret = outOfLeftBoundary || outOfRightBoundary;\r\n    }\r\n    return ret;\r\n};\r\nvar resetPositionHandler = function (scroll) {\r\n    scroll.scroller.reflow();\r\n    scroll.resetPosition(0 /* Immediately */);\r\n};\r\nvar calculateDistance = function (childNode, parentNode) {\r\n    var distance = 0;\r\n    var parent = childNode.parentNode;\r\n    while (parent && parent !== parentNode) {\r\n        distance++;\r\n        parent = parent.parentNode;\r\n    }\r\n    return distance;\r\n};\r\nvar NestedScroll = /** @class */ (function () {\r\n    function NestedScroll(scroll) {\r\n        var groupId = this.handleOptions(scroll);\r\n        var instance = NestedScroll.instancesMap[groupId];\r\n        if (!instance) {\r\n            instance = NestedScroll.instancesMap[groupId] = this;\r\n            instance.store = [];\r\n            instance.hooksFn = [];\r\n        }\r\n        instance.init(scroll);\r\n        return instance;\r\n    }\r\n    NestedScroll.getAllNestedScrolls = function () {\r\n        var instancesMap = NestedScroll.instancesMap;\r\n        return Object.keys(instancesMap).map(function (key) { return instancesMap[key]; });\r\n    };\r\n    NestedScroll.purgeAllNestedScrolls = function () {\r\n        var nestedScrolls = NestedScroll.getAllNestedScrolls();\r\n        nestedScrolls.forEach(function (ns) { return ns.purgeNestedScroll(); });\r\n    };\r\n    NestedScroll.prototype.handleOptions = function (scroll) {\r\n        var userOptions = (scroll.options.nestedScroll === true\r\n            ? {}\r\n            : scroll.options.nestedScroll);\r\n        var defaultOptions = {\r\n            groupId: DEFAUL_GROUP_ID,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n        var groupIdType = typeof this.options.groupId;\r\n        if (groupIdType !== 'string' && groupIdType !== 'number') {\r\n            warn('groupId must be string or number for NestedScroll plugin');\r\n        }\r\n        return this.options.groupId;\r\n    };\r\n    NestedScroll.prototype.init = function (scroll) {\r\n        scroll.proxy(propertiesConfig$1);\r\n        this.addBScroll(scroll);\r\n        this.buildBScrollGraph();\r\n        this.analyzeBScrollGraph();\r\n        this.ensureEventInvokeSequence();\r\n        this.handleHooks(scroll);\r\n    };\r\n    NestedScroll.prototype.handleHooks = function (scroll) {\r\n        var _this = this;\r\n        this.registerHooks(scroll.hooks, scroll.hooks.eventTypes.destroy, function () {\r\n            _this.deleteScroll(scroll);\r\n        });\r\n    };\r\n    NestedScroll.prototype.deleteScroll = function (scroll) {\r\n        var wrapper = scroll.wrapper;\r\n        wrapper.isBScrollContainer = undefined;\r\n        var store = this.store;\r\n        var hooksFn = this.hooksFn;\r\n        var i = findIndex(store, function (bscrollFamily) {\r\n            return bscrollFamily.selfScroll === scroll;\r\n        });\r\n        if (i > -1) {\r\n            var bscrollFamily = store[i];\r\n            bscrollFamily.purge();\r\n            store.splice(i, 1);\r\n        }\r\n        var k = findIndex(hooksFn, function (_a) {\r\n            var hooks = _a[0];\r\n            return hooks === scroll.hooks;\r\n        });\r\n        if (k > -1) {\r\n            var _a = hooksFn[k], hooks = _a[0], eventType = _a[1], handler = _a[2];\r\n            hooks.off(eventType, handler);\r\n            hooksFn.splice(k, 1);\r\n        }\r\n    };\r\n    NestedScroll.prototype.addBScroll = function (scroll) {\r\n        this.store.push(BScrollFamily.create(scroll));\r\n    };\r\n    NestedScroll.prototype.buildBScrollGraph = function () {\r\n        var store = this.store;\r\n        var bf1;\r\n        var bf2;\r\n        var wrapper1;\r\n        var wrapper2;\r\n        var len = this.store.length;\r\n        // build graph\r\n        for (var i = 0; i < len; i++) {\r\n            bf1 = store[i];\r\n            wrapper1 = bf1.selfScroll.wrapper;\r\n            for (var j = 0; j < len; j++) {\r\n                bf2 = store[j];\r\n                wrapper2 = bf2.selfScroll.wrapper;\r\n                // same bs\r\n                if (bf1 === bf2)\r\n                    continue;\r\n                if (!wrapper1.contains(wrapper2))\r\n                    continue;\r\n                // bs1 contains bs2\r\n                var distance = calculateDistance(wrapper2, wrapper1);\r\n                if (!bf1.hasDescendants(bf2)) {\r\n                    bf1.addDescendant(bf2, distance);\r\n                }\r\n                if (!bf2.hasAncestors(bf1)) {\r\n                    bf2.addAncestor(bf1, distance);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    NestedScroll.prototype.analyzeBScrollGraph = function () {\r\n        this.store.forEach(function (bscrollFamily) {\r\n            if (bscrollFamily.analyzed) {\r\n                return;\r\n            }\r\n            var ancestors = bscrollFamily.ancestors, descendants = bscrollFamily.descendants, currentScroll = bscrollFamily.selfScroll;\r\n            var beforeScrollStartHandler = function () {\r\n                // always get the latest scroll\r\n                var ancestorScrolls = ancestors.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                var descendantScrolls = descendants.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                forceScrollStopHandler(__spreadArrays(ancestorScrolls, descendantScrolls));\r\n                if (isResettingPosition(currentScroll)) {\r\n                    resetPositionHandler(currentScroll);\r\n                }\r\n                syncTouchstartData(ancestorScrolls);\r\n                disableScrollHander(ancestorScrolls, currentScroll);\r\n            };\r\n            var touchEndHandler = function () {\r\n                var ancestorScrolls = ancestors.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                var descendantScrolls = descendants.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                enableScrollHander(__spreadArrays(ancestorScrolls, descendantScrolls));\r\n            };\r\n            bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.beforeScrollStart, beforeScrollStartHandler);\r\n            bscrollFamily.registerHooks(currentScroll, currentScroll.eventTypes.touchEnd, touchEndHandler);\r\n            var selfActionsHooks = currentScroll.scroller.actions.hooks;\r\n            bscrollFamily.registerHooks(selfActionsHooks, selfActionsHooks.eventTypes.detectMovingDirection, function () {\r\n                var ancestorScrolls = ancestors.map(function (_a) {\r\n                    var bscrollFamily = _a[0];\r\n                    return bscrollFamily.selfScroll;\r\n                });\r\n                var parentScroll = ancestorScrolls[0];\r\n                var otherAncestorScrolls = ancestorScrolls.slice(1);\r\n                var contentMoved = currentScroll.scroller.actions.contentMoved;\r\n                var isTopScroll = ancestorScrolls.length === 0;\r\n                if (contentMoved) {\r\n                    disableScrollHander(ancestorScrolls, currentScroll);\r\n                }\r\n                else if (!isTopScroll) {\r\n                    if (isOutOfBoundary(currentScroll)) {\r\n                        disableScrollHander([currentScroll], currentScroll);\r\n                        if (parentScroll) {\r\n                            enableScrollHander([parentScroll]);\r\n                        }\r\n                        disableScrollHander(otherAncestorScrolls, currentScroll);\r\n                        return true;\r\n                    }\r\n                }\r\n            });\r\n            bscrollFamily.setAnalyzed(true);\r\n        });\r\n    };\r\n    // make sure touchmove|touchend invoke from child to parent\r\n    NestedScroll.prototype.ensureEventInvokeSequence = function () {\r\n        var copied = this.store.slice();\r\n        var sequencedScroll = copied.sort(function (a, b) {\r\n            return a.descendants.length - b.descendants.length;\r\n        });\r\n        sequencedScroll.forEach(function (bscrollFamily) {\r\n            var scroll = bscrollFamily.selfScroll;\r\n            scroll.scroller.actionsHandler.rebindDOMEvents();\r\n        });\r\n    };\r\n    NestedScroll.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    NestedScroll.prototype.purgeNestedScroll = function () {\r\n        var groupId = this.options.groupId;\r\n        this.store.forEach(function (bscrollFamily) {\r\n            bscrollFamily.purge();\r\n        });\r\n        this.store = [];\r\n        this.hooksFn.forEach(function (_a) {\r\n            var hooks = _a[0], eventType = _a[1], handler = _a[2];\r\n            hooks.off(eventType, handler);\r\n        });\r\n        this.hooksFn = [];\r\n        delete NestedScroll.instancesMap[groupId];\r\n    };\r\n    NestedScroll.pluginName = 'nestedScroll';\r\n    NestedScroll.instancesMap = {};\r\n    return NestedScroll;\r\n}());\n\nvar PRE_NUM = 10;\r\nvar POST_NUM = 30;\r\nvar IndexCalculator = /** @class */ (function () {\r\n    function IndexCalculator(wrapperHeight, tombstoneHeight) {\r\n        this.wrapperHeight = wrapperHeight;\r\n        this.tombstoneHeight = tombstoneHeight;\r\n        this.lastDirection = 1 /* DOWN */;\r\n        this.lastPos = 0;\r\n    }\r\n    IndexCalculator.prototype.calculate = function (pos, list) {\r\n        var offset = pos - this.lastPos;\r\n        this.lastPos = pos;\r\n        var direction = this.getDirection(offset);\r\n        // important! start index is much more important than end index.\r\n        var start = this.calculateIndex(0, pos, list);\r\n        var end = this.calculateIndex(start, pos + this.wrapperHeight, list);\r\n        if (direction === 1 /* DOWN */) {\r\n            start -= PRE_NUM;\r\n            end += POST_NUM;\r\n        }\r\n        else {\r\n            start -= POST_NUM;\r\n            end += PRE_NUM;\r\n        }\r\n        if (start < 0) {\r\n            start = 0;\r\n        }\r\n        return {\r\n            start: start,\r\n            end: end,\r\n        };\r\n    };\r\n    IndexCalculator.prototype.getDirection = function (offset) {\r\n        var direction;\r\n        if (offset > 0) {\r\n            direction = 1 /* DOWN */;\r\n        }\r\n        else if (offset < 0) {\r\n            direction = 0 /* UP */;\r\n        }\r\n        else {\r\n            return this.lastDirection;\r\n        }\r\n        this.lastDirection = direction;\r\n        return direction;\r\n    };\r\n    IndexCalculator.prototype.calculateIndex = function (start, offset, list) {\r\n        if (offset <= 0) {\r\n            return start;\r\n        }\r\n        var i = start;\r\n        var startPos = list[i] && list[i].pos !== -1 ? list[i].pos : 0;\r\n        var lastPos = startPos;\r\n        var tombstone = 0;\r\n        while (i < list.length && list[i].pos < offset) {\r\n            lastPos = list[i].pos;\r\n            i++;\r\n        }\r\n        if (i === list.length) {\r\n            tombstone = Math.floor((offset - lastPos) / this.tombstoneHeight);\r\n        }\r\n        i += tombstone;\r\n        return i;\r\n    };\r\n    IndexCalculator.prototype.resetState = function () {\r\n        this.lastDirection = 1 /* DOWN */;\r\n        this.lastPos = 0;\r\n    };\r\n    return IndexCalculator;\r\n}());\n\nvar ListItem = /** @class */ (function () {\r\n    function ListItem() {\r\n        this.data = null;\r\n        this.dom = null;\r\n        this.tombstone = null;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.pos = 0;\r\n    }\r\n    return ListItem;\r\n}());\r\nvar DataManager = /** @class */ (function () {\r\n    function DataManager(list, fetchFn, onFetchFinish) {\r\n        this.fetchFn = fetchFn;\r\n        this.onFetchFinish = onFetchFinish;\r\n        this.loadedNum = 0;\r\n        this.fetching = false;\r\n        this.hasMore = true;\r\n        this.list = list || [];\r\n    }\r\n    DataManager.prototype.update = function (end) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var len;\r\n            return __generator(this, function (_a) {\r\n                if (!this.hasMore) {\r\n                    end = Math.min(end, this.list.length);\r\n                }\r\n                // add data placeholder\r\n                if (end > this.list.length) {\r\n                    len = end - this.list.length;\r\n                    this.addEmptyData(len);\r\n                }\r\n                // tslint:disable-next-line: no-floating-promises\r\n                return [2 /*return*/, this.checkToFetch(end)];\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.add = function (data) {\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (!this.list[this.loadedNum]) {\r\n                this.list[this.loadedNum] = { data: data[i] };\r\n            }\r\n            else {\r\n                this.list[this.loadedNum] = __assign(__assign({}, this.list[this.loadedNum]), { data: data[i] });\r\n            }\r\n            this.loadedNum++;\r\n        }\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.addEmptyData = function (len) {\r\n        for (var i = 0; i < len; i++) {\r\n            this.list.push(new ListItem());\r\n        }\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.fetch = function (len) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var data;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (this.fetching) {\r\n                            return [2 /*return*/, []];\r\n                        }\r\n                        this.fetching = true;\r\n                        return [4 /*yield*/, this.fetchFn(len)];\r\n                    case 1:\r\n                        data = _a.sent();\r\n                        this.fetching = false;\r\n                        return [2 /*return*/, data];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.checkToFetch = function (end) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var min, newData, currentEnd;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this.hasMore) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        if (end <= this.loadedNum) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        min = end - this.loadedNum;\r\n                        return [4 /*yield*/, this.fetch(min)];\r\n                    case 1:\r\n                        newData = _a.sent();\r\n                        if (newData instanceof Array && newData.length) {\r\n                            this.add(newData);\r\n                            currentEnd = this.onFetchFinish(this.list, true);\r\n                            return [2 /*return*/, this.checkToFetch(currentEnd)];\r\n                        }\r\n                        else if (typeof newData === 'boolean' && newData === false) {\r\n                            this.hasMore = false;\r\n                            this.list.splice(this.loadedNum);\r\n                            this.onFetchFinish(this.list, false);\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DataManager.prototype.getList = function () {\r\n        return this.list;\r\n    };\r\n    DataManager.prototype.resetState = function () {\r\n        this.loadedNum = 0;\r\n        this.fetching = false;\r\n        this.hasMore = true;\r\n        this.list = [];\r\n    };\r\n    return DataManager;\r\n}());\n\nvar Tombstone = /** @class */ (function () {\r\n    function Tombstone(create) {\r\n        this.create = create;\r\n        this.cached = [];\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.initialed = false;\r\n        this.getSize();\r\n    }\r\n    Tombstone.isTombstone = function (el) {\r\n        if (el && el.classList) {\r\n            return el.classList.contains('tombstone');\r\n        }\r\n        return false;\r\n    };\r\n    Tombstone.prototype.getSize = function () {\r\n        if (!this.initialed) {\r\n            var tombstone = this.create();\r\n            tombstone.style.position = 'absolute';\r\n            document.body.appendChild(tombstone);\r\n            tombstone.style.display = '';\r\n            this.height = tombstone.offsetHeight;\r\n            this.width = tombstone.offsetWidth;\r\n            document.body.removeChild(tombstone);\r\n            this.cached.push(tombstone);\r\n        }\r\n    };\r\n    Tombstone.prototype.getOne = function () {\r\n        var tombstone = this.cached.pop();\r\n        if (tombstone) {\r\n            var tombstoneStyle = tombstone.style;\r\n            tombstoneStyle.display = '';\r\n            tombstoneStyle.opacity = '1';\r\n            tombstoneStyle[style.transform] = '';\r\n            tombstoneStyle[style.transition] = '';\r\n            return tombstone;\r\n        }\r\n        return this.create();\r\n    };\r\n    Tombstone.prototype.recycle = function (tombstones) {\r\n        for (var _i = 0, tombstones_1 = tombstones; _i < tombstones_1.length; _i++) {\r\n            var tombstone = tombstones_1[_i];\r\n            tombstone.style.display = 'none';\r\n            this.cached.push(tombstone);\r\n        }\r\n        return this.cached;\r\n    };\r\n    Tombstone.prototype.recycleOne = function (tombstone) {\r\n        this.cached.push(tombstone);\r\n        return this.cached;\r\n    };\r\n    return Tombstone;\r\n}());\n\nvar ANIMATION_DURATION_MS = 200;\r\nvar DomManager = /** @class */ (function () {\r\n    function DomManager(content, renderFn, tombstone) {\r\n        this.renderFn = renderFn;\r\n        this.tombstone = tombstone;\r\n        this.unusedDom = [];\r\n        this.timers = [];\r\n        this.setContent(content);\r\n    }\r\n    DomManager.prototype.update = function (list, start, end) {\r\n        if (start >= list.length) {\r\n            start = list.length - 1;\r\n        }\r\n        if (end > list.length) {\r\n            end = list.length;\r\n        }\r\n        this.collectUnusedDom(list, start, end);\r\n        this.createDom(list, start, end);\r\n        this.cacheHeight(list, start, end);\r\n        var _a = this.positionDom(list, start, end), startPos = _a.startPos, startDelta = _a.startDelta, endPos = _a.endPos;\r\n        return {\r\n            start: start,\r\n            startPos: startPos,\r\n            startDelta: startDelta,\r\n            end: end,\r\n            endPos: endPos,\r\n        };\r\n    };\r\n    DomManager.prototype.collectUnusedDom = function (list, start, end) {\r\n        // TODO optimise\r\n        for (var i = 0; i < list.length; i++) {\r\n            if (i === start) {\r\n                i = end - 1;\r\n                continue;\r\n            }\r\n            if (list[i].dom) {\r\n                var dom = list[i].dom;\r\n                if (Tombstone.isTombstone(dom)) {\r\n                    this.tombstone.recycleOne(dom);\r\n                    dom.style.display = 'none';\r\n                }\r\n                else {\r\n                    this.unusedDom.push(dom);\r\n                }\r\n                list[i].dom = null;\r\n            }\r\n        }\r\n        return list;\r\n    };\r\n    DomManager.prototype.createDom = function (list, start, end) {\r\n        for (var i = start; i < end; i++) {\r\n            var dom = list[i].dom;\r\n            var data = list[i].data;\r\n            if (dom) {\r\n                if (Tombstone.isTombstone(dom) && data) {\r\n                    list[i].tombstone = dom;\r\n                    list[i].dom = null;\r\n                }\r\n                else {\r\n                    continue;\r\n                }\r\n            }\r\n            dom = data\r\n                ? this.renderFn(data, this.unusedDom.pop())\r\n                : this.tombstone.getOne();\r\n            dom.style.position = 'absolute';\r\n            list[i].dom = dom;\r\n            list[i].pos = -1;\r\n            this.content.appendChild(dom);\r\n        }\r\n    };\r\n    DomManager.prototype.cacheHeight = function (list, start, end) {\r\n        for (var i = start; i < end; i++) {\r\n            if (list[i].data && !list[i].height) {\r\n                list[i].height = list[i].dom.offsetHeight;\r\n            }\r\n        }\r\n    };\r\n    DomManager.prototype.positionDom = function (list, start, end) {\r\n        var _this = this;\r\n        var tombstoneEles = [];\r\n        var _a = this.getStartPos(list, start, end), startPos = _a.start, startDelta = _a.delta;\r\n        var pos = startPos;\r\n        for (var i = start; i < end; i++) {\r\n            var tombstone = list[i].tombstone;\r\n            if (tombstone) {\r\n                var tombstoneStyle = tombstone.style;\r\n                tombstoneStyle[style.transition] = cssVendor + \"transform \" + ANIMATION_DURATION_MS + \"ms, opacity \" + ANIMATION_DURATION_MS + \"ms\";\r\n                tombstoneStyle[style.transform] = \"translateY(\" + pos + \"px)\";\r\n                tombstoneStyle.opacity = '0';\r\n                list[i].tombstone = null;\r\n                tombstoneEles.push(tombstone);\r\n            }\r\n            if (list[i].dom && list[i].pos !== pos) {\r\n                list[i].dom.style[style.transform] = \"translateY(\" + pos + \"px)\";\r\n                list[i].pos = pos;\r\n            }\r\n            pos += list[i].height || this.tombstone.height;\r\n        }\r\n        var timerId = window.setTimeout(function () {\r\n            _this.tombstone.recycle(tombstoneEles);\r\n        }, ANIMATION_DURATION_MS);\r\n        this.timers.push(timerId);\r\n        return {\r\n            startPos: startPos,\r\n            startDelta: startDelta,\r\n            endPos: pos,\r\n        };\r\n    };\r\n    DomManager.prototype.getStartPos = function (list, start, end) {\r\n        if (list[start] && list[start].pos !== -1) {\r\n            return {\r\n                start: list[start].pos,\r\n                delta: 0,\r\n            };\r\n        }\r\n        // TODO optimise\r\n        var pos = list[0].pos === -1 ? 0 : list[0].pos;\r\n        for (var i_1 = 0; i_1 < start; i_1++) {\r\n            pos += list[i_1].height || this.tombstone.height;\r\n        }\r\n        var originPos = pos;\r\n        var i;\r\n        for (i = start; i < end; i++) {\r\n            if (!Tombstone.isTombstone(list[i].dom) && list[i].pos !== -1) {\r\n                pos = list[i].pos;\r\n                break;\r\n            }\r\n        }\r\n        var x = i;\r\n        if (x < end) {\r\n            while (x > start) {\r\n                pos -= list[x - 1].height;\r\n                x--;\r\n            }\r\n        }\r\n        var delta = originPos - pos;\r\n        return {\r\n            start: pos,\r\n            delta: delta,\r\n        };\r\n    };\r\n    DomManager.prototype.removeTombstone = function () {\r\n        var tombstones = this.content.querySelectorAll('.tombstone');\r\n        for (var i = tombstones.length - 1; i >= 0; i--) {\r\n            this.content.removeChild(tombstones[i]);\r\n        }\r\n    };\r\n    DomManager.prototype.setContent = function (content) {\r\n        if (content !== this.content) {\r\n            this.content = content;\r\n        }\r\n    };\r\n    DomManager.prototype.destroy = function () {\r\n        this.removeTombstone();\r\n        this.timers.forEach(function (id) {\r\n            clearTimeout(id);\r\n        });\r\n    };\r\n    DomManager.prototype.resetState = function () {\r\n        this.destroy();\r\n        this.timers = [];\r\n        this.unusedDom = [];\r\n    };\r\n    return DomManager;\r\n}());\n\nvar EXTRA_SCROLL_Y = -2000;\r\nvar InfinityScroll = /** @class */ (function () {\r\n    function InfinityScroll(scroll) {\r\n        this.scroll = scroll;\r\n        this.start = 0;\r\n        this.end = 0;\r\n        this.init();\r\n    }\r\n    InfinityScroll.prototype.init = function () {\r\n        var _this = this;\r\n        this.handleOptions();\r\n        var _a = this.options, fetchFn = _a.fetch, renderFn = _a.render, createTombstoneFn = _a.createTombstone;\r\n        this.tombstone = new Tombstone(createTombstoneFn);\r\n        this.indexCalculator = new IndexCalculator(this.scroll.scroller.scrollBehaviorY.wrapperSize, this.tombstone.height);\r\n        this.domManager = new DomManager(this.scroll.scroller.content, renderFn, this.tombstone);\r\n        this.dataManager = new DataManager([], fetchFn, this.onFetchFinish.bind(this));\r\n        this.scroll.on(this.scroll.eventTypes.destroy, this.destroy, this);\r\n        this.scroll.on(this.scroll.eventTypes.scroll, this.update, this);\r\n        this.scroll.on(this.scroll.eventTypes.contentChanged, function (content) {\r\n            _this.domManager.setContent(content);\r\n            _this.indexCalculator.resetState();\r\n            _this.domManager.resetState();\r\n            _this.dataManager.resetState();\r\n            _this.update({ y: 0 });\r\n        });\r\n        var scrollBehaviorY = this.scroll.scroller.scrollBehaviorY;\r\n        scrollBehaviorY.hooks.on(scrollBehaviorY.hooks.eventTypes.computeBoundary, this.modifyBoundary, this);\r\n        this.update({ y: 0 });\r\n    };\r\n    InfinityScroll.prototype.modifyBoundary = function (boundary) {\r\n        // manually set position to allow scroll\r\n        boundary.maxScrollPos = EXTRA_SCROLL_Y;\r\n    };\r\n    InfinityScroll.prototype.handleOptions = function () {\r\n        // narrow down type to an object\r\n        var infinityOptions = this.scroll.options.infinity;\r\n        if (infinityOptions) {\r\n            if (typeof infinityOptions.fetch !== 'function') {\r\n                warn('Infinity plugin need fetch Function to new data.');\r\n            }\r\n            if (typeof infinityOptions.render !== 'function') {\r\n                warn('Infinity plugin need render Function to render each item.');\r\n            }\r\n            if (typeof infinityOptions.render !== 'function') {\r\n                warn('Infinity plugin need createTombstone Function to create tombstone.');\r\n            }\r\n            this.options = infinityOptions;\r\n        }\r\n        this.scroll.options.probeType = 3 /* Realtime */;\r\n    };\r\n    InfinityScroll.prototype.update = function (pos) {\r\n        var position = Math.round(-pos.y);\r\n        // important! calculate start/end index to render\r\n        var _a = this.indexCalculator.calculate(position, this.dataManager.getList()), start = _a.start, end = _a.end;\r\n        this.start = start;\r\n        this.end = end;\r\n        // tslint:disable-next-line: no-floating-promises\r\n        this.dataManager.update(end);\r\n        this.updateDom(this.dataManager.getList());\r\n    };\r\n    InfinityScroll.prototype.onFetchFinish = function (list, hasMore) {\r\n        var end = this.updateDom(list).end;\r\n        if (!hasMore) {\r\n            this.domManager.removeTombstone();\r\n            this.scroll.scroller.animater.stop();\r\n            this.scroll.resetPosition();\r\n        }\r\n        // tslint:disable-next-line: no-floating-promises\r\n        return end;\r\n    };\r\n    InfinityScroll.prototype.updateDom = function (list) {\r\n        var _a = this.domManager.update(list, this.start, this.end), end = _a.end, startPos = _a.startPos, endPos = _a.endPos, startDelta = _a.startDelta;\r\n        if (startDelta) {\r\n            this.scroll.minScrollY = startDelta;\r\n        }\r\n        if (endPos > this.scroll.maxScrollY) {\r\n            this.scroll.maxScrollY = -(endPos - this.scroll.scroller.scrollBehaviorY.wrapperSize);\r\n        }\r\n        return {\r\n            end: end,\r\n            startPos: startPos,\r\n            endPos: endPos,\r\n        };\r\n    };\r\n    InfinityScroll.prototype.destroy = function () {\r\n        var _a = this.scroll.scroller, content = _a.content, scrollBehaviorY = _a.scrollBehaviorY;\r\n        while (content.firstChild) {\r\n            content.removeChild(content.firstChild);\r\n        }\r\n        this.domManager.destroy();\r\n        this.scroll.off('scroll', this.update);\r\n        this.scroll.off('destroy', this.destroy);\r\n        scrollBehaviorY.hooks.off(scrollBehaviorY.hooks.eventTypes.computeBoundary);\r\n    };\r\n    InfinityScroll.pluginName = 'infinity';\r\n    return InfinityScroll;\r\n}());\n\nvar sourcePrefix = 'plugins.movable';\r\nvar propertiesMap = [\r\n    {\r\n        key: 'putAt',\r\n        name: 'putAt',\r\n    },\r\n];\r\nvar propertiesConfig = propertiesMap.map(function (item) {\r\n    return {\r\n        key: item.key,\r\n        sourceKey: sourcePrefix + \".\" + item.name,\r\n    };\r\n});\n\nvar Movable = /** @class */ (function () {\r\n    function Movable(scroll) {\r\n        this.scroll = scroll;\r\n        this.handleBScroll();\r\n        this.handleHooks();\r\n    }\r\n    Movable.prototype.handleBScroll = function () {\r\n        this.scroll.proxy(propertiesConfig);\r\n    };\r\n    Movable.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        this.hooksFn = [];\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var computeBoundary = function (boundary, behavior) {\r\n            if (boundary.maxScrollPos > 0) {\r\n                // content is smaller than wrapper\r\n                boundary.minScrollPos = behavior.wrapperSize - behavior.contentSize;\r\n                boundary.maxScrollPos = 0;\r\n            }\r\n        };\r\n        this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.ignoreHasScroll, function () { return true; });\r\n        this.registerHooks(scrollBehaviorX.hooks, scrollBehaviorX.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            computeBoundary(boundary, scrollBehaviorX);\r\n        });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.ignoreHasScroll, function () { return true; });\r\n        this.registerHooks(scrollBehaviorY.hooks, scrollBehaviorY.hooks.eventTypes.computeBoundary, function (boundary) {\r\n            computeBoundary(boundary, scrollBehaviorY);\r\n        });\r\n        this.registerHooks(this.scroll.hooks, this.scroll.hooks.eventTypes.destroy, function () {\r\n            _this.destroy();\r\n        });\r\n    };\r\n    Movable.prototype.putAt = function (x, y, time, easing) {\r\n        if (time === void 0) { time = this.scroll.options.bounceTime; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        var position = this.resolvePostion(x, y);\r\n        this.scroll.scrollTo(position.x, position.y, time, easing);\r\n    };\r\n    Movable.prototype.resolvePostion = function (x, y) {\r\n        var _a = this.scroll.scroller, scrollBehaviorX = _a.scrollBehaviorX, scrollBehaviorY = _a.scrollBehaviorY;\r\n        var resolveFormula = {\r\n            left: function () {\r\n                return 0;\r\n            },\r\n            top: function () {\r\n                return 0;\r\n            },\r\n            right: function () {\r\n                return scrollBehaviorX.minScrollPos;\r\n            },\r\n            bottom: function () {\r\n                return scrollBehaviorY.minScrollPos;\r\n            },\r\n            center: function (index) {\r\n                var baseSize = index === 0\r\n                    ? scrollBehaviorX.minScrollPos\r\n                    : scrollBehaviorY.minScrollPos;\r\n                return baseSize / 2;\r\n            },\r\n        };\r\n        return {\r\n            x: typeof x === 'number' ? x : resolveFormula[x](0),\r\n            y: typeof y === 'number' ? y : resolveFormula[y](1),\r\n        };\r\n    };\r\n    Movable.prototype.destroy = function () {\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    Movable.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Movable.pluginName = 'movable';\r\n    Movable.applyOrder = \"pre\" /* Pre */;\r\n    return Movable;\r\n}());\n\nvar isImageTag = function (el) {\r\n    return el.tagName.toLowerCase() === 'img';\r\n};\r\nvar ObserveImage = /** @class */ (function () {\r\n    function ObserveImage(scroll) {\r\n        this.scroll = scroll;\r\n        this.refreshTimer = 0;\r\n        this.init();\r\n    }\r\n    ObserveImage.prototype.init = function () {\r\n        this.handleOptions(this.scroll.options.observeImage);\r\n        this.bindEventsToWrapper();\r\n    };\r\n    ObserveImage.prototype.handleOptions = function (userOptions) {\r\n        if (userOptions === void 0) { userOptions = {}; }\r\n        userOptions = (userOptions === true ? {} : userOptions);\r\n        var defaultOptions = {\r\n            debounceTime: 100,\r\n        };\r\n        this.options = extend(defaultOptions, userOptions);\r\n    };\r\n    ObserveImage.prototype.bindEventsToWrapper = function () {\r\n        var wrapper = this.scroll.scroller.wrapper;\r\n        this.imageLoadEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'load',\r\n                handler: this.load.bind(this),\r\n                capture: true,\r\n            },\r\n        ]);\r\n        this.imageErrorEventRegister = new EventRegister(wrapper, [\r\n            {\r\n                name: 'error',\r\n                handler: this.load.bind(this),\r\n                capture: true,\r\n            },\r\n        ]);\r\n    };\r\n    ObserveImage.prototype.load = function (e) {\r\n        var _this = this;\r\n        var target = e.target;\r\n        var debounceTime = this.options.debounceTime;\r\n        if (target && isImageTag(target)) {\r\n            if (debounceTime === 0) {\r\n                this.scroll.refresh();\r\n            }\r\n            else {\r\n                clearTimeout(this.refreshTimer);\r\n                this.refreshTimer = window.setTimeout(function () {\r\n                    _this.scroll.refresh();\r\n                }, this.options.debounceTime);\r\n            }\r\n        }\r\n    };\r\n    ObserveImage.pluginName = 'observeImage';\r\n    return ObserveImage;\r\n}());\n\nvar resolveRatioOption = function (ratioConfig) {\r\n    var ret = {\r\n        ratioX: 0,\r\n        ratioY: 0,\r\n    };\r\n    /* istanbul ignore if  */\r\n    if (!ratioConfig) {\r\n        return ret;\r\n    }\r\n    if (typeof ratioConfig === 'number') {\r\n        ret.ratioX = ret.ratioY = ratioConfig;\r\n    }\r\n    else if (typeof ratioConfig === 'object' && ratioConfig) {\r\n        ret.ratioX = ratioConfig.x || 0;\r\n        ret.ratioY = ratioConfig.y || 0;\r\n    }\r\n    return ret;\r\n};\r\nvar handleBubbleAndCancelable = function (e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n};\r\nvar Indicator = /** @class */ (function () {\r\n    function Indicator(scroll, options) {\r\n        this.scroll = scroll;\r\n        this.options = options;\r\n        this.currentPos = {\r\n            x: 0,\r\n            y: 0,\r\n        };\r\n        this.hooksFn = [];\r\n        this.handleDOM();\r\n        this.handleHooks();\r\n        this.handleInteractive();\r\n    }\r\n    Indicator.prototype.handleDOM = function () {\r\n        var _a = this.options, relationElement = _a.relationElement, _b = _a.relationElementHandleElementIndex, relationElementHandleElementIndex = _b === void 0 ? 0 : _b;\r\n        this.wrapper = relationElement;\r\n        this.indicatorEl = this.wrapper.children[relationElementHandleElementIndex];\r\n    };\r\n    Indicator.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scroll = this.scroll;\r\n        var scrollHooks = scroll.hooks;\r\n        var translaterHooks = scroll.scroller.translater.hooks;\r\n        var animaterHooks = scroll.scroller.animater.hooks;\r\n        this.registerHooks(scrollHooks, scrollHooks.eventTypes.refresh, this.refresh);\r\n        this.registerHooks(translaterHooks, translaterHooks.eventTypes.translate, function (pos) {\r\n            _this.updatePosition(pos);\r\n        });\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.time, this.transitionTime);\r\n        this.registerHooks(animaterHooks, animaterHooks.eventTypes.timeFunction, this.transitionTimingFunction);\r\n    };\r\n    Indicator.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.indicatorEl.style[style.transitionDuration] = time + 'ms';\r\n    };\r\n    Indicator.prototype.transitionTimingFunction = function (easing) {\r\n        this.indicatorEl.style[style.transitionTimingFunction] = easing;\r\n    };\r\n    Indicator.prototype.handleInteractive = function () {\r\n        if (this.options.interactive !== false) {\r\n            this.registerEvents();\r\n        }\r\n    };\r\n    Indicator.prototype.registerHooks = function (hooks, name, handler) {\r\n        hooks.on(name, handler, this);\r\n        this.hooksFn.push([hooks, name, handler]);\r\n    };\r\n    Indicator.prototype.registerEvents = function () {\r\n        var _a = this.scroll.options, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch;\r\n        var startEvents = [];\r\n        var moveEvents = [];\r\n        var endEvents = [];\r\n        if (!disableMouse) {\r\n            startEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (!disableTouch) {\r\n            startEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            moveEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            });\r\n            endEvents.push({\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.startEventRegister = new EventRegister(this.indicatorEl, startEvents);\r\n        this.moveEventRegister = new EventRegister(window, moveEvents);\r\n        this.endEventRegister = new EventRegister(window, endEvents);\r\n    };\r\n    Indicator.prototype.refresh = function () {\r\n        var _a = this.scroll, x = _a.x, y = _a.y, hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll, maxBScrollX = _a.maxScrollX, maxBScrollY = _a.maxScrollY;\r\n        var _b = resolveRatioOption(this.options.ratio), ratioX = _b.ratioX, ratioY = _b.ratioY;\r\n        var _c = getClientSize(this.wrapper), wrapperWidth = _c.width, wrapperHeight = _c.height;\r\n        var _d = getRect(this.indicatorEl), indicatorWidth = _d.width, indicatorHeight = _d.height;\r\n        if (hasHorizontalScroll) {\r\n            this.maxScrollX = wrapperWidth - indicatorWidth;\r\n            this.translateXSign =\r\n                this.maxScrollX > 0 ? -1 /* Positive */ : 1 /* NotPositive */;\r\n            this.minScrollX = 0;\r\n            // ensure positive\r\n            this.ratioX = ratioX ? ratioX : Math.abs(this.maxScrollX / maxBScrollX);\r\n        }\r\n        if (hasVerticalScroll) {\r\n            this.maxScrollY = wrapperHeight - indicatorHeight;\r\n            this.translateYSign =\r\n                this.maxScrollY > 0 ? -1 /* Positive */ : 1 /* NotPositive */;\r\n            this.minScrollY = 0;\r\n            this.ratioY = ratioY ? ratioY : Math.abs(this.maxScrollY / maxBScrollY);\r\n        }\r\n        this.updatePosition({\r\n            x: x,\r\n            y: y,\r\n        });\r\n    };\r\n    Indicator.prototype.start = function (e) {\r\n        if (this.BScrollIsDisabled()) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        handleBubbleAndCancelable(e);\r\n        this.initiated = true;\r\n        this.moved = false;\r\n        this.lastPointX = point.pageX;\r\n        this.lastPointY = point.pageY;\r\n        this.startTime = getNow();\r\n        this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.beforeScrollStart);\r\n    };\r\n    Indicator.prototype.BScrollIsDisabled = function () {\r\n        return !this.scroll.enabled;\r\n    };\r\n    Indicator.prototype.move = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var pointX = point.pageX;\r\n        var pointY = point.pageY;\r\n        handleBubbleAndCancelable(e);\r\n        var deltaX = pointX - this.lastPointX;\r\n        var deltaY = pointY - this.lastPointY;\r\n        this.lastPointX = pointX;\r\n        this.lastPointY = pointY;\r\n        if (!this.moved && !this.indicatorNotMoved(deltaX, deltaY)) {\r\n            this.moved = true;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.moved) {\r\n            var newPos = this.getBScrollPosByRatio(this.currentPos, deltaX, deltaY);\r\n            this.syncBScroll(newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.end = function (e) {\r\n        if (!this.initiated) {\r\n            return;\r\n        }\r\n        this.initiated = false;\r\n        handleBubbleAndCancelable(e);\r\n        if (this.moved) {\r\n            var _a = this.scroll, x = _a.x, y = _a.y;\r\n            this.scroll.scroller.hooks.trigger(this.scroll.scroller.hooks.eventTypes.scrollEnd, {\r\n                x: x,\r\n                y: y,\r\n            });\r\n        }\r\n    };\r\n    Indicator.prototype.getBScrollPosByRatio = function (currentPos, deltaX, deltaY) {\r\n        var currentX = currentPos.x, currentY = currentPos.y;\r\n        var _a = this.scroll, hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll, BScrollMinScrollX = _a.minScrollX, BScrollMaxScrollX = _a.maxScrollX, BScrollMinScrollY = _a.minScrollY, BScrollMaxScrollY = _a.maxScrollY;\r\n        var _b = this.scroll, x = _b.x, y = _b.y;\r\n        if (hasHorizontalScroll) {\r\n            var newPosX = between(currentX + deltaX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\r\n            var roundX = Math.round((newPosX / this.ratioX) * this.translateXSign);\r\n            x = between(roundX, BScrollMaxScrollX, BScrollMinScrollX);\r\n        }\r\n        if (hasVerticalScroll) {\r\n            var newPosY = between(currentY + deltaY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\r\n            var roundY = Math.round((newPosY / this.ratioY) * this.translateYSign);\r\n            y = between(roundY, BScrollMaxScrollY, BScrollMinScrollY);\r\n        }\r\n        return { x: x, y: y };\r\n    };\r\n    Indicator.prototype.indicatorNotMoved = function (deltaX, deltaY) {\r\n        var _a = this.currentPos, x = _a.x, y = _a.y;\r\n        var xNotMoved = (x === this.minScrollX && deltaX <= 0) ||\r\n            (x === this.maxScrollX && deltaX >= 0);\r\n        var yNotMoved = (y === this.minScrollY && deltaY <= 0) ||\r\n            (y === this.maxScrollY && deltaY >= 0);\r\n        return xNotMoved && yNotMoved;\r\n    };\r\n    Indicator.prototype.syncBScroll = function (newPos) {\r\n        var timestamp = getNow();\r\n        var _a = this.scroll, options = _a.options, scroller = _a.scroller;\r\n        var probeType = options.probeType, momentumLimitTime = options.momentumLimitTime;\r\n        scroller.translater.translate(newPos);\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > momentumLimitTime) {\r\n            this.startTime = timestamp;\r\n            if (probeType === 1 /* Throttle */) {\r\n                scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (probeType > 1 /* Throttle */) {\r\n            scroller.hooks.trigger(scroller.hooks.eventTypes.scroll, newPos);\r\n        }\r\n    };\r\n    Indicator.prototype.updatePosition = function (BScrollPos) {\r\n        var newIndicatorPos = this.getIndicatorPosByRatio(BScrollPos);\r\n        this.applyTransformProperty(newIndicatorPos);\r\n        this.currentPos = __assign({}, newIndicatorPos);\r\n    };\r\n    Indicator.prototype.applyTransformProperty = function (pos) {\r\n        var translateZ = this.scroll.options.translateZ;\r\n        var transformProperties = [\r\n            \"translateX(\" + pos.x + \"px)\",\r\n            \"translateY(\" + pos.y + \"px)\",\r\n            \"\" + translateZ,\r\n        ];\r\n        this.indicatorEl.style[style.transform] = transformProperties.join(' ');\r\n    };\r\n    Indicator.prototype.getIndicatorPosByRatio = function (BScrollPos) {\r\n        var x = BScrollPos.x, y = BScrollPos.y;\r\n        var _a = this.scroll, hasHorizontalScroll = _a.hasHorizontalScroll, hasVerticalScroll = _a.hasVerticalScroll;\r\n        var position = __assign({}, this.currentPos);\r\n        if (hasHorizontalScroll) {\r\n            var roundX = Math.round(this.ratioX * x * this.translateXSign);\r\n            // maybe maxScrollX is negative\r\n            position.x = between(roundX, Math.min(this.minScrollX, this.maxScrollX), Math.max(this.minScrollX, this.maxScrollX));\r\n        }\r\n        if (hasVerticalScroll) {\r\n            var roundY = Math.round(this.ratioY * y * this.translateYSign);\r\n            // maybe maxScrollY is negative\r\n            position.y = between(roundY, Math.min(this.minScrollY, this.maxScrollY), Math.max(this.minScrollY, this.maxScrollY));\r\n        }\r\n        return position;\r\n    };\r\n    Indicator.prototype.destroy = function () {\r\n        if (this.options.interactive !== false) {\r\n            this.startEventRegister.destroy();\r\n            this.moveEventRegister.destroy();\r\n            this.endEventRegister.destroy();\r\n        }\r\n        this.hooksFn.forEach(function (item) {\r\n            var hooks = item[0];\r\n            var hooksName = item[1];\r\n            var handlerFn = item[2];\r\n            hooks.off(hooksName, handlerFn);\r\n        });\r\n        this.hooksFn.length = 0;\r\n    };\r\n    return Indicator;\r\n}());\n\nvar Indicators = /** @class */ (function () {\r\n    function Indicators(scroll) {\r\n        this.scroll = scroll;\r\n        this.options = [];\r\n        this.indicators = [];\r\n        this.handleOptions();\r\n        this.handleHooks();\r\n    }\r\n    Indicators.prototype.handleOptions = function () {\r\n        var UserIndicatorsOptions = this.scroll.options.indicators;\r\n        assert(Array.isArray(UserIndicatorsOptions), \"'indicators' must be an array.\");\r\n        for (var _i = 0, UserIndicatorsOptions_1 = UserIndicatorsOptions; _i < UserIndicatorsOptions_1.length; _i++) {\r\n            var indicatorOptions = UserIndicatorsOptions_1[_i];\r\n            assert(!!indicatorOptions.relationElement, \"'relationElement' must be a HTMLElement.\");\r\n            this.createIndicators(indicatorOptions);\r\n        }\r\n    };\r\n    Indicators.prototype.createIndicators = function (options) {\r\n        this.indicators.push(new Indicator(this.scroll, options));\r\n    };\r\n    Indicators.prototype.handleHooks = function () {\r\n        var _this = this;\r\n        var scrollHooks = this.scroll.hooks;\r\n        scrollHooks.on(scrollHooks.eventTypes.destroy, function () {\r\n            for (var _i = 0, _a = _this.indicators; _i < _a.length; _i++) {\r\n                var indicator = _a[_i];\r\n                indicator.destroy();\r\n            }\r\n            _this.indicators = [];\r\n        });\r\n    };\r\n    Indicators.pluginName = 'indicators';\r\n    return Indicators;\r\n}());\n\nBScroll.use(MouseWheel)\r\n    .use(ObserveDOM)\r\n    .use(PullDown)\r\n    .use(PullUp)\r\n    .use(ScrollBar)\r\n    .use(Slide)\r\n    .use(Wheel)\r\n    .use(Zoom)\r\n    .use(NestedScroll)\r\n    .use(InfinityScroll)\r\n    .use(Movable)\r\n    .use(ObserveImage)\r\n    .use(Indicators);\n\nexport default BScroll;\nexport { Behavior, CustomOptions, Indicators, InfinityScroll, MouseWheel, Movable, NestedScroll, ObserveDOM as ObserveDom, ObserveImage, PullDown as PullDownRefresh, PullUp as PullUpLoad, ScrollBar, Slide, Wheel, Zoom, createBScroll };\n"]},"metadata":{},"sourceType":"module"}